<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>
  <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript"/>

  <title>
    File: zip-headers.adb
  </title>
  <link rel='stylesheet' href='support/docgen.css' type='text/css'/>
  <link rel='stylesheet' href='support/tags.css' type='text/css'/>
  <script src='support/docgen.js' type='text/javascript' charset='utf-8'></script>
</head>
<body onload="onloadDoc();">

<div id='leftSide'>
  <div id='leftSideInside'>
  <div id='header'>
    <h2 class="button">Documentation</h2>
    <a href='toc.html'><div class="button2">Table of Contents</div></a>

    <a href='tree.html'><div class="button2">Class Inheritance Tree</div></a>

  </div>
  </div>
</div> <!-- leftSide -->

<div class='subprograms'>
  <div class='details'><ol><li id="l1"><pre><span class="keyword">with</span> Ada.Streams; <span class="keyword">use</span> Ada.Streams; </pre></li>
<li id="l2"><pre><span class="keyword">package</span> <span class="keyword">body</span> <span class="droplink">Zip.Headers<ul><li><a href="zip-headers.ads.html#zip-headers.ads:22:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l22" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l3"><pre> </pre></li>
<li id="l4"><pre>   <span class="comment">-----------------------------------------------------------</span> </pre></li>
<li id="l5"><pre>   <span class="comment">-- Byte array &lt; - &gt; various integers, with Intel endianess --</span> </pre></li>
<li id="l6"><pre>   <span class="comment">-----------------------------------------------------------</span> </pre></li>
<li id="l7"><pre> </pre></li>
<li id="l8"><pre>   <span class="comment">-- Get numbers with correct trucmuche endian, to ensure</span> </pre></li>
<li id="l9"><pre>   <span class="comment">-- correct header loading on some non - Intel machines</span> </pre></li>
<li id="l10"><pre> </pre></li>
<li id="l11"><pre>   <span class="keyword">generic</span> </pre></li>
<li id="l12"><pre>      <span class="keyword">type</span> Number <span class="keyword">is</span> <span class="keyword">mod</span> &lt;&gt;; <span class="comment">-- range &lt;&gt; in Ada83 version (fake Interfaces)</span> </pre></li>
<li id="l13"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l15" title="defined at zip-headers.adb:13:13">Intel_x86_number</a> (b : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> <a href="src_zip-headers.adb.html#l12" title="defined at zip-headers.adb:12:12">Number</a>; </pre></li>
<li id="l14"><pre> </pre></li>
<li id="l15"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l13" title="defined at zip-headers.adb:13:13">Intel_x86_number</a> (<a href="src_zip-headers.adb.html#l13" title="defined at zip-headers.adb:13:31">b</a> : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> <a href="src_zip-headers.adb.html#l12" title="defined at zip-headers.adb:12:12">Number</a> <span class="keyword">is</span> </pre></li>
<li id="l16"><pre> </pre></li>
<li id="l17"><pre>      n : <a href="src_zip-headers.adb.html#l12" title="defined at zip-headers.adb:12:12">Number</a> := 0; </pre></li>
<li id="l18"><pre> </pre></li>
<li id="l19"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l20"><pre>      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">reverse</span> <a href="src_zip-headers.adb.html#l13" title="defined at zip-headers.adb:13:31">b</a>&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l21"><pre>         n := n * 256 + <a href="src_zip-headers.adb.html#l12" title="defined at zip-headers.adb:12:12">Number</a> (<a href="src_zip-headers.adb.html#l13" title="defined at zip-headers.adb:13:31">b</a> (i)); </pre></li>
<li id="l22"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l23"><pre>      <span class="keyword">return</span> n; </pre></li>
<li id="l24"><pre>   <span class="keyword">end</span> <span class="droplink">Intel_x86_number<ul><li><a href="src_zip-headers.adb.html#l13" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l25"><pre> </pre></li>
<li id="l26"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l15" title="defined at zip-headers.adb:26:13">Intel_nb</a> <span class="keyword">is</span> <span class="keyword">new</span> <span class="droplink">Intel_x86_number<ul><li><a href="src_zip-headers.adb.html#l13" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (Unsigned_16); </pre></li>
<li id="l27"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l15" title="defined at zip-headers.adb:27:13">Intel_nb</a> <span class="keyword">is</span> <span class="keyword">new</span> <span class="droplink">Intel_x86_number<ul><li><a href="src_zip-headers.adb.html#l13" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (Unsigned_32); </pre></li>
<li id="l28"><pre> </pre></li>
<li id="l29"><pre>   <span class="comment">-- Put numbers with correct endianess as bytes</span> </pre></li>
<li id="l30"><pre> </pre></li>
<li id="l31"><pre>   <span class="keyword">generic</span> </pre></li>
<li id="l32"><pre>      <span class="keyword">type</span> Number <span class="keyword">is</span> <span class="keyword">mod</span> &lt;&gt;; <span class="comment">-- range &lt;&gt; in Ada83 version (fake Interfaces)</span> </pre></li>
<li id="l33"><pre>      size : Positive; </pre></li>
<li id="l34"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l36" title="defined at zip-headers.adb:34:13">Intel_x86_buffer</a> (n : <a href="src_zip-headers.adb.html#l32" title="defined at zip-headers.adb:32:12">Number</a>) <span class="keyword">return</span> <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l35"><pre> </pre></li>
<li id="l36"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l34" title="defined at zip-headers.adb:34:13">Intel_x86_buffer</a> (<a href="src_zip-headers.adb.html#l34" title="defined at zip-headers.adb:34:31">n</a> : <a href="src_zip-headers.adb.html#l32" title="defined at zip-headers.adb:32:12">Number</a>) <span class="keyword">return</span> <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l37"><pre> </pre></li>
<li id="l38"><pre>      b : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. <a href="src_zip-headers.adb.html#l33" title="defined at zip-headers.adb:33:7">size</a>); </pre></li>
<li id="l39"><pre>      m : <a href="src_zip-headers.adb.html#l32" title="defined at zip-headers.adb:32:12">Number</a> := <a href="src_zip-headers.adb.html#l34" title="defined at zip-headers.adb:34:31">n</a>; </pre></li>
<li id="l40"><pre> </pre></li>
<li id="l41"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l42"><pre>      <span class="keyword">for</span> i <span class="keyword">in</span> b&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l43"><pre>         b (i) := Unsigned_8 (m <span class="keyword">and</span> 255); </pre></li>
<li id="l44"><pre>         m := m / 256; </pre></li>
<li id="l45"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l46"><pre>      <span class="keyword">return</span> b; </pre></li>
<li id="l47"><pre>   <span class="keyword">end</span> <span class="droplink">Intel_x86_buffer<ul><li><a href="src_zip-headers.adb.html#l34" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l48"><pre> </pre></li>
<li id="l49"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l36" title="defined at zip-headers.adb:49:13">Intel_bf</a> <span class="keyword">is</span> <span class="keyword">new</span> <span class="droplink">Intel_x86_buffer<ul><li><a href="src_zip-headers.adb.html#l34" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (Unsigned_16, 2); </pre></li>
<li id="l50"><pre>   <span class="keyword">function</span> <a href="src_zip-headers.adb.html#l36" title="defined at zip-headers.adb:50:13">Intel_bf</a> <span class="keyword">is</span> <span class="keyword">new</span> <span class="droplink">Intel_x86_buffer<ul><li><a href="src_zip-headers.adb.html#l34" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (Unsigned_32, 4); </pre></li>
<li id="l51"><pre> </pre></li>
<li id="l52"><pre>   <span class="comment">-------------------</span> </pre></li>
<li id="l53"><pre>   <span class="comment">-- PK signatures --</span> </pre></li>
<li id="l54"><pre>   <span class="comment">-------------------</span> </pre></li>
<li id="l55"><pre> </pre></li>
<li id="l56"><pre>   <span class="keyword">function</span> PK_signature (buf : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>; code : Unsigned_8) <span class="keyword">return</span> Boolean <span class="keyword">is</span> </pre></li>
<li id="l57"><pre>     (<a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:27">buf</a> (1 .. 4) = (16#50#, 16#4B#, <a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:46">code</a>, <a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:46">code</a> + 1)); <span class="comment">-- PK12, PK34, . ..</span> </pre></li>
<li id="l58"><pre> </pre></li>
<li id="l59"><pre>   <span class="keyword">procedure</span> PK_signature (buf : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>; code : Unsigned_8) <span class="keyword">is</span> </pre></li>
<li id="l60"><pre> </pre></li>
<li id="l61"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l62"><pre>      <a href="src_zip-headers.adb.html#l59" title="defined at zip-headers.adb:59:28">buf</a> (1 .. 4) := (16#50#, 16#4B#, <a href="src_zip-headers.adb.html#l59" title="defined at zip-headers.adb:59:54">code</a>, <a href="src_zip-headers.adb.html#l59" title="defined at zip-headers.adb:59:54">code</a> + 1); <span class="comment">-- PK12, PK34, . ..</span> </pre></li>
<li id="l63"><pre>   <span class="keyword">end</span> <span class="droplink">PK_signature<ul><li><a href="src_zip-headers.adb.html#l59" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l59" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l64"><pre> </pre></li>
<li id="l65"><pre>   <span class="comment">-------------------------------------------------------</span> </pre></li>
<li id="l66"><pre>   <span class="comment">-- PKZIP file header, as in central directory - PK12 --</span> </pre></li>
<li id="l67"><pre>   <span class="comment">-------------------------------------------------------</span> </pre></li>
<li id="l68"><pre> </pre></li>
<li id="l69"><pre>   <span class="keyword">procedure</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:106:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l106" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:106:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l106" title="To spec">To spec</a></li></ul></span>  :     <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l70"><pre>                             <span class="droplink">header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:107:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l107" title="To spec">To spec</a></li></ul></span>  : <span class="keyword">out</span> <span class="droplink">Central_File_Header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:84:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l84" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l71"><pre> </pre></li>
<li id="l72"><pre>      chb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 46); </pre></li>
<li id="l73"><pre> </pre></li>
<li id="l74"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l75"><pre>      <span class="droplink">BlockRead<ul><li><a href="zip.ads.html#zip.ads:238:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l238" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l641" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:106:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l106" title="To spec">To spec</a></li></ul></span>, <a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a>); </pre></li>
<li id="l76"><pre> </pre></li>
<li id="l77"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:13">PK_signature</a> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a>, 1) <span class="keyword">then</span> </pre></li>
<li id="l78"><pre>         <span class="keyword">raise</span> <span class="droplink">bad_central_header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:109:3" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l109" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l79"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l80"><pre> </pre></li>
<li id="l81"><pre>      <span class="droplink">header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:107:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l107" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l70" title="To body">To body</a></li></ul></span> := (made_by_version     =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (5  ..  6)), </pre></li>
<li id="l82"><pre>                 short_info          =&gt; </pre></li>
<li id="l83"><pre>                   (needed_extract_version =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (7  ..  8)), </pre></li>
<li id="l84"><pre>                    bit_flag               =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (9  .. 10)), </pre></li>
<li id="l85"><pre>                    zip_type               =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (11 .. 12)), </pre></li>
<li id="l86"><pre>                    file_timedate          =&gt; <span class="droplink">Zip_Streams.Calendar.Convert<ul><li><a href="zip_streams.ads-2.html#zip_streams.ads:150:16" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l150" title="To spec">To spec</a></li><li><a href="src_zip_streams.adb.html#l290" title="To body">To body</a></li></ul></span> (Unsigned_32&apos;(<span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (13 .. 16)))), </pre></li>
<li id="l87"><pre>                    dd                     =&gt; </pre></li>
<li id="l88"><pre>                      (crc_32            =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (17 .. 20)), </pre></li>
<li id="l89"><pre>                       compressed_size   =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (21 .. 24)), </pre></li>
<li id="l90"><pre>                       uncompressed_size =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (25 .. 28))), </pre></li>
<li id="l91"><pre>                    filename_length        =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (29 .. 30)), </pre></li>
<li id="l92"><pre>                    extra_field_length     =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (31 .. 32))), </pre></li>
<li id="l93"><pre>                 comment_length      =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (33 .. 34)), </pre></li>
<li id="l94"><pre>                 disk_number_start   =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (35 .. 36)), </pre></li>
<li id="l95"><pre>                 internal_attributes =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (37 .. 38)), </pre></li>
<li id="l96"><pre>                 external_attributes =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (39 .. 42)), </pre></li>
<li id="l97"><pre>                 local_header_offset =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l72" title="defined at zip-headers.adb:72:7">chb</a> (43 .. 46))); </pre></li>
<li id="l98"><pre> </pre></li>
<li id="l99"><pre>   <span class="keyword">end</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:106:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l106" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l69" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l100"><pre> </pre></li>
<li id="l101"><pre>   <span class="keyword">procedure</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:111:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l111" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:111:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l111" title="To spec">To spec</a></li></ul></span>  : <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l102"><pre>                    <span class="droplink">header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:112:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l112" title="To spec">To spec</a></li></ul></span>  : <span class="droplink">Central_File_Header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:84:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l84" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l103"><pre> </pre></li>
<li id="l104"><pre>      chb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 46); </pre></li>
<li id="l105"><pre> </pre></li>
<li id="l106"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l107"><pre>      <span class="droplink">PK_signature<ul><li><a href="src_zip-headers.adb.html#l59" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l59" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a>, 1); </pre></li>
<li id="l108"><pre> </pre></li>
<li id="l109"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (5  ..  6) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.made_by_version); </pre></li>
<li id="l110"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (7  ..  8) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.needed_extract_version); </pre></li>
<li id="l111"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (9  .. 10) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.bit_flag); </pre></li>
<li id="l112"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (11 .. 12) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.zip_type); </pre></li>
<li id="l113"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (13 .. 16) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (<span class="droplink">Zip_Streams.Calendar.Convert<ul><li><a href="zip_streams.ads-2.html#zip_streams.ads:151:16" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l151" title="To spec">To spec</a></li><li><a href="src_zip_streams.adb.html#l292" title="To body">To body</a></li></ul></span> (header.short_info.file_timedate)); </pre></li>
<li id="l114"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (17 .. 20) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.dd.crc_32); </pre></li>
<li id="l115"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (21 .. 24) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.dd.compressed_size); </pre></li>
<li id="l116"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (25 .. 28) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.dd.uncompressed_size); </pre></li>
<li id="l117"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (29 .. 30) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.filename_length); </pre></li>
<li id="l118"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (31 .. 32) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.short_info.extra_field_length); </pre></li>
<li id="l119"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (33 .. 34) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.comment_length); </pre></li>
<li id="l120"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (35 .. 36) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.disk_number_start); </pre></li>
<li id="l121"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (37 .. 38) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.internal_attributes); </pre></li>
<li id="l122"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (39 .. 42) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.external_attributes); </pre></li>
<li id="l123"><pre>      <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a> (43 .. 46) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.local_header_offset); </pre></li>
<li id="l124"><pre> </pre></li>
<li id="l125"><pre>      <span class="droplink">BlockWrite<ul><li><a href="zip.ads.html#zip.ads:244:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l244" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l653" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:111:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l111" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>, <a href="src_zip-headers.adb.html#l104" title="defined at zip-headers.adb:104:7">chb</a>); </pre></li>
<li id="l126"><pre>   <span class="keyword">end</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:111:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l111" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l101" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l127"><pre> </pre></li>
<li id="l128"><pre>   <span class="comment">-----------------------------------------------------------------------</span> </pre></li>
<li id="l129"><pre>   <span class="comment">-- PKZIP local file header, in front of every file in archive - PK34 --</span> </pre></li>
<li id="l130"><pre>   <span class="comment">-----------------------------------------------------------------------</span> </pre></li>
<li id="l131"><pre> </pre></li>
<li id="l132"><pre>   <span class="keyword">procedure</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:71:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l71" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:71:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l71" title="To spec">To spec</a></li></ul></span> :     <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l133"><pre>                             <span class="droplink">header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:72:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l72" title="To spec">To spec</a></li></ul></span> : <span class="keyword">out</span> <span class="droplink">Local_File_Header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:58:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l58" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l134"><pre> </pre></li>
<li id="l135"><pre>      lhb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 30); </pre></li>
<li id="l136"><pre> </pre></li>
<li id="l137"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l138"><pre>      <span class="droplink">BlockRead<ul><li><a href="zip.ads.html#zip.ads:238:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l238" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l641" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:71:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l71" title="To spec">To spec</a></li></ul></span>, <a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a>); </pre></li>
<li id="l139"><pre> </pre></li>
<li id="l140"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:13">PK_signature</a> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a>, 3) <span class="keyword">then</span> </pre></li>
<li id="l141"><pre>         <span class="keyword">raise</span> <span class="droplink">bad_local_header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:74:3" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l74" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l142"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l143"><pre> </pre></li>
<li id="l144"><pre>      <span class="droplink">header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:72:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l72" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l133" title="To body">To body</a></li></ul></span> := </pre></li>
<li id="l145"><pre>        (needed_extract_version =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (5  ..  6)), </pre></li>
<li id="l146"><pre>         bit_flag               =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (7  ..  8)), </pre></li>
<li id="l147"><pre>         zip_type               =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (9  .. 10)), </pre></li>
<li id="l148"><pre>         file_timedate          =&gt; <span class="droplink">Zip_Streams.Calendar.Convert<ul><li><a href="zip_streams.ads-2.html#zip_streams.ads:150:16" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l150" title="To spec">To spec</a></li><li><a href="src_zip_streams.adb.html#l290" title="To body">To body</a></li></ul></span> (Unsigned_32&apos;(<span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (11 .. 14)))), </pre></li>
<li id="l149"><pre>         dd                     =&gt; </pre></li>
<li id="l150"><pre>           (crc_32            =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (15 .. 18)), </pre></li>
<li id="l151"><pre>            compressed_size   =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (19 .. 22)), </pre></li>
<li id="l152"><pre>            uncompressed_size =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (23 .. 26))), </pre></li>
<li id="l153"><pre>         filename_length      =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (27 .. 28)), </pre></li>
<li id="l154"><pre>         extra_field_length     =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l135" title="defined at zip-headers.adb:135:7">lhb</a> (29 .. 30))); </pre></li>
<li id="l155"><pre> </pre></li>
<li id="l156"><pre>   <span class="keyword">end</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:71:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l71" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l132" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l157"><pre> </pre></li>
<li id="l158"><pre>   <span class="keyword">procedure</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:76:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l76" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:76:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l76" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l159"><pre>                    <span class="droplink">header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:77:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l77" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Local_File_Header<ul><li><a href="zip-headers.ads.html#zip-headers.ads:58:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l58" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l160"><pre> </pre></li>
<li id="l161"><pre>      lhb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 30); </pre></li>
<li id="l162"><pre> </pre></li>
<li id="l163"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l164"><pre>      <span class="droplink">PK_signature<ul><li><a href="src_zip-headers.adb.html#l59" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l59" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a>, 3); </pre></li>
<li id="l165"><pre> </pre></li>
<li id="l166"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (5  ..  6) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.needed_extract_version); </pre></li>
<li id="l167"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (7  ..  8) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.bit_flag); </pre></li>
<li id="l168"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (9  .. 10) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.zip_type); </pre></li>
<li id="l169"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (11 .. 14) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (<span class="droplink">Zip_Streams.Calendar.Convert<ul><li><a href="zip_streams.ads-2.html#zip_streams.ads:151:16" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l151" title="To spec">To spec</a></li><li><a href="src_zip_streams.adb.html#l292" title="To body">To body</a></li></ul></span> (header.file_timedate)); </pre></li>
<li id="l170"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (15 .. 18) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.dd.crc_32); </pre></li>
<li id="l171"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (19 .. 22) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.dd.compressed_size); </pre></li>
<li id="l172"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (23 .. 26) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.dd.uncompressed_size); </pre></li>
<li id="l173"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (27 .. 28) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.filename_length); </pre></li>
<li id="l174"><pre>      <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a> (29 .. 30) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (header.extra_field_length); </pre></li>
<li id="l175"><pre> </pre></li>
<li id="l176"><pre>      <span class="droplink">BlockWrite<ul><li><a href="zip.ads.html#zip.ads:244:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l244" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l653" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:76:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l76" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>, <a href="src_zip-headers.adb.html#l161" title="defined at zip-headers.adb:161:7">lhb</a>); </pre></li>
<li id="l177"><pre>   <span class="keyword">end</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:76:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l76" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l158" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l178"><pre> </pre></li>
<li id="l179"><pre>   <span class="comment">-------------------------------------------</span> </pre></li>
<li id="l180"><pre>   <span class="comment">-- PKZIP end - of - central - directory - PK56 --</span> </pre></li>
<li id="l181"><pre>   <span class="comment">-------------------------------------------</span> </pre></li>
<li id="l182"><pre> </pre></li>
<li id="l183"><pre>   <span class="keyword">procedure</span> <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span>  :     <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l184"><pre>                             <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:143:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l143" title="To spec">To spec</a></li></ul></span> : <span class="keyword">out</span> <span class="droplink">End_of_Central_Dir<ul><li><a href="zip-headers.ads.html#zip-headers.ads:118:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l118" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l185"><pre> </pre></li>
<li id="l186"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l187"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:13">PK_signature</a> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span>, 5) <span class="keyword">then</span> </pre></li>
<li id="l188"><pre>         <span class="keyword">raise</span> <span class="droplink">bad_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:148:3" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l148" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l189"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l190"><pre> </pre></li>
<li id="l191"><pre>      <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:143:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l143" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l184" title="To body">To body</a></li></ul></span> := </pre></li>
<li id="l192"><pre>        (disknum             =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (5  ..  6)), </pre></li>
<li id="l193"><pre>         disknum_with_start  =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (7  ..  8)), </pre></li>
<li id="l194"><pre>         disk_total_entries  =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (9  .. 10)), </pre></li>
<li id="l195"><pre>         total_entries       =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (11 .. 12)), </pre></li>
<li id="l196"><pre>         central_dir_size    =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (13 .. 16)), </pre></li>
<li id="l197"><pre>         central_dir_offset  =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (17 .. 20)), </pre></li>
<li id="l198"><pre>         main_comment_length =&gt; <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l26" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li></ul></span> (21 .. 22)), </pre></li>
<li id="l199"><pre>         offset_shifting     =&gt; 0); <span class="comment">-- Assuming single zip archive here</span> </pre></li>
<li id="l200"><pre> </pre></li>
<li id="l201"><pre>   <span class="keyword">end</span> <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l183" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l202"><pre> </pre></li>
<li id="l203"><pre>   <span class="keyword">procedure</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:145:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l145" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:145:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l145" title="To spec">To spec</a></li></ul></span>  :     <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l204"><pre>                             <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:146:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l146" title="To spec">To spec</a></li></ul></span> : <span class="keyword">out</span> <span class="droplink">End_of_Central_Dir<ul><li><a href="zip-headers.ads.html#zip-headers.ads:118:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l118" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l205"><pre> </pre></li>
<li id="l206"><pre>      eb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 22); </pre></li>
<li id="l207"><pre> </pre></li>
<li id="l208"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l209"><pre>      <span class="droplink">BlockRead<ul><li><a href="zip.ads.html#zip.ads:238:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l238" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l641" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:145:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l145" title="To spec">To spec</a></li></ul></span>, <a href="src_zip-headers.adb.html#l206" title="defined at zip-headers.adb:206:7">eb</a>); </pre></li>
<li id="l210"><pre>      <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l183" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l206" title="defined at zip-headers.adb:206:7">eb</a>, <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:146:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l146" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l204" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l211"><pre>   <span class="keyword">end</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:145:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l145" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l203" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l212"><pre> </pre></li>
<li id="l213"><pre>   <span class="comment">-- Some explanations - GdM 2001</span> </pre></li>
<li id="l214"><pre> </pre></li>
<li id="l215"><pre>   <span class="comment">-- The idea is that the .ZIP can be appended to an .EXE, for</span> </pre></li>
<li id="l216"><pre>   <span class="comment">-- self - extracting purposes. So, the most general infos are</span> </pre></li>
<li id="l217"><pre>   <span class="comment">-- at the end, and we crawl back for more precise infos:</span> </pre></li>
<li id="l218"><pre>   <span class="comment">--  1) end - of - central directory</span> </pre></li>
<li id="l219"><pre>   <span class="comment">--  2) central directory</span> </pre></li>
<li id="l220"><pre>   <span class="comment">--  3) zipped files</span> </pre></li>
<li id="l221"><pre> </pre></li>
<li id="l222"><pre>   <span class="keyword">procedure</span> <span class="droplink">Load<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>  :     <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l223"><pre>                   <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:153:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l153" title="To spec">To spec</a></li></ul></span> : <span class="keyword">out</span> <span class="droplink">End_of_Central_Dir<ul><li><a href="zip-headers.ads.html#zip-headers.ads:118:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l118" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l224"><pre> </pre></li>
<li id="l225"><pre>      end_buffer    : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 22); </pre></li>
<li id="l226"><pre>      min_end_start : Ada.Streams.Stream_IO.Count; </pre></li>
<li id="l227"><pre> </pre></li>
<li id="l228"><pre>      <span class="keyword">use</span> Ada.Streams.Stream_IO; </pre></li>
<li id="l229"><pre> </pre></li>
<li id="l230"><pre>      max_comment : <span class="keyword">constant</span> := 65_535; </pre></li>
<li id="l231"><pre> </pre></li>
<li id="l232"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l233"><pre>      <span class="comment">-- 20 - Jun - 2001 : abandon search below min_end_start</span> </pre></li>
<li id="l234"><pre>      <span class="comment">--              - read about max comment length in appnote</span> </pre></li>
<li id="l235"><pre> </pre></li>
<li id="l236"><pre>      <span class="keyword">if</span> <span class="droplink">Size<ul><li><a href="zip_streams.ads.html#zip_streams.ads:53:13" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l53" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>) &lt;= <a href="src_zip-headers.adb.html#l230" title="defined at zip-headers.adb:230:7">max_comment</a> <span class="keyword">then</span> </pre></li>
<li id="l237"><pre>         <a href="src_zip-headers.adb.html#l226" title="defined at zip-headers.adb:226:7">min_end_start</a> := 1; </pre></li>
<li id="l238"><pre>      <span class="keyword">else</span> </pre></li>
<li id="l239"><pre>         <a href="src_zip-headers.adb.html#l226" title="defined at zip-headers.adb:226:7">min_end_start</a> := Ada.Streams.Stream_IO.Count (<span class="droplink">Size<ul><li><a href="zip_streams.ads.html#zip_streams.ads:53:13" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l53" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>)) - <a href="src_zip-headers.adb.html#l230" title="defined at zip-headers.adb:230:7">max_comment</a>; </pre></li>
<li id="l240"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l241"><pre> </pre></li>
<li id="l242"><pre>      <span class="comment">-- Yes, we must _search_ for it .. .</span> </pre></li>
<li id="l243"><pre>      <span class="comment">-- because PKWARE put a variable - size comment _after_ it 8 - (</span> </pre></li>
<li id="l244"><pre> </pre></li>
<li id="l245"><pre>      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">reverse</span> <a href="src_zip-headers.adb.html#l226" title="defined at zip-headers.adb:226:7">min_end_start</a> .. Ada.Streams.Stream_IO.Count (<span class="droplink">Size<ul><li><a href="zip_streams.ads.html#zip_streams.ads:53:13" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l53" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>)) - 21 <span class="keyword">loop</span> </pre></li>
<li id="l246"><pre>         <span class="droplink">Zip_Streams.Set_Index<ul><li><a href="zip_streams.ads.html#zip_streams.ads:46:14" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l46" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>, Positive (i)); </pre></li>
<li id="l247"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l248"><pre>            <span class="keyword">for</span> j <span class="keyword">in</span> <a href="src_zip-headers.adb.html#l225" title="defined at zip-headers.adb:225:7">end_buffer</a>&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l249"><pre>               <span class="droplink">Byte<ul><li><a href="zip.ads.html#zip.ads:218:11" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l218" title="To spec">To spec</a></li></ul></span>&apos;Read (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>, <a href="src_zip-headers.adb.html#l225" title="defined at zip-headers.adb:225:7">end_buffer</a> (j)); </pre></li>
<li id="l250"><pre>               <span class="comment">-- 20 - Jun - 2001 : useless to read more if 1st character is not &apos;P&apos;</span> </pre></li>
<li id="l251"><pre>               <span class="keyword">if</span> j = <a href="src_zip-headers.adb.html#l225" title="defined at zip-headers.adb:225:7">end_buffer</a>&apos;First <span class="keyword">and</span> <span class="keyword">then</span> </pre></li>
<li id="l252"><pre>                 <a href="src_zip-headers.adb.html#l225" title="defined at zip-headers.adb:225:7">end_buffer</a> (j) /= Character&apos;Pos (<span class="string">&apos;P&apos;</span>) </pre></li>
<li id="l253"><pre>               <span class="keyword">then</span> </pre></li>
<li id="l254"><pre>                  <span class="keyword">raise</span> <span class="droplink">bad_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:148:3" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l148" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l255"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l256"><pre>            <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l257"><pre>            <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:142:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l142" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l183" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l225" title="defined at zip-headers.adb:225:7">end_buffer</a>, <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:153:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l153" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l223" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l258"><pre>            <span class="comment">-- at this point, the buffer was successfully read</span> </pre></li>
<li id="l259"><pre>            <span class="comment">-- (no exception raised).</span> </pre></li>
<li id="l260"><pre>            the_end.offset_shifting := </pre></li>
<li id="l261"><pre>            <span class="comment">-- This is the real position of the end - of - central - directory block.</span> </pre></li>
<li id="l262"><pre>              Unsigned_32 (<span class="droplink">Zip_Streams.Index<ul><li><a href="zip_streams.ads.html#zip_streams.ads:50:13" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l50" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:19" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li></ul></span>) - 22) </pre></li>
<li id="l263"><pre>              - </pre></li>
<li id="l264"><pre>            <span class="comment">-- This is the theoretical position of the end - of - central - directory,</span> </pre></li>
<li id="l265"><pre>            <span class="comment">-- block. Should coincide with the real position if the zip file</span> </pre></li>
<li id="l266"><pre>            <span class="comment">-- is not appended.</span> </pre></li>
<li id="l267"><pre>              ( </pre></li>
<li id="l268"><pre>               1 + </pre></li>
<li id="l269"><pre>                 the_end.central_dir_offset + </pre></li>
<li id="l270"><pre>                   the_end.central_dir_size </pre></li>
<li id="l271"><pre>              ); </pre></li>
<li id="l272"><pre>            <span class="keyword">return</span>; <span class="comment">-- the_end found and filled - &gt; exit</span> </pre></li>
<li id="l273"><pre>         <span class="keyword">exception</span> </pre></li>
<li id="l274"><pre>            <span class="keyword">when</span> <span class="droplink">bad_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:148:3" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l148" title="To spec">To spec</a></li></ul></span> =&gt; </pre></li>
<li id="l275"><pre>               <span class="keyword">if</span> i &gt; <a href="src_zip-headers.adb.html#l226" title="defined at zip-headers.adb:226:7">min_end_start</a> <span class="keyword">then</span> </pre></li>
<li id="l276"><pre>                  <span class="keyword">null</span>;  <span class="comment">-- we will try 1 index before .. .</span> </pre></li>
<li id="l277"><pre>               <span class="keyword">else</span> </pre></li>
<li id="l278"><pre>                  <span class="keyword">raise</span>; <span class="comment">-- definitely no &quot;end - of - central - directory&quot; here</span> </pre></li>
<li id="l279"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l280"><pre>         <span class="keyword">end</span>; </pre></li>
<li id="l281"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l282"><pre>   <span class="keyword">end</span> <span class="droplink">Load<ul><li><a href="zip-headers.ads.html#zip-headers.ads:152:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l152" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l222" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l283"><pre> </pre></li>
<li id="l284"><pre>   <span class="keyword">procedure</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:155:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l155" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:155:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l155" title="To spec">To spec</a></li></ul></span>  : <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l285"><pre>                    <span class="droplink">the_end<ul><li><a href="zip-headers.ads.html#zip-headers.ads:156:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l156" title="To spec">To spec</a></li></ul></span> : <span class="droplink">End_of_Central_Dir<ul><li><a href="zip-headers.ads.html#zip-headers.ads:118:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l118" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l286"><pre> </pre></li>
<li id="l287"><pre>      eb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 22); </pre></li>
<li id="l288"><pre> </pre></li>
<li id="l289"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l290"><pre>      <span class="droplink">PK_signature<ul><li><a href="src_zip-headers.adb.html#l59" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l59" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a>, 5); </pre></li>
<li id="l291"><pre> </pre></li>
<li id="l292"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (5 .. 6) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.disknum); </pre></li>
<li id="l293"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (7 .. 8) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.disknum_with_start); </pre></li>
<li id="l294"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (9 .. 10) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.disk_total_entries); </pre></li>
<li id="l295"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (11 .. 12) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.total_entries); </pre></li>
<li id="l296"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (13 .. 16) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.central_dir_size); </pre></li>
<li id="l297"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (17 .. 20) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.central_dir_offset); </pre></li>
<li id="l298"><pre>      <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a> (21 .. 22) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_end.main_comment_length); </pre></li>
<li id="l299"><pre> </pre></li>
<li id="l300"><pre>      <span class="droplink">BlockWrite<ul><li><a href="zip.ads.html#zip.ads:244:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l244" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l653" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:155:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l155" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>, <a href="src_zip-headers.adb.html#l287" title="defined at zip-headers.adb:287:7">eb</a>); </pre></li>
<li id="l301"><pre>   <span class="keyword">end</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:155:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l155" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l284" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l302"><pre> </pre></li>
<li id="l303"><pre>   <span class="comment">------------------------------------------------------------------</span> </pre></li>
<li id="l304"><pre>   <span class="comment">-- PKZIP data descriptor, after streamed compressed data - PK78 --</span> </pre></li>
<li id="l305"><pre>   <span class="comment">------------------------------------------------------------------</span> </pre></li>
<li id="l306"><pre> </pre></li>
<li id="l307"><pre>   <span class="keyword">procedure</span> <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li></ul></span>        :     <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l308"><pre>                             <span class="droplink">the_data_desc<ul><li><a href="zip-headers.ads.html#zip-headers.ads:42:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l42" title="To spec">To spec</a></li></ul></span> : <span class="keyword">out</span> <span class="droplink">Data_descriptor<ul><li><a href="zip-headers.ads.html#zip-headers.ads:30:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l30" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l309"><pre> </pre></li>
<li id="l310"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l311"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <a href="src_zip-headers.adb.html#l56" title="defined at zip-headers.adb:56:13">PK_signature</a> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li></ul></span>, 7) <span class="keyword">then</span> </pre></li>
<li id="l312"><pre>         <span class="keyword">raise</span> <span class="droplink">bad_data_descriptor<ul><li><a href="zip-headers.ads.html#zip-headers.ads:47:3" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l47" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l313"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l314"><pre> </pre></li>
<li id="l315"><pre>      the_data_desc.crc_32 :=             <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li></ul></span> (5 .. 8)); </pre></li>
<li id="l316"><pre>      the_data_desc.compressed_size :=    <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li></ul></span> (9 .. 12)); </pre></li>
<li id="l317"><pre>      the_data_desc.uncompressed_size :=  <span class="droplink">Intel_nb<ul><li><a href="src_zip-headers.adb.html#l27" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l15" title="To body">To body</a></li></ul></span> (<span class="droplink">buffer<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:29" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li></ul></span> (13 .. 16)); </pre></li>
<li id="l318"><pre> </pre></li>
<li id="l319"><pre>   <span class="keyword">end</span> <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l307" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l320"><pre> </pre></li>
<li id="l321"><pre>   <span class="keyword">procedure</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:44:14" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l44" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:44:30" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l44" title="To spec">To spec</a></li></ul></span>        :     <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l322"><pre>                             <span class="droplink">the_data_desc<ul><li><a href="zip-headers.ads.html#zip-headers.ads:45:30" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l45" title="To spec">To spec</a></li></ul></span> : <span class="keyword">out</span> <span class="droplink">Data_descriptor<ul><li><a href="zip-headers.ads.html#zip-headers.ads:30:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l30" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l323"><pre> </pre></li>
<li id="l324"><pre>      ddb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 16); </pre></li>
<li id="l325"><pre> </pre></li>
<li id="l326"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l327"><pre>      <span class="droplink">BlockRead<ul><li><a href="zip.ads.html#zip.ads:238:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l238" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l641" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:44:30" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l44" title="To spec">To spec</a></li></ul></span>, <a href="src_zip-headers.adb.html#l324" title="defined at zip-headers.adb:324:7">ddb</a>); </pre></li>
<li id="l328"><pre>      <span class="droplink">Copy_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:41:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l41" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l307" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l324" title="defined at zip-headers.adb:324:7">ddb</a>, <span class="droplink">the_data_desc<ul><li><a href="zip-headers.ads.html#zip-headers.ads:45:30" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l45" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l322" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l329"><pre>   <span class="keyword">end</span> <span class="droplink">Read_and_check<ul><li><a href="zip-headers.ads.html#zip-headers.ads:44:14" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l44" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l321" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l330"><pre> </pre></li>
<li id="l331"><pre>   <span class="keyword">procedure</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:49:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l49" title="To spec">To spec</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:49:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l49" title="To spec">To spec</a></li></ul></span>        : <span class="droplink">Zipstream_Class<ul><li><a href="zip_streams.ads.html#zip_streams.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_zip_streams.ads.html#l43" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l332"><pre>                    <span class="droplink">the_data_desc<ul><li><a href="zip-headers.ads.html#zip-headers.ads:50:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l50" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Data_descriptor<ul><li><a href="zip-headers.ads.html#zip-headers.ads:30:8" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l30" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l333"><pre> </pre></li>
<li id="l334"><pre>      ddb : <span class="droplink">Byte_Buffer<ul><li><a href="zip.ads.html#zip.ads:219:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l219" title="To spec">To spec</a></li></ul></span> (1 .. 16); </pre></li>
<li id="l335"><pre> </pre></li>
<li id="l336"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l337"><pre>      <span class="droplink">PK_signature<ul><li><a href="src_zip-headers.adb.html#l59" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l59" title="To body">To body</a></li></ul></span> (<a href="src_zip-headers.adb.html#l334" title="defined at zip-headers.adb:334:7">ddb</a>, 7); </pre></li>
<li id="l338"><pre> </pre></li>
<li id="l339"><pre>      <a href="src_zip-headers.adb.html#l334" title="defined at zip-headers.adb:334:7">ddb</a> (5 .. 8) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_data_desc.crc_32); </pre></li>
<li id="l340"><pre>      <a href="src_zip-headers.adb.html#l334" title="defined at zip-headers.adb:334:7">ddb</a> (9 .. 12) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_data_desc.compressed_size); </pre></li>
<li id="l341"><pre>      <a href="src_zip-headers.adb.html#l334" title="defined at zip-headers.adb:334:7">ddb</a> (13 .. 16) := <span class="droplink">Intel_bf<ul><li><a href="src_zip-headers.adb.html#l50" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l36" title="To body">To body</a></li></ul></span> (the_data_desc.uncompressed_size); </pre></li>
<li id="l342"><pre> </pre></li>
<li id="l343"><pre>      <span class="droplink">BlockWrite<ul><li><a href="zip.ads.html#zip.ads:244:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l244" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l653" title="To body">To body</a></li></ul></span> (<span class="droplink">stream<ul><li><a href="zip-headers.ads.html#zip-headers.ads:49:20" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l49" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>, <a href="src_zip-headers.adb.html#l334" title="defined at zip-headers.adb:334:7">ddb</a>); </pre></li>
<li id="l344"><pre>   <span class="keyword">end</span> <span class="droplink">Write<ul><li><a href="zip-headers.ads.html#zip-headers.ads:49:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l49" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l331" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l345"><pre> </pre></li>
<li id="l346"><pre><span class="keyword">end</span> <span class="droplink">Zip.Headers<ul><li><a href="zip-headers.ads.html#zip-headers.ads:22:13" title="To API doc">To API doc</a></li><li><a href="src_zip-headers.ads.html#l22" title="To spec">To spec</a></li><li><a href="src_zip-headers.adb.html#l2" title="To body">To body</a></li></ul></span>; </pre></li>
</ol></div>
</div>

</body>
</html>