<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>
  <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript"/>

  <title>
    File: globe_3d.adb
  </title>
  <link rel='stylesheet' href='support/docgen.css' type='text/css'/>
  <link rel='stylesheet' href='support/tags.css' type='text/css'/>
  <script src='support/docgen.js' type='text/javascript' charset='utf-8'></script>
</head>
<body onload="onloadDoc();">

<div id='leftSide'>
  <div id='leftSideInside'>
  <div id='header'>
    <h2 class="button">Documentation</h2>
    <a href='toc.html'><div class="button2">Table of Contents</div></a>

    <a href='tree.html'><div class="button2">Class Inheritance Tree</div></a>

  </div>
  </div>
</div> <!-- leftSide -->

<div class='subprograms'>
  <div class='details'><ol><li id="l1"><pre><span class="keyword">with</span> <span class="droplink">GLOBE_3D.Options<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-options.adb.html#l1" title="To body">To body</a></li></ul></span>, </pre></li>
<li id="l2"><pre>     <span class="droplink">GLOBE_3D.Textures<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-textures.adb.html#l11" title="To body">To body</a></li></ul></span>, </pre></li>
<li id="l3"><pre>     <span class="droplink">GLOBE_3D.Math<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l1" title="To body">To body</a></li></ul></span>, </pre></li>
<li id="l4"><pre>     <span class="droplink">GLOBE_3D.Portals<ul><li><a href="globe_3d-portals.ads.html#globe_3d-portals.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-portals.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-portals.adb.html#l5" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l5"><pre> </pre></li>
<li id="l6"><pre><span class="keyword">with</span> <span class="droplink">GL.Errors<ul><li><a href="gl-errors.ads.html#gl-errors.ads:11:12" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l11" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l16" title="To body">To body</a></li></ul></span>, </pre></li>
<li id="l7"><pre>     <span class="droplink">GL.Skins<ul><li><a href="gl-skins.ads.html#gl-skins.ads:15:12" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l15" title="To spec">To spec</a></li><li><a href="src_gl-skins.adb.html#l14" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l8"><pre> </pre></li>
<li id="l9"><pre><span class="keyword">with</span> Ada.Characters.Handling;           <span class="keyword">use</span> Ada.Characters.Handling; </pre></li>
<li id="l10"><pre><span class="keyword">with</span> Ada.Exceptions;                    <span class="keyword">use</span> Ada.Exceptions; </pre></li>
<li id="l11"><pre><span class="keyword">with</span> Ada.Strings.Fixed;                 <span class="keyword">use</span> Ada.Strings, Ada.Strings.Fixed; </pre></li>
<li id="l12"><pre><span class="keyword">with</span> Ada.Text_IO;                       <span class="keyword">use</span> Ada.Text_IO; </pre></li>
<li id="l13"><pre> </pre></li>
<li id="l14"><pre><span class="keyword">with</span> System.Storage_Elements; </pre></li>
<li id="l15"><pre><span class="keyword">with</span> Ada.Containers.Generic_Array_Sort; </pre></li>
<li id="l16"><pre> </pre></li>
<li id="l17"><pre><span class="keyword">package</span> <span class="keyword">body</span> <span class="droplink">GLOBE_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:77:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l77" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l18"><pre> </pre></li>
<li id="l19"><pre>   <span class="keyword">use</span> <span class="droplink">GLOBE_3D.Options<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-options.adb.html#l1" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l20"><pre> </pre></li>
<li id="l21"><pre>   <span class="keyword">package</span> G3DT <span class="keyword">renames</span> <span class="droplink">GLOBE_3D.Textures<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-textures.adb.html#l11" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l22"><pre>   <span class="keyword">package</span> G3DM <span class="keyword">renames</span> <span class="droplink">GLOBE_3D.Math<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l1" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l23"><pre> </pre></li>
<li id="l24"><pre>   <span class="keyword">function</span> <span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li></ul></span> (<span class="droplink">r<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:20" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> String <span class="keyword">is</span> </pre></li>
<li id="l25"><pre> </pre></li>
<li id="l26"><pre>      s : String (1 .. 10); </pre></li>
<li id="l27"><pre> </pre></li>
<li id="l28"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l29"><pre>      RIO.Put (<a href="src_globe_3d.adb.html#l26" title="defined at globe_3d.adb:26:7">s</a>, <span class="droplink">r<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:20" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li></ul></span>, 4, 0); </pre></li>
<li id="l30"><pre>      <span class="keyword">return</span> <a href="src_globe_3d.adb.html#l26" title="defined at globe_3d.adb:26:7">s</a>; </pre></li>
<li id="l31"><pre> </pre></li>
<li id="l32"><pre>   <span class="keyword">exception</span> </pre></li>
<li id="l33"><pre>      <span class="keyword">when</span> Ada.Text_IO.Layout_Error =&gt; <span class="keyword">return</span> <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<span class="droplink">r<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:20" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l34"><pre>   <span class="keyword">end</span> <span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l35"><pre> </pre></li>
<li id="l36"><pre>   <span class="keyword">function</span> <span class="droplink">Coords<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li></ul></span> (<span class="droplink">p<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Point_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:111:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l111" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> String <span class="keyword">is</span> </pre></li>
<li id="l37"><pre>     (<span class="string">&apos;(&apos;</span> &amp; <span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<span class="droplink">p<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li></ul></span> (0)) &amp; </pre></li>
<li id="l38"><pre>      <span class="string">&apos;,&apos;</span> &amp; <span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<span class="droplink">p<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li></ul></span> (1)) &amp; </pre></li>
<li id="l39"><pre>      <span class="string">&apos;,&apos;</span> &amp; <span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<span class="droplink">p<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li></ul></span> (2)) &amp; </pre></li>
<li id="l40"><pre>     <span class="string">&apos;)&apos;</span>); </pre></li>
<li id="l41"><pre> </pre></li>
<li id="l42"><pre>   <span class="comment">-- normal support</span> </pre></li>
<li id="l43"><pre>   <span class="comment">--</span> </pre></li>
<li id="l44"><pre> </pre></li>
<li id="l45"><pre>   <span class="keyword">procedure</span> Add_Normal_of_3p (o             :        <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>&apos;Class; </pre></li>
<li id="l46"><pre>                               Pn0, Pn1, Pn2 :        Integer; </pre></li>
<li id="l47"><pre>                               N             : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l48"><pre>      <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l49"><pre> </pre></li>
<li id="l50"><pre>      <span class="keyword">function</span> Params <span class="keyword">return</span> String <span class="keyword">is</span> </pre></li>
<li id="l51"><pre>        (<span class="string">&quot; Object : &quot;</span> &amp; Trim (o.ID, Right) &amp; </pre></li>
<li id="l52"><pre>           <span class="string">&quot; Pn0 =&quot;</span> &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:32">Pn0</a>) &amp; </pre></li>
<li id="l53"><pre>           <span class="string">&quot; Pn1 =&quot;</span> &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:37">Pn1</a>) &amp; </pre></li>
<li id="l54"><pre>           <span class="string">&quot; Pn2 =&quot;</span> &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:42">Pn2</a>)); </pre></li>
<li id="l55"><pre> </pre></li>
<li id="l56"><pre>      N_contrib : <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l57"><pre> </pre></li>
<li id="l58"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l59"><pre>      <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:32">Pn0</a> /= 0 <span class="keyword">and</span> <span class="keyword">then</span> <a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:37">Pn1</a> /= 0 <span class="keyword">and</span> <span class="keyword">then</span> <a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:42">Pn2</a> /= 0 <span class="keyword">then</span> </pre></li>
<li id="l60"><pre>         <a href="src_globe_3d.adb.html#l56" title="defined at globe_3d.adb:56:7">N_contrib</a> := (o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:37">Pn1</a>) - o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:32">Pn0</a>)) * (o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:42">Pn2</a>) - o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:32">Pn0</a>)); </pre></li>
<li id="l61"><pre>         <span class="keyword">if</span> <span class="droplink">strict_geometry<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:12:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l12" title="To spec">To spec</a></li></ul></span> <span class="keyword">and</span> <span class="keyword">then</span> <span class="droplink">Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<span class="droplink">Norm2<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:31:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l31" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l28" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l56" title="defined at globe_3d.adb:56:7">N_contrib</a>)) <span class="keyword">then</span> </pre></li>
<li id="l62"><pre>            <span class="keyword">pragma</span> Warnings (Off, <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l63"><pre>            Raise_Exception (<span class="droplink">zero_normal<ul><li><a href="globe_3d.ads.html#globe_3d.ads:476:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l476" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l64"><pre>                             <a href="src_globe_3d.adb.html#l50" title="defined at globe_3d.adb:50:16">Params</a> &amp; </pre></li>
<li id="l65"><pre>                               <span class="string">&quot; P0 =&quot;</span> &amp; <span class="droplink">Coords<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l36" title="To body">To body</a></li></ul></span> (o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:32">Pn0</a>)) &amp; </pre></li>
<li id="l66"><pre>                               <span class="string">&quot; P1 =&quot;</span> &amp; <span class="droplink">Coords<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l36" title="To body">To body</a></li></ul></span> (o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:37">Pn1</a>)) &amp; </pre></li>
<li id="l67"><pre>                               <span class="string">&quot; P2 =&quot;</span> &amp; <span class="droplink">Coords<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l36" title="To body">To body</a></li></ul></span> (o.Point (<a href="src_globe_3d.adb.html#l46" title="defined at globe_3d.adb:46:42">Pn2</a>)) &amp; </pre></li>
<li id="l68"><pre>                               <span class="string">&quot; Nc =&quot;</span> &amp; <span class="droplink">Coords<ul><li><a href="globe_3d.ads.html#globe_3d.ads:507:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l507" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l36" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l56" title="defined at globe_3d.adb:56:7">N_contrib</a>)); </pre></li>
<li id="l69"><pre>            <span class="keyword">pragma</span> Warnings (<span class="droplink">On<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>,  <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l70"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l71"><pre>         <a href="src_globe_3d.adb.html#l47" title="defined at globe_3d.adb:47:32">N</a> := <a href="src_globe_3d.adb.html#l47" title="defined at globe_3d.adb:47:32">N</a> + <a href="src_globe_3d.adb.html#l56" title="defined at globe_3d.adb:56:7">N_contrib</a>; </pre></li>
<li id="l72"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l73"><pre> </pre></li>
<li id="l74"><pre>   <span class="keyword">exception</span> </pre></li>
<li id="l75"><pre>      <span class="keyword">when</span> e : <span class="keyword">others</span> =&gt; Raise_Exception (Exception_Identity (e), </pre></li>
<li id="l76"><pre>                                          Exception_Message (e) &amp; <a href="src_globe_3d.adb.html#l50" title="defined at globe_3d.adb:50:16">Params</a>); </pre></li>
<li id="l77"><pre>   <span class="keyword">end</span> <span class="droplink">Add_Normal_of_3p<ul><li><a href="src_globe_3d.adb.html#l45" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l45" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l78"><pre> </pre></li>
<li id="l79"><pre>   <span class="comment">-- blending support</span> </pre></li>
<li id="l80"><pre>   <span class="comment">--</span> </pre></li>
<li id="l81"><pre> </pre></li>
<li id="l82"><pre>   <span class="keyword">function</span> <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:587:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l587" title="To spec">To spec</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:587:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l587" title="To spec">To spec</a></li></ul></span> : <span class="droplink">GL.Double<ul><li><a href="gl.ads.html#gl.ads:128:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l128" title="To spec">To spec</a></li></ul></span>)  <span class="keyword">return</span> Boolean <span class="keyword">is</span> (<span class="keyword">not</span> <span class="droplink">G3DM.Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:587:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l587" title="To spec">To spec</a></li></ul></span> - 1.0)); </pre></li>
<li id="l83"><pre> </pre></li>
<li id="l84"><pre>   <span class="keyword">function</span> <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:588:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l588" title="To spec">To spec</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:588:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l588" title="To spec">To spec</a></li></ul></span> : <span class="droplink">GL.C_Float<ul><li><a href="gl.ads.html#gl.ads:126:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l126" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> Boolean <span class="keyword">is</span> (<span class="keyword">not</span> <span class="droplink">G3DM.Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:85:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l85" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l304" title="To body">To body</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:588:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l588" title="To spec">To spec</a></li></ul></span> - 1.0)); </pre></li>
<li id="l85"><pre> </pre></li>
<li id="l86"><pre>   <span class="keyword">function</span> <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:589:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l589" title="To spec">To spec</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:589:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l589" title="To spec">To spec</a></li></ul></span> : <span class="droplink">GL.Material_Float_vector<ul><li><a href="gl.ads.html#gl.ads:154:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l154" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> Boolean <span class="keyword">is</span> (<span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:588:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l588" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l84" title="To body">To body</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:589:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l589" title="To spec">To spec</a></li></ul></span> (3))); </pre></li>
<li id="l87"><pre> </pre></li>
<li id="l88"><pre>   <span class="keyword">function</span> <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:590:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l590" title="To spec">To spec</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:590:26" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l590" title="To spec">To spec</a></li></ul></span> : <span class="droplink">GL.Materials.Material_type<ul><li><a href="gl-materials.ads.html#gl-materials.ads:25:8" title="To API doc">To API doc</a></li><li><a href="src_gl-materials.ads.html#l25" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> Boolean  <span class="keyword">is</span> </pre></li>
<li id="l89"><pre>     (<span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:589:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l589" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l86" title="To body">To body</a></li></ul></span> (m.ambient) <span class="keyword">or</span> <span class="keyword">else</span> </pre></li>
<li id="l90"><pre>      <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:589:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l589" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l86" title="To body">To body</a></li></ul></span> (m.diffuse) <span class="keyword">or</span> <span class="keyword">else</span> </pre></li>
<li id="l91"><pre>      <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:589:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l589" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l86" title="To body">To body</a></li></ul></span> (m.specular)); </pre></li>
<li id="l92"><pre>   <span class="comment">-- m.emission, m.shininess not relevant</span> </pre></li>
<li id="l93"><pre> </pre></li>
<li id="l94"><pre>   <span class="comment">-- material support</span> </pre></li>
<li id="l95"><pre>   <span class="comment">--</span> </pre></li>
<li id="l96"><pre> </pre></li>
<li id="l97"><pre>   <span class="keyword">procedure</span> <span class="droplink">Set_Material<ul><li><a href="globe_3d.ads.html#globe_3d.ads:594:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l594" title="To spec">To spec</a></li></ul></span> (<span class="droplink">m<ul><li><a href="globe_3d.ads.html#globe_3d.ads:594:28" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l594" title="To spec">To spec</a></li></ul></span> : <span class="droplink">GL.Materials.Material_type<ul><li><a href="gl-materials.ads.html#gl-materials.ads:25:8" title="To API doc">To API doc</a></li><li><a href="src_gl-materials.ads.html#l25" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l98"><pre> </pre></li>
<li id="l99"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l100"><pre>      <span class="droplink">Material<ul><li><a href="gl.ads.html#gl.ads:1847:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1847" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l29" title="To body">To body</a></li></ul></span> (FRONT_AND_BACK, AMBIENT,   m.ambient); </pre></li>
<li id="l101"><pre>      <span class="droplink">Material<ul><li><a href="gl.ads.html#gl.ads:1847:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1847" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l29" title="To body">To body</a></li></ul></span> (FRONT_AND_BACK, DIFFUSE,   m.diffuse); </pre></li>
<li id="l102"><pre>      <span class="droplink">Material<ul><li><a href="gl.ads.html#gl.ads:1847:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1847" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l29" title="To body">To body</a></li></ul></span> (FRONT_AND_BACK, SPECULAR,  m.specular); </pre></li>
<li id="l103"><pre>      <span class="droplink">Material<ul><li><a href="gl.ads.html#gl.ads:1847:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1847" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l29" title="To body">To body</a></li></ul></span> (FRONT_AND_BACK, EMISSION,  m.emission); </pre></li>
<li id="l104"><pre>      <span class="droplink">Material<ul><li><a href="gl.ads.html#gl.ads:1839:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1839" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l3947" title="To body">To body</a></li></ul></span> (FRONT_AND_BACK, SHININESS, m.shininess); </pre></li>
<li id="l105"><pre>   <span class="keyword">end</span> <span class="droplink">Set_Material<ul><li><a href="globe_3d.ads.html#globe_3d.ads:594:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l594" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l97" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l106"><pre> </pre></li>
<li id="l107"><pre>   <span class="comment">-- &apos;Visual&apos;</span> </pre></li>
<li id="l108"><pre>   <span class="comment">--</span> </pre></li>
<li id="l109"><pre> </pre></li>
<li id="l110"><pre>   <span class="keyword">procedure</span> <span class="droplink">Free<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l111"><pre> </pre></li>
<li id="l112"><pre>      <span class="keyword">procedure</span> Deallocate <span class="keyword">is</span> <span class="keyword">new</span> Ada.Unchecked_Deallocation (<span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;Class, <span class="droplink">p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l113"><pre> </pre></li>
<li id="l114"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l115"><pre>      <span class="droplink">Destroy<ul><li><a href="globe_3d.ads.html#globe_3d.ads:212:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l212" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>); </pre></li>
<li id="l116"><pre>      <a href="src_globe_3d.adb.html#l112" title="defined at globe_3d.adb:112:17">Deallocate</a> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l117"><pre>   <span class="keyword">end</span> <span class="droplink">Free<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l110" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l118"><pre> </pre></li>
<li id="l119"><pre>   <span class="keyword">function</span> <span class="droplink">skinned_Geometrys<ul><li><a href="globe_3d.ads.html#globe_3d.ads:227:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l227" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> <span class="droplink">GL.Skinned_Geometry.skinned_Geometrys<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:23:9" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l23" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l120"><pre>     (<span class="droplink">GL.Skinned_Geometry.null_skinned_Geometrys<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:25:4" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l25" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l121"><pre> </pre></li>
<li id="l122"><pre>   <span class="keyword">function</span> <span class="droplink">Width<ul><li><a href="globe_3d.ads.html#globe_3d.ads:237:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l237" title="To spec">To spec</a></li></ul></span>  (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:237:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l237" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;class) <span class="keyword">return</span> <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l123"><pre>        (<span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:225:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l225" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:237:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l237" title="To spec">To spec</a></li></ul></span>).Box.X_Extent.Max - <span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:225:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l225" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:237:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l237" title="To spec">To spec</a></li></ul></span>).Box.X_Extent.Min); </pre></li>
<li id="l124"><pre> </pre></li>
<li id="l125"><pre>   <span class="keyword">function</span> <span class="droplink">Height<ul><li><a href="globe_3d.ads.html#globe_3d.ads:238:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l238" title="To spec">To spec</a></li></ul></span>  (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:238:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l238" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;class) <span class="keyword">return</span> <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l126"><pre>        (<span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:225:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l225" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:238:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l238" title="To spec">To spec</a></li></ul></span>).Box.Y_Extent.Max - <span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:225:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l225" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:238:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l238" title="To spec">To spec</a></li></ul></span>).Box.Y_Extent.Min); </pre></li>
<li id="l127"><pre> </pre></li>
<li id="l128"><pre>   <span class="keyword">function</span> <span class="droplink">Depth<ul><li><a href="globe_3d.ads.html#globe_3d.ads:239:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l239" title="To spec">To spec</a></li></ul></span>  (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:239:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l239" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;class) <span class="keyword">return</span> <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l129"><pre>        (<span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:225:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l225" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:239:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l239" title="To spec">To spec</a></li></ul></span>).Box.Z_Extent.Max - <span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:225:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l225" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:239:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l239" title="To spec">To spec</a></li></ul></span>).Box.Z_Extent.Min); </pre></li>
<li id="l130"><pre> </pre></li>
<li id="l131"><pre>   <span class="comment">-- &apos;Object_3D&apos;</span> </pre></li>
<li id="l132"><pre>   <span class="comment">--</span> </pre></li>
<li id="l133"><pre> </pre></li>
<li id="l134"><pre>   <span class="comment">-- object validation</span> </pre></li>
<li id="l135"><pre>   <span class="comment">--</span> </pre></li>
<li id="l136"><pre> </pre></li>
<li id="l137"><pre>   <span class="keyword">procedure</span> <span class="droplink">Check_object<ul><li><a href="globe_3d.ads.html#globe_3d.ads:393:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l393" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:393:28" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l393" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l138"><pre> </pre></li>
<li id="l139"><pre>      <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l140"><pre> </pre></li>
<li id="l141"><pre>      <span class="keyword">procedure</span> Check_faces <span class="keyword">is</span> </pre></li>
<li id="l142"><pre> </pre></li>
<li id="l143"><pre>         <span class="keyword">procedure</span> Check (f, v : Integer) <span class="keyword">is</span> </pre></li>
<li id="l144"><pre>            <span class="keyword">pragma</span> Inline (<span class="droplink">Check<ul><li><a href="src_globe_3d.adb.html#l143" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l143" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l145"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l146"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l143" title="defined at globe_3d.adb:143:30">v</a> &lt; 0 <span class="keyword">or</span> <span class="keyword">else</span> <a href="src_globe_3d.adb.html#l143" title="defined at globe_3d.adb:143:30">v</a> &gt; o.Max_points <span class="keyword">then</span> </pre></li>
<li id="l147"><pre>               Raise_Exception (<span class="droplink">bad_vertex_number<ul><li><a href="globe_3d.ads.html#globe_3d.ads:419:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l419" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l148"><pre>                                o.ID &amp; <span class="string">&quot; face =&quot;</span>   &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l143" title="defined at globe_3d.adb:143:27">f</a>) &amp; </pre></li>
<li id="l149"><pre>                                  <span class="string">&quot; vertex =&quot;</span> &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l143" title="defined at globe_3d.adb:143:30">v</a>)); </pre></li>
<li id="l150"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l151"><pre>         <span class="keyword">end</span> <span class="droplink">Check<ul><li><a href="src_globe_3d.adb.html#l143" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l143" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l152"><pre> </pre></li>
<li id="l153"><pre>         <span class="keyword">procedure</span> Check_duplicate (f, Pn1, Pn2 : Integer) <span class="keyword">is</span> </pre></li>
<li id="l154"><pre>            <span class="keyword">pragma</span> Inline (<span class="droplink">Check_duplicate<ul><li><a href="src_globe_3d.adb.html#l153" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l153" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l155"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l156"><pre>            <span class="comment">-- Skip &quot;dead&quot; edge (triangle), 30 - Dec - 2001</span> </pre></li>
<li id="l157"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:40">Pn1</a> = 0 <span class="keyword">or</span> <span class="keyword">else</span> <a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:45">Pn2</a> = 0 <span class="keyword">then</span> </pre></li>
<li id="l158"><pre>               <span class="keyword">return</span>; </pre></li>
<li id="l159"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l160"><pre>            <span class="comment">-- Detect same point number</span> </pre></li>
<li id="l161"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:40">Pn1</a> = <a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:45">Pn2</a> <span class="keyword">then</span> </pre></li>
<li id="l162"><pre>               Raise_Exception (<span class="droplink">duplicated_vertex<ul><li><a href="globe_3d.ads.html#globe_3d.ads:419:23" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l419" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l163"><pre>                                o.ID &amp; <span class="string">&quot; in face &quot;</span>   &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:37">f</a>)); </pre></li>
<li id="l164"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l165"><pre>            <span class="comment">-- Detect same point coordinates (tolerated in an object,</span> </pre></li>
<li id="l166"><pre>            <span class="comment">-- although inefficient, but harms as vertex of the same face!)</span> </pre></li>
<li id="l167"><pre> </pre></li>
<li id="l168"><pre>            <span class="keyword">if</span> <span class="droplink">Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<span class="droplink">Norm2<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:31:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l31" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l28" title="To body">To body</a></li></ul></span> (o.Point (<a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:40">Pn1</a>) - o.Point (<a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:45">Pn2</a>))) <span class="keyword">then</span> </pre></li>
<li id="l169"><pre>               Raise_Exception (<span class="droplink">duplicated_vertex_location<ul><li><a href="globe_3d.ads.html#globe_3d.ads:420:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l420" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l170"><pre>                                o.ID &amp; <span class="string">&quot; in face &quot;</span>   &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l153" title="defined at globe_3d.adb:153:37">f</a>)); </pre></li>
<li id="l171"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l172"><pre>         <span class="keyword">end</span> <span class="droplink">Check_duplicate<ul><li><a href="src_globe_3d.adb.html#l153" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l153" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l173"><pre> </pre></li>
<li id="l174"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l175"><pre>         <span class="keyword">for</span> fa <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l176"><pre>            <span class="keyword">for</span> edge_num <span class="keyword">in</span> 1 .. 4 <span class="keyword">loop</span> </pre></li>
<li id="l177"><pre>               <span class="droplink">Check<ul><li><a href="src_globe_3d.adb.html#l143" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l143" title="To body">To body</a></li></ul></span> (fa, o.face (fa).P (edge_num)); </pre></li>
<li id="l178"><pre>               <span class="keyword">for</span> other_edge <span class="keyword">in</span> edge_num + 1 .. 4 <span class="keyword">loop</span> </pre></li>
<li id="l179"><pre>                  <span class="droplink">Check_duplicate<ul><li><a href="src_globe_3d.adb.html#l153" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l153" title="To body">To body</a></li></ul></span> (fa, o.face (fa).P (edge_num), </pre></li>
<li id="l180"><pre>                                   o.face (fa).P (other_edge)); </pre></li>
<li id="l181"><pre>               <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l182"><pre>            <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l183"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; <span class="comment">-- fa</span> </pre></li>
<li id="l184"><pre>      <span class="keyword">end</span> <span class="droplink">Check_faces<ul><li><a href="src_globe_3d.adb.html#l141" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l141" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l185"><pre> </pre></li>
<li id="l186"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l187"><pre>      <span class="droplink">Check_faces<ul><li><a href="src_globe_3d.adb.html#l141" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l141" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l188"><pre>   <span class="keyword">end</span> <span class="droplink">Check_object<ul><li><a href="globe_3d.ads.html#globe_3d.ads:393:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l393" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l137" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l189"><pre> </pre></li>
<li id="l190"><pre>   <span class="comment">--------------------------------------------</span> </pre></li>
<li id="l191"><pre>   <span class="comment">-- Object initialization (1x in its life) --</span> </pre></li>
<li id="l192"><pre>   <span class="comment">--------------------------------------------</span> </pre></li>
<li id="l193"><pre> </pre></li>
<li id="l194"><pre>   <span class="keyword">overriding</span> <span class="keyword">procedure</span> <span class="droplink">Pre_calculate<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l195"><pre> </pre></li>
<li id="l196"><pre>      <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l197"><pre> </pre></li>
<li id="l198"><pre>      N        : <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l199"><pre>      length_N : <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l200"><pre> </pre></li>
<li id="l201"><pre>      <span class="keyword">procedure</span> Calculate_face_invariants ( </pre></li>
<li id="l202"><pre>                                           fa :     <span class="droplink">Face_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:294:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l294" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l203"><pre>                                           fi : <span class="keyword">out</span> <span class="droplink">Face_invariant_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:340:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l340" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l544" title="To body">To body</a></li></ul></span> </pre></li>
<li id="l204"><pre>                                          ) <span class="keyword">is</span> </pre></li>
<li id="l205"><pre>         l : Natural := 0; </pre></li>
<li id="l206"><pre>         quadri_edge :  <span class="keyword">array</span> (fa.P&apos;Range) <span class="keyword">of</span> Natural; </pre></li>
<li id="l207"><pre>         ex_U, ex_V : <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l208"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l209"><pre>         <a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a> := 0; </pre></li>
<li id="l210"><pre>         <span class="keyword">for</span> qe <span class="keyword">in</span> fa.P&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l211"><pre>            <span class="keyword">if</span> fa.P (qe) /= 0 <span class="keyword">then</span> </pre></li>
<li id="l212"><pre>               <a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a> := <a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a> + 1; </pre></li>
<li id="l213"><pre>               <a href="src_globe_3d.adb.html#l206" title="defined at globe_3d.adb:206:10">quadri_edge</a> (<a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a>) := qe; <span class="comment">-- if triangle, &quot;map&quot; edge on a quadri</span> </pre></li>
<li id="l214"><pre>               fi.P_compact (<a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a>) := fa.P (qe); </pre></li>
<li id="l215"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l216"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l217"><pre>         <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a> <span class="keyword">in</span> <span class="droplink">Edge_count<ul><li><a href="globe_3d.ads.html#globe_3d.ads:336:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l336" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l218"><pre>            fi.last_edge := <a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a>; </pre></li>
<li id="l219"><pre>         <span class="keyword">else</span> </pre></li>
<li id="l220"><pre>            Raise_Exception (<span class="droplink">bad_edge_number<ul><li><a href="globe_3d.ads.html#globe_3d.ads:422:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l422" title="To spec">To spec</a></li></ul></span>&apos;Identity, o.ID); </pre></li>
<li id="l221"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l222"><pre>         <span class="comment">-- * Face invariant : Textured face : extremities</span> </pre></li>
<li id="l223"><pre>         <span class="keyword">for</span> e <span class="keyword">in</span> 1 .. <a href="src_globe_3d.adb.html#l205" title="defined at globe_3d.adb:205:10">l</a> <span class="keyword">loop</span> </pre></li>
<li id="l224"><pre>            <span class="keyword">if</span> fa.whole_texture <span class="keyword">then</span> </pre></li>
<li id="l225"><pre>               <a href="src_globe_3d.adb.html#l207" title="defined at globe_3d.adb:207:10">ex_U</a> := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> (fa.repeat_U); </pre></li>
<li id="l226"><pre>               <a href="src_globe_3d.adb.html#l207" title="defined at globe_3d.adb:207:16">ex_V</a> := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> (fa.repeat_V); </pre></li>
<li id="l227"><pre>               <span class="keyword">case</span> <a href="src_globe_3d.adb.html#l206" title="defined at globe_3d.adb:206:10">quadri_edge</a> (e) <span class="keyword">is</span> </pre></li>
<li id="l228"><pre>               <span class="keyword">when</span> 1 =&gt; fi.UV_extrema (e) := (0.0, 0.0); <span class="comment">-- bottom, left  4 --&lt; --3</span> </pre></li>
<li id="l229"><pre>               <span class="keyword">when</span> 2 =&gt; fi.UV_extrema (e) := (<a href="src_globe_3d.adb.html#l207" title="defined at globe_3d.adb:207:10">ex_U</a>, 0.0); <span class="comment">-- bottom, right |     |</span> </pre></li>
<li id="l230"><pre>               <span class="keyword">when</span> 3 =&gt; fi.UV_extrema (e) := (<a href="src_globe_3d.adb.html#l207" title="defined at globe_3d.adb:207:10">ex_U</a>, <a href="src_globe_3d.adb.html#l207" title="defined at globe_3d.adb:207:16">ex_V</a>); <span class="comment">-- top, right    1 --&gt; --2</span> </pre></li>
<li id="l231"><pre>               <span class="keyword">when</span> 4 =&gt; fi.UV_extrema (e) := (0.0, <a href="src_globe_3d.adb.html#l207" title="defined at globe_3d.adb:207:16">ex_V</a>); <span class="comment">-- top, left</span> </pre></li>
<li id="l232"><pre>               <span class="keyword">when</span> <span class="keyword">others</span> =&gt; <span class="keyword">null</span>; </pre></li>
<li id="l233"><pre>               <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l234"><pre>            <span class="keyword">else</span> </pre></li>
<li id="l235"><pre>               <span class="comment">-- Just copy the mapping, but in compact form for triangles :</span> </pre></li>
<li id="l236"><pre>               fi.UV_extrema (e) := fa.texture_edge_map (<a href="src_globe_3d.adb.html#l206" title="defined at globe_3d.adb:206:10">quadri_edge</a> (e)); </pre></li>
<li id="l237"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l238"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l239"><pre>         <span class="comment">-- * Face invariant : Normal of unrotated face</span> </pre></li>
<li id="l240"><pre>         <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a> := (0.0, 0.0, 0.0); </pre></li>
<li id="l241"><pre>         <span class="keyword">case</span> fi.last_edge <span class="keyword">is</span> </pre></li>
<li id="l242"><pre>         <span class="keyword">when</span> 3 =&gt; </pre></li>
<li id="l243"><pre>            <span class="droplink">Add_Normal_of_3p<ul><li><a href="src_globe_3d.adb.html#l45" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l45" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>, </pre></li>
<li id="l244"><pre>                              fi.P_compact (1), </pre></li>
<li id="l245"><pre>                              fi.P_compact (2), </pre></li>
<li id="l246"><pre>                              fi.P_compact (3), </pre></li>
<li id="l247"><pre>                              <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a> </pre></li>
<li id="l248"><pre>                             ); </pre></li>
<li id="l249"><pre>         <span class="keyword">when</span> 4 =&gt; </pre></li>
<li id="l250"><pre>            <span class="droplink">Add_Normal_of_3p<ul><li><a href="src_globe_3d.adb.html#l45" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l45" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>, fa.P (1), fa.P (2), fa.P (4), <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>); </pre></li>
<li id="l251"><pre>            <span class="comment">-- We sum other normals for not perfectly flat faces,</span> </pre></li>
<li id="l252"><pre>            <span class="comment">-- in order to have a convenient average .. .</span> </pre></li>
<li id="l253"><pre>            <span class="droplink">Add_Normal_of_3p<ul><li><a href="src_globe_3d.adb.html#l45" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l45" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>, fa.P (2), fa.P (3), fa.P (1), <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>); </pre></li>
<li id="l254"><pre>            <span class="droplink">Add_Normal_of_3p<ul><li><a href="src_globe_3d.adb.html#l45" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l45" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>, fa.P (3), fa.P (4), fa.P (2), <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>); </pre></li>
<li id="l255"><pre>            <span class="droplink">Add_Normal_of_3p<ul><li><a href="src_globe_3d.adb.html#l45" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l45" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>, fa.P (4), fa.P (1), fa.P (3), <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>); </pre></li>
<li id="l256"><pre>         <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l257"><pre>         <a href="src_globe_3d.adb.html#l199" title="defined at globe_3d.adb:199:7">length_N</a> := <span class="droplink">Norm<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:28:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l28" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l26" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>); </pre></li>
<li id="l258"><pre>         <span class="keyword">if</span> <span class="droplink">Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l199" title="defined at globe_3d.adb:199:7">length_N</a>) <span class="keyword">then</span> </pre></li>
<li id="l259"><pre>            <span class="keyword">if</span> <span class="droplink">strict_geometry<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:12:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l12" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l260"><pre>               <span class="keyword">pragma</span> Warnings (Off, <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l261"><pre>               <span class="keyword">raise</span> <span class="droplink">zero_summed_normal<ul><li><a href="globe_3d.ads.html#globe_3d.ads:477:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l477" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l262"><pre>               <span class="keyword">pragma</span> Warnings (<span class="droplink">On<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>,  <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l263"><pre>            <span class="keyword">else</span> </pre></li>
<li id="l264"><pre>               fi.normal := <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>; <span class="comment">-- 0 vector !</span> </pre></li>
<li id="l265"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l266"><pre>         <span class="keyword">else</span> </pre></li>
<li id="l267"><pre>            fi.normal := (1.0 / <a href="src_globe_3d.adb.html#l199" title="defined at globe_3d.adb:199:7">length_N</a>) * <a href="src_globe_3d.adb.html#l198" title="defined at globe_3d.adb:198:7">N</a>; </pre></li>
<li id="l268"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l269"><pre>      <span class="keyword">end</span> <span class="droplink">Calculate_face_invariants<ul><li><a href="src_globe_3d.adb.html#l201" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l201" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l270"><pre> </pre></li>
<li id="l271"><pre>      adjacent_faces : <span class="keyword">array</span> (o.Point&apos;Range) <span class="keyword">of</span> Natural := (<span class="keyword">others</span> =&gt; 0); </pre></li>
<li id="l272"><pre>      pf : Natural; </pre></li>
<li id="l273"><pre>      length : <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l274"><pre> </pre></li>
<li id="l275"><pre>   <span class="keyword">begin</span> <span class="comment">-- Pre_calculate</span> </pre></li>
<li id="l276"><pre>      <span class="keyword">if</span> <span class="droplink">full_check_objects<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:11:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l11" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l277"><pre>         <span class="keyword">pragma</span> Warnings (Off, <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l278"><pre>         <span class="droplink">Check_object<ul><li><a href="globe_3d.ads.html#globe_3d.ads:393:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l393" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l137" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:40" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l279"><pre>         <span class="keyword">pragma</span> Warnings (<span class="droplink">On<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>,  <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l280"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l281"><pre> </pre></li>
<li id="l282"><pre>      <span class="keyword">for</span> i <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l283"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l284"><pre>            <span class="comment">-- Geometry</span> </pre></li>
<li id="l285"><pre>            <span class="droplink">Calculate_face_invariants<ul><li><a href="src_globe_3d.adb.html#l201" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l201" title="To body">To body</a></li></ul></span> (o.face (i), o.Face_Invariant (i)); </pre></li>
<li id="l286"><pre>            <span class="comment">-- Disable blending when alphas are = 1</span> </pre></li>
<li id="l287"><pre>            <span class="keyword">case</span> o.face (i).skin <span class="keyword">is</span> </pre></li>
<li id="l288"><pre>            <span class="keyword">when</span> material_only | material_texture =&gt; </pre></li>
<li id="l289"><pre>               o.Face_Invariant (i).blending := <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:590:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l590" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l88" title="To body">To body</a></li></ul></span> (o.face (i).material); </pre></li>
<li id="l290"><pre>            <span class="keyword">when</span> colour_only | coloured_texture | texture_only =&gt; </pre></li>
<li id="l291"><pre>               o.Face_Invariant (i).blending := <span class="droplink">Is_to_blend<ul><li><a href="globe_3d.ads.html#globe_3d.ads:587:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l587" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l82" title="To body">To body</a></li></ul></span> (o.face (i).alpha); </pre></li>
<li id="l292"><pre>            <span class="keyword">when</span> invisible =&gt; </pre></li>
<li id="l293"><pre>               o.Face_Invariant (i).blending := False; </pre></li>
<li id="l294"><pre>            <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l295"><pre>            o.transparent := o.transparent <span class="keyword">or</span> <span class="keyword">else</span> o.Face_Invariant (i).blending; </pre></li>
<li id="l296"><pre>         <span class="keyword">exception</span> </pre></li>
<li id="l297"><pre>            <span class="keyword">when</span> <span class="droplink">zero_summed_normal<ul><li><a href="globe_3d.ads.html#globe_3d.ads:477:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l477" title="To spec">To spec</a></li></ul></span> =&gt; </pre></li>
<li id="l298"><pre>               Raise_Exception (<span class="droplink">zero_summed_normal<ul><li><a href="globe_3d.ads.html#globe_3d.ads:477:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l477" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l299"><pre>                                o.ID &amp; <span class="string">&quot; face =&quot;</span> &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (i)); </pre></li>
<li id="l300"><pre>         <span class="keyword">end</span>; </pre></li>
<li id="l301"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l302"><pre> </pre></li>
<li id="l303"><pre>      <span class="keyword">declare</span> </pre></li>
<li id="l304"><pre>         <span class="keyword">use</span> <span class="droplink">GLOBE_3D.REF<ul><li><a href="globe_3d.ads.html#globe_3d.ads:103:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l103" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l305"><pre>         max_Norm2 : <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> := 0.0; </pre></li>
<li id="l306"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l307"><pre>         o.Bounds.Box.X_Extent.Min := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Last;   o.Bounds.Box.X_Extent.Max := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;First; </pre></li>
<li id="l308"><pre>         o.Bounds.Box.Y_Extent.Min := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Last;   o.Bounds.Box.Y_Extent.Max := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;First; </pre></li>
<li id="l309"><pre>         o.Bounds.Box.Z_Extent.Min := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Last;   o.Bounds.Box.Z_Extent.Max := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;First; </pre></li>
<li id="l310"><pre> </pre></li>
<li id="l311"><pre>         <span class="keyword">for</span> p <span class="keyword">in</span> o.Point&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l312"><pre>            o.edge_vector (p)          := (0.0, 0.0, 0.0); </pre></li>
<li id="l313"><pre>            max_Norm2                 := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Max (<span class="droplink">Norm2<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:31:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l31" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l28" title="To body">To body</a></li></ul></span> (o.Point (p)),  max_Norm2); </pre></li>
<li id="l314"><pre> </pre></li>
<li id="l315"><pre>            o.Bounds.Box.X_Extent.Min := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Min (o.Bounds.Box.X_Extent.Min,  o.Point (p) (0));  <span class="comment">-- tbd : set extents and bounding sphere radius in</span> </pre></li>
<li id="l316"><pre>            o.Bounds.Box.X_Extent.Max := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Max (o.Bounds.Box.X_Extent.Max,  o.Point (p) (0));  <span class="comment">--      common procedure for &apos;object_base&apos; class.</span> </pre></li>
<li id="l317"><pre>            o.Bounds.Box.Y_Extent.Min := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Min (o.Bounds.Box.Y_Extent.Min,  o.Point (p) (1)); </pre></li>
<li id="l318"><pre>            o.Bounds.Box.Y_Extent.Max := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Max (o.Bounds.Box.Y_Extent.Max,  o.Point (p) (1)); </pre></li>
<li id="l319"><pre>            o.Bounds.Box.Z_Extent.Min := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Min (o.Bounds.Box.Z_Extent.Min,  o.Point (p) (2)); </pre></li>
<li id="l320"><pre>            o.Bounds.Box.Z_Extent.Max := <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>&apos;Max (o.Bounds.Box.Z_Extent.Max,  o.Point (p) (2)); </pre></li>
<li id="l321"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l322"><pre> </pre></li>
<li id="l323"><pre>         o.Bounds.Sphere_Radius := Sqrt (max_Norm2); </pre></li>
<li id="l324"><pre>      <span class="keyword">end</span>; </pre></li>
<li id="l325"><pre> </pre></li>
<li id="l326"><pre>      <span class="comment">-- Calculate edge vectors.</span> </pre></li>
<li id="l327"><pre>      <span class="comment">--   Naive algorithm : for each point, scan all faces to see</span> </pre></li>
<li id="l328"><pre>      <span class="comment">--   if they are adjacent. It took #points * #faces steps.</span> </pre></li>
<li id="l329"><pre>      <span class="comment">--   - &gt; better algorithm here : 2 * #points + 4 * #faces. (22 - Jan - 2006)</span> </pre></li>
<li id="l330"><pre>      <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l331"><pre>         <span class="keyword">for</span> p <span class="keyword">in</span> o.face (f).P&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l332"><pre>            <a href="src_globe_3d.adb.html#l272" title="defined at globe_3d.adb:272:7">pf</a> := o.face (f).P (p); </pre></li>
<li id="l333"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l272" title="defined at globe_3d.adb:272:7">pf</a> /= 0 <span class="keyword">then</span> </pre></li>
<li id="l334"><pre>               <a href="src_globe_3d.adb.html#l271" title="defined at globe_3d.adb:271:7">adjacent_faces</a> (<a href="src_globe_3d.adb.html#l272" title="defined at globe_3d.adb:272:7">pf</a>) := <a href="src_globe_3d.adb.html#l271" title="defined at globe_3d.adb:271:7">adjacent_faces</a> (<a href="src_globe_3d.adb.html#l272" title="defined at globe_3d.adb:272:7">pf</a>) + 1; </pre></li>
<li id="l335"><pre>               o.edge_vector (<a href="src_globe_3d.adb.html#l272" title="defined at globe_3d.adb:272:7">pf</a>) := o.edge_vector (<a href="src_globe_3d.adb.html#l272" title="defined at globe_3d.adb:272:7">pf</a>) + o.Face_Invariant (f).normal; </pre></li>
<li id="l336"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l337"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l338"><pre>         <span class="keyword">if</span> <span class="droplink">is_textured<ul><li><a href="globe_3d.ads.html#globe_3d.ads:279:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l279" title="To spec">To spec</a></li></ul></span> (o.face (f).skin) <span class="keyword">and</span> <span class="keyword">then</span> </pre></li>
<li id="l339"><pre>           <span class="keyword">not</span> <span class="droplink">Textures.Valid_texture_ID<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:86:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l86" title="To spec">To spec</a></li><li><a href="src_globe_3d-textures.adb.html#l97" title="To body">To body</a></li></ul></span> (o.face (f).texture) </pre></li>
<li id="l340"><pre>         <span class="keyword">then</span> </pre></li>
<li id="l341"><pre>            Raise_Exception (<span class="droplink">Textures.Undefined_texture_ID<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:93:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l93" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l342"><pre>                             Trim (o.ID, Right) &amp; </pre></li>
<li id="l343"><pre>                               <span class="string">&quot; face =&quot;</span>   &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (f) &amp; </pre></li>
<li id="l344"><pre>                               <span class="string">&quot; skin =&quot;</span>   &amp; <span class="droplink">Skin_Type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:270:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l270" title="To spec">To spec</a></li></ul></span>&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (o.face (f).skin) &amp; </pre></li>
<li id="l345"><pre>                               <span class="string">&quot; texture_id =&quot;</span> &amp; <span class="droplink">Image_ID<ul><li><a href="globe_3d.ads.html#globe_3d.ads:99:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l99" title="To spec">To spec</a></li></ul></span>&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (o.face (f).texture)); </pre></li>
<li id="l346"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l347"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l348"><pre>      <span class="keyword">for</span> p <span class="keyword">in</span> o.Point&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l349"><pre>         <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l271" title="defined at globe_3d.adb:271:7">adjacent_faces</a> (p) = 0 <span class="keyword">then</span> </pre></li>
<li id="l350"><pre>            <span class="keyword">if</span> <span class="droplink">strict_geometry<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:12:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l12" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l351"><pre>               <span class="keyword">pragma</span> Warnings (Off, <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l352"><pre>               <span class="comment">-- Strict approach : detect any unmatched point :</span> </pre></li>
<li id="l353"><pre>               Raise_Exception (<span class="droplink">point_unmatched<ul><li><a href="globe_3d.ads.html#globe_3d.ads:421:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l421" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l354"><pre>                                Trim (o.ID, Right) &amp; </pre></li>
<li id="l355"><pre>                                  <span class="string">&quot; point &quot;</span> &amp; Integer&apos;<span class="droplink">Image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:505:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l505" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l24" title="To body">To body</a></li></ul></span> (p) &amp; </pre></li>
<li id="l356"><pre>                                  <span class="string">&quot; belongs to none of the object&apos;s face&quot;</span>); </pre></li>
<li id="l357"><pre>               <span class="keyword">pragma</span> Warnings (<span class="droplink">On<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>,  <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l358"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l359"><pre>         <span class="keyword">else</span> </pre></li>
<li id="l360"><pre>            <a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">length</a> := <span class="droplink">Norm<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:28:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l28" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l26" title="To body">To body</a></li></ul></span> (o.edge_vector (p)); </pre></li>
<li id="l361"><pre>            <span class="keyword">if</span> <span class="keyword">not</span> <span class="droplink">Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">length</a>) <span class="keyword">then</span> </pre></li>
<li id="l362"><pre>               o.edge_vector (p) := (1.0 / <a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">length</a>) * o.edge_vector (p); </pre></li>
<li id="l363"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l364"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l365"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l366"><pre> </pre></li>
<li id="l367"><pre>      <span class="comment">-- Ooof. Now we can certify :</span> </pre></li>
<li id="l368"><pre>      o.pre_calculated := True; </pre></li>
<li id="l369"><pre>   <span class="keyword">end</span> <span class="droplink">Pre_calculate<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l370"><pre> </pre></li>
<li id="l371"><pre>   <span class="keyword">procedure</span> Arrow (P : <span class="droplink">Point_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:111:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l111" title="To spec">To spec</a></li></ul></span>; D : <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l372"><pre> </pre></li>
<li id="l373"><pre>      <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l374"><pre> </pre></li>
<li id="l375"><pre>      V, V1, V2 : <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l376"><pre> </pre></li>
<li id="l377"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l378"><pre>      <span class="keyword">if</span> <span class="droplink">Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<span class="droplink">Norm2<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:31:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l31" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l28" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a>)) <span class="keyword">then</span> </pre></li>
<li id="l379"><pre>         <span class="keyword">return</span>; </pre></li>
<li id="l380"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l381"><pre>      <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a> := (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a> (1), -<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a> (0), 0.0);         <span class="comment">-- an orthogonal, or zero</span> </pre></li>
<li id="l382"><pre>      <span class="keyword">if</span> <span class="droplink">Almost_zero<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:83:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l83" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l302" title="To body">To body</a></li></ul></span> (<span class="droplink">Norm2<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:31:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l31" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l28" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a>)) <span class="keyword">then</span> <span class="comment">-- bad luck, it is zero</span> </pre></li>
<li id="l383"><pre>         <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a> := (0.0, -<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a> (2), <a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a> (1));       <span class="comment">-- 2nd try</span> </pre></li>
<li id="l384"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l385"><pre>      <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a> := (0.2 / <span class="droplink">Norm<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:28:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l28" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l26" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a>)) * <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a>; </pre></li>
<li id="l386"><pre>      <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:10">V1</a> := 0.7 * <a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a> + <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a>; </pre></li>
<li id="l387"><pre>      <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:14">V2</a> := 0.7 * <a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a> - <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:7">V</a>; </pre></li>
<li id="l388"><pre>      <span class="droplink">GL_Begin<ul><li><a href="gl.ads.html#gl.ads:1432:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1432" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4190" title="To body">To body</a></li></ul></span> (GL.LINES); </pre></li>
<li id="l389"><pre>      <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:21">P</a> + <a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a>);    <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:21">P</a>); </pre></li>
<li id="l390"><pre>      <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:21">P</a> + <a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a>);    <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:21">P</a> + <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:10">V1</a>); </pre></li>
<li id="l391"><pre>      <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:21">P</a> + <a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:35">D</a>);    <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l371" title="defined at globe_3d.adb:371:21">P</a> + <a href="src_globe_3d.adb.html#l375" title="defined at globe_3d.adb:375:14">V2</a>); </pre></li>
<li id="l392"><pre>      <span class="droplink">GL_End<ul><li><a href="gl.ads.html#gl.ads:1434:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1434" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4191" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l393"><pre>   <span class="keyword">end</span> <span class="droplink">Arrow<ul><li><a href="src_globe_3d.adb.html#l371" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l371" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l394"><pre> </pre></li>
<li id="l395"><pre>   <span class="comment">--     neutral_material_already_set : Boolean := False;</span> </pre></li>
<li id="l396"><pre> </pre></li>
<li id="l397"><pre>   <span class="comment">-------------</span> </pre></li>
<li id="l398"><pre>   <span class="comment">-- Display --</span> </pre></li>
<li id="l399"><pre>   <span class="comment">-------------</span> </pre></li>
<li id="l400"><pre> </pre></li>
<li id="l401"><pre>   <span class="keyword">procedure</span> <span class="droplink">Display_one<ul><li><a href="globe_3d.ads.html#globe_3d.ads:448:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l448" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:448:27" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l448" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l402"><pre>      <span class="comment">-- Display only this object and not connected objects</span> </pre></li>
<li id="l403"><pre>      <span class="comment">-- out : object will be initialized if not yet</span> </pre></li>
<li id="l404"><pre> </pre></li>
<li id="l405"><pre>      <span class="comment">--</span> </pre></li>
<li id="l406"><pre> </pre></li>
<li id="l407"><pre>      <span class="comment">--</span> </pre></li>
<li id="l408"><pre>      <span class="comment">-- Display face routine which is optimized to produce a shorter list</span> </pre></li>
<li id="l409"><pre>      <span class="comment">-- of GL commands. Runs slower then the original Display face routine</span> </pre></li>
<li id="l410"><pre>      <span class="comment">-- yet needs to be executed only once.</span> </pre></li>
<li id="l411"><pre>      <span class="comment">--</span> </pre></li>
<li id="l412"><pre>      <span class="comment">-- Uwe R. Zimmer, July 2011</span> </pre></li>
<li id="l413"><pre>      <span class="comment">--</span> </pre></li>
<li id="l414"><pre>      <span class="keyword">package</span> <a href="src_globe_3d.adb.html#l421" title="defined at globe_3d.adb:414:15">Display_face_optimized</a> <span class="keyword">is</span> </pre></li>
<li id="l415"><pre>         <span class="keyword">procedure</span> <a href="src_globe_3d.adb.html#l425" title="defined at globe_3d.adb:415:20">Display_face</a> (First_Face : Boolean; <a href="src_globe_3d.adb.html#l425" title="defined at globe_3d.adb:415:56">fa</a> : <span class="droplink">Face_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:294:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l294" title="To spec">To spec</a></li></ul></span>; <a href="src_globe_3d.adb.html#l425" title="defined at globe_3d.adb:415:72">fi</a> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Face_invariant_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:340:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l340" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l544" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l416"><pre>      <span class="keyword">private</span> </pre></li>
<li id="l417"><pre>         Previous_face           : <span class="droplink">Face_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:294:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l294" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l418"><pre>         Previous_face_Invariant : <span class="droplink">Face_invariant_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:340:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l340" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l544" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l419"><pre>      <span class="keyword">end</span> <span class="droplink">Display_face_optimized<ul><li><a href="src_globe_3d.adb.html#l414" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l421" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l420"><pre> </pre></li>
<li id="l421"><pre>      <span class="keyword">package</span> <span class="keyword">body</span> <a href="src_globe_3d.adb.html#l414" title="defined at globe_3d.adb:414:15">Display_face_optimized</a> <span class="keyword">is</span> </pre></li>
<li id="l422"><pre> </pre></li>
<li id="l423"><pre>         <span class="keyword">use</span> <span class="droplink">GL.Materials<ul><li><a href="gl-materials.ads.html#gl-materials.ads:1:12" title="To API doc">To API doc</a></li><li><a href="src_gl-materials.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_gl-materials.adb.html#l1" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l424"><pre> </pre></li>
<li id="l425"><pre>         <span class="keyword">procedure</span> <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:20">Display_face</a> (<a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:34">First_Face</a> : Boolean; <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:56">fa</a> : <span class="droplink">Face_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:294:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l294" title="To spec">To spec</a></li></ul></span>; <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:72">fi</a> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Face_invariant_type<ul><li><a href="globe_3d.ads.html#globe_3d.ads:340:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l340" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l544" title="To body">To body</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l426"><pre> </pre></li>
<li id="l427"><pre>            blending_hint : Boolean; </pre></li>
<li id="l428"><pre> </pre></li>
<li id="l429"><pre>         <span class="keyword">begin</span> <span class="comment">-- Display_face</span> </pre></li>
<li id="l430"><pre> </pre></li>
<li id="l431"><pre>            <span class="keyword">if</span> fa.skin = invisible <span class="keyword">then</span> </pre></li>
<li id="l432"><pre>               <a href="src_globe_3d.adb.html#l417" title="defined at globe_3d.adb:417:10">Previous_face</a>           := <span class="droplink">fa<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l433"><pre>               <a href="src_globe_3d.adb.html#l418" title="defined at globe_3d.adb:418:10">Previous_face_Invariant</a> := <span class="droplink">fi<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l434"><pre>               <span class="keyword">return</span>; </pre></li>
<li id="l435"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l436"><pre> </pre></li>
<li id="l437"><pre>            <span class="comment">--------------</span> </pre></li>
<li id="l438"><pre>            <span class="comment">-- Material --</span> </pre></li>
<li id="l439"><pre>            <span class="comment">--------------</span> </pre></li>
<li id="l440"><pre> </pre></li>
<li id="l441"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:34">First_Face</a> </pre></li>
<li id="l442"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> Previous_face.skin = invisible </pre></li>
<li id="l443"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> fa.skin /= Previous_face.skin </pre></li>
<li id="l444"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> (fa.skin = Previous_face.skin </pre></li>
<li id="l445"><pre>                       <span class="keyword">and</span> <span class="keyword">then</span> fa.material /= Previous_face.material) </pre></li>
<li id="l446"><pre>            <span class="keyword">then</span> </pre></li>
<li id="l447"><pre>               <span class="keyword">case</span> fa.skin <span class="keyword">is</span> </pre></li>
<li id="l448"><pre>               <span class="keyword">when</span> material_only | material_texture =&gt; </pre></li>
<li id="l449"><pre>                  <span class="droplink">Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (COLOR_MATERIAL); </pre></li>
<li id="l450"><pre>                  <span class="droplink">Set_Material<ul><li><a href="globe_3d.ads.html#globe_3d.ads:594:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l594" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l97" title="To body">To body</a></li></ul></span> (fa.material); </pre></li>
<li id="l451"><pre>               <span class="keyword">when</span> <span class="keyword">others</span> =&gt; </pre></li>
<li id="l452"><pre>                  <span class="droplink">Set_Material<ul><li><a href="globe_3d.ads.html#globe_3d.ads:594:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l594" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l97" title="To body">To body</a></li></ul></span> (<span class="droplink">GL.Materials.neutral_material<ul><li><a href="gl-materials.ads.html#gl-materials.ads:35:3" title="To API doc">To API doc</a></li><li><a href="src_gl-materials.ads.html#l35" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l453"><pre>               <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l454"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l455"><pre> </pre></li>
<li id="l456"><pre>            <span class="comment">------------</span> </pre></li>
<li id="l457"><pre>            <span class="comment">-- Colour --</span> </pre></li>
<li id="l458"><pre>            <span class="comment">------------</span> </pre></li>
<li id="l459"><pre> </pre></li>
<li id="l460"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:34">First_Face</a> </pre></li>
<li id="l461"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> Previous_face.skin = invisible </pre></li>
<li id="l462"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> fa.skin /= Previous_face.skin </pre></li>
<li id="l463"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> (fa.skin = Previous_face.skin </pre></li>
<li id="l464"><pre>                       <span class="keyword">and</span> <span class="keyword">then</span> (fa.colour /= Previous_face.colour </pre></li>
<li id="l465"><pre>                                 <span class="keyword">or</span> <span class="keyword">else</span> fa.alpha /= Previous_face.alpha)) </pre></li>
<li id="l466"><pre>            <span class="keyword">then</span> </pre></li>
<li id="l467"><pre>               <span class="keyword">case</span> fa.skin <span class="keyword">is</span> </pre></li>
<li id="l468"><pre>               <span class="keyword">when</span> material_only | material_texture =&gt; </pre></li>
<li id="l469"><pre>                  <span class="keyword">null</span>; <span class="comment">-- done above</span> </pre></li>
<li id="l470"><pre>               <span class="keyword">when</span> colour_only | coloured_texture =&gt; </pre></li>
<li id="l471"><pre>                  <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (COLOR_MATERIAL); </pre></li>
<li id="l472"><pre>                  <span class="droplink">ColorMaterial<ul><li><a href="gl.ads.html#gl.ads:1863:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1863" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4360" title="To body">To body</a></li></ul></span> (FRONT_AND_BACK, AMBIENT_AND_DIFFUSE); </pre></li>
<li id="l473"><pre>                  <span class="droplink">Color<ul><li><a href="gl.ads.html#gl.ads:3426:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l3907" title="To body">To body</a></li></ul></span> ( </pre></li>
<li id="l474"><pre>                         <span class="droplink">red<ul><li><a href="gl.ads.html#gl.ads:3426:21" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li></ul></span>   =&gt; fa.colour.Red, </pre></li>
<li id="l475"><pre>                         <span class="droplink">green<ul><li><a href="gl.ads.html#gl.ads:3426:26" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li></ul></span> =&gt; fa.colour.Green, </pre></li>
<li id="l476"><pre>                         <span class="droplink">blue<ul><li><a href="gl.ads.html#gl.ads:3426:33" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li></ul></span>  =&gt; fa.colour.Blue, </pre></li>
<li id="l477"><pre>                         <span class="droplink">alpha<ul><li><a href="gl.ads.html#gl.ads:3426:39" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li></ul></span> =&gt; fa.alpha </pre></li>
<li id="l478"><pre>                        ); </pre></li>
<li id="l479"><pre>               <span class="keyword">when</span> texture_only =&gt; </pre></li>
<li id="l480"><pre>                  <span class="droplink">Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (COLOR_MATERIAL); </pre></li>
<li id="l481"><pre>               <span class="keyword">when</span> invisible =&gt; </pre></li>
<li id="l482"><pre>                  <span class="keyword">null</span>; </pre></li>
<li id="l483"><pre>               <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l484"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l485"><pre> </pre></li>
<li id="l486"><pre>            <span class="comment">-------------</span> </pre></li>
<li id="l487"><pre>            <span class="comment">-- Texture --</span> </pre></li>
<li id="l488"><pre>            <span class="comment">-------------</span> </pre></li>
<li id="l489"><pre> </pre></li>
<li id="l490"><pre>            <span class="keyword">if</span> <span class="droplink">is_textured<ul><li><a href="globe_3d.ads.html#globe_3d.ads:279:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l279" title="To spec">To spec</a></li></ul></span> (fa.skin) <span class="keyword">then</span> </pre></li>
<li id="l491"><pre>               <span class="droplink">G3DT.Check_2D_texture<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:80:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l80" title="To spec">To spec</a></li><li><a href="src_globe_3d-textures.adb.html#l102" title="To body">To body</a></li></ul></span> (fa.texture, blending_hint); </pre></li>
<li id="l492"><pre>               <span class="keyword">if</span> blending_hint <span class="keyword">then</span> </pre></li>
<li id="l493"><pre>                  fi.blending := True; </pre></li>
<li id="l494"><pre>                  <span class="comment">-- 13 - Oct - 2006 : override the decision made at Pre_calculate.</span> </pre></li>
<li id="l495"><pre>                  <span class="comment">-- If texture data contains an alpha layer, we switch</span> </pre></li>
<li id="l496"><pre>                  <span class="comment">-- on transparency.</span> </pre></li>
<li id="l497"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l498"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l499"><pre> </pre></li>
<li id="l500"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:34">First_Face</a> </pre></li>
<li id="l501"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> Previous_face.skin = invisible </pre></li>
<li id="l502"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> fa.skin /= Previous_face.skin </pre></li>
<li id="l503"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> (fa.skin = Previous_face.skin </pre></li>
<li id="l504"><pre>                       <span class="keyword">and</span> <span class="keyword">then</span> fa.texture /= Previous_face.texture) </pre></li>
<li id="l505"><pre>            <span class="keyword">then</span> </pre></li>
<li id="l506"><pre>               <span class="keyword">case</span> fa.skin <span class="keyword">is</span> </pre></li>
<li id="l507"><pre>               <span class="keyword">when</span> texture_only | coloured_texture | material_texture =&gt; </pre></li>
<li id="l508"><pre>                  <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (TEXTURE_2D); </pre></li>
<li id="l509"><pre>                  <span class="droplink">GL.BindTexture<ul><li><a href="gl.ads.html#gl.ads:2629:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l2629" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4408" title="To body">To body</a></li></ul></span> (GL.TEXTURE_2D, <span class="droplink">GL.Uint<ul><li><a href="gl.ads.html#gl.ads:124:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l124" title="To spec">To spec</a></li></ul></span> (<span class="droplink">Image_ID<ul><li><a href="globe_3d.ads.html#globe_3d.ads:99:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l99" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l1277" title="defined at globe_3d.adb:1277:7">Pos</a> (fa.texture) + 1)); </pre></li>
<li id="l510"><pre>                  <span class="comment">-- ^ superfluous ?!!</span> </pre></li>
<li id="l511"><pre>               <span class="keyword">when</span> colour_only | material_only =&gt; </pre></li>
<li id="l512"><pre>                  <span class="droplink">Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (TEXTURE_2D); </pre></li>
<li id="l513"><pre>               <span class="keyword">when</span> invisible =&gt; </pre></li>
<li id="l514"><pre>                  <span class="keyword">null</span>; </pre></li>
<li id="l515"><pre>               <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l516"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l517"><pre> </pre></li>
<li id="l518"><pre>            <span class="comment">-----------------------------</span> </pre></li>
<li id="l519"><pre>            <span class="comment">-- Blending / transparency --</span> </pre></li>
<li id="l520"><pre>            <span class="comment">-----------------------------</span> </pre></li>
<li id="l521"><pre> </pre></li>
<li id="l522"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l415" title="defined at globe_3d.adb:415:34">First_Face</a> </pre></li>
<li id="l523"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> Previous_face.skin = invisible </pre></li>
<li id="l524"><pre>              <span class="keyword">or</span> <span class="keyword">else</span> fi.blending /= Previous_face_Invariant.blending </pre></li>
<li id="l525"><pre>            <span class="keyword">then</span> </pre></li>
<li id="l526"><pre>               <span class="keyword">if</span> fi.blending <span class="keyword">then</span> </pre></li>
<li id="l527"><pre>                  <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (BLEND); <span class="comment">-- See 4.1.7 Blending</span> </pre></li>
<li id="l528"><pre>                  <span class="droplink">BlendFunc<ul><li><a href="gl.ads.html#gl.ads:349:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l349" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4122" title="To body">To body</a></li></ul></span> (<span class="droplink">sfactor<ul><li><a href="gl.ads.html#gl.ads:349:25" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l349" title="To spec">To spec</a></li></ul></span> =&gt; SRC_ALPHA, </pre></li>
<li id="l529"><pre>                             <span class="droplink">dfactor<ul><li><a href="gl.ads.html#gl.ads:350:25" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l350" title="To spec">To spec</a></li></ul></span> =&gt; ONE_MINUS_SRC_ALPHA); </pre></li>
<li id="l530"><pre>                  <span class="comment">-- Disable (DEPTH_TEST);</span> </pre></li>
<li id="l531"><pre>                  <span class="comment">-- Disable (CULL_FACE);</span> </pre></li>
<li id="l532"><pre>               <span class="keyword">else</span> </pre></li>
<li id="l533"><pre>                  <span class="droplink">Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (BLEND); </pre></li>
<li id="l534"><pre>                  <span class="comment">-- Enable (DEPTH_TEST);</span> </pre></li>
<li id="l535"><pre>                  <span class="comment">-- Enable (CULL_FACE);</span> </pre></li>
<li id="l536"><pre>                  <span class="comment">-- CullFace (BACK);</span> </pre></li>
<li id="l537"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l538"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l539"><pre> </pre></li>
<li id="l540"><pre>            <span class="comment">-------------</span> </pre></li>
<li id="l541"><pre>            <span class="comment">-- Drawing --</span> </pre></li>
<li id="l542"><pre>            <span class="comment">-------------</span> </pre></li>
<li id="l543"><pre> </pre></li>
<li id="l544"><pre>            <span class="keyword">case</span> fi.last_edge <span class="keyword">is</span> </pre></li>
<li id="l545"><pre>            <span class="keyword">when</span> 3 =&gt; <span class="droplink">GL_Begin<ul><li><a href="gl.ads.html#gl.ads:1432:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1432" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4190" title="To body">To body</a></li></ul></span> (TRIANGLES); </pre></li>
<li id="l546"><pre>            <span class="keyword">when</span> 4 =&gt; <span class="droplink">GL_Begin<ul><li><a href="gl.ads.html#gl.ads:1432:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1432" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4190" title="To body">To body</a></li></ul></span> (QUADS); </pre></li>
<li id="l547"><pre>            <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l548"><pre> </pre></li>
<li id="l549"><pre>            <span class="keyword">for</span> i <span class="keyword">in</span> 1 .. fi.last_edge <span class="keyword">loop</span> </pre></li>
<li id="l550"><pre>               <span class="keyword">if</span> <span class="droplink">is_textured<ul><li><a href="globe_3d.ads.html#globe_3d.ads:279:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l279" title="To spec">To spec</a></li></ul></span> (fa.skin) <span class="keyword">then</span> </pre></li>
<li id="l551"><pre>                  <span class="droplink">TexCoord<ul><li><a href="gl.ads.html#gl.ads:3489:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3489" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4012" title="To body">To body</a></li></ul></span> (fi.UV_extrema (i).U, fi.UV_extrema (i).V); </pre></li>
<li id="l552"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l553"><pre>               <span class="droplink">Normal<ul><li><a href="gl.ads.html#gl.ads:3365:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3365" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l47" title="To body">To body</a></li></ul></span> (o.edge_vector (fi.P_compact (i))); </pre></li>
<li id="l554"><pre>               <span class="droplink">Vertex<ul><li><a href="gl.ads.html#gl.ads:3330:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3330" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l39" title="To body">To body</a></li></ul></span> (o.Point (fi.P_compact (i))); </pre></li>
<li id="l555"><pre>            <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l556"><pre> </pre></li>
<li id="l557"><pre>            <span class="droplink">GL_End<ul><li><a href="gl.ads.html#gl.ads:1434:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1434" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4191" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l558"><pre> </pre></li>
<li id="l559"><pre>            <a href="src_globe_3d.adb.html#l417" title="defined at globe_3d.adb:417:10">Previous_face</a>           := <span class="droplink">fa<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l560"><pre>            <a href="src_globe_3d.adb.html#l418" title="defined at globe_3d.adb:418:10">Previous_face_Invariant</a> := <span class="droplink">fi<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l561"><pre>         <span class="keyword">end</span> <span class="droplink">Display_face<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l562"><pre> </pre></li>
<li id="l563"><pre>      <span class="keyword">end</span> <span class="droplink">Display_face_optimized<ul><li><a href="src_globe_3d.adb.html#l414" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l421" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l564"><pre> </pre></li>
<li id="l565"><pre>      <span class="keyword">procedure</span> Display_normals <span class="keyword">is</span> </pre></li>
<li id="l566"><pre> </pre></li>
<li id="l567"><pre>         <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l568"><pre> </pre></li>
<li id="l569"><pre>         C : <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l570"><pre> </pre></li>
<li id="l571"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l572"><pre>         <span class="droplink">GL.Color<ul><li><a href="gl.ads.html#gl.ads:3426:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l3907" title="To body">To body</a></li></ul></span> (0.5, 0.5, 1.0, 1.0); </pre></li>
<li id="l573"><pre>         <span class="comment">-- show pseudo (average) normals at edges :</span> </pre></li>
<li id="l574"><pre>         <span class="keyword">for</span> e <span class="keyword">in</span> o.Point&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l575"><pre>            <span class="droplink">Arrow<ul><li><a href="src_globe_3d.adb.html#l371" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l371" title="To body">To body</a></li></ul></span> (o.Point (e), <span class="droplink">arrow_inflator<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:16:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l16" title="To spec">To spec</a></li></ul></span> * o.edge_vector (e)); </pre></li>
<li id="l576"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l577"><pre>         <span class="droplink">GL.Color<ul><li><a href="gl.ads.html#gl.ads:3426:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3426" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l3907" title="To body">To body</a></li></ul></span> (1.0, 1.0, 0.5, 1.0); </pre></li>
<li id="l578"><pre>         <span class="comment">-- show normals of faces :</span> </pre></li>
<li id="l579"><pre>         <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l580"><pre>            <a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a> := (0.0, 0.0, 0.0); </pre></li>
<li id="l581"><pre>            <span class="keyword">for</span> i <span class="keyword">in</span> 1 .. o.Face_Invariant (f).last_edge <span class="keyword">loop</span> </pre></li>
<li id="l582"><pre>               <a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a> := <a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a> + o.Point (o.Face_Invariant (f).P_compact (i)); </pre></li>
<li id="l583"><pre>            <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l584"><pre>            <a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a> := (1.0 / <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span> (o.Face_Invariant (f).last_edge)) * <a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a>; </pre></li>
<li id="l585"><pre>            <span class="droplink">Arrow<ul><li><a href="src_globe_3d.adb.html#l371" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l371" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a>, <span class="droplink">arrow_inflator<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:16:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l16" title="To spec">To spec</a></li></ul></span> * o.Face_Invariant (f).normal); </pre></li>
<li id="l586"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l587"><pre>      <span class="keyword">end</span> <span class="droplink">Display_normals<ul><li><a href="src_globe_3d.adb.html#l565" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l565" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l588"><pre> </pre></li>
<li id="l589"><pre>      <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l590"><pre> </pre></li>
<li id="l591"><pre>   <span class="keyword">begin</span> <span class="comment">-- Display_one</span> </pre></li>
<li id="l592"><pre> </pre></li>
<li id="l593"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> o.pre_calculated <span class="keyword">then</span> </pre></li>
<li id="l594"><pre>         <span class="droplink">Pre_calculate<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:448:27" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l448" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l401" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l595"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l596"><pre> </pre></li>
<li id="l597"><pre>      <span class="droplink">GL.BindBuffer<ul><li><a href="gl.ads.html#gl.ads:3798:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3798" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l95" title="To body">To body</a></li></ul></span>    (GL.ARRAY_BUFFER, 0);             <span class="comment">-- disable &apos;vertex buffer objects&apos;</span> </pre></li>
<li id="l598"><pre>      <span class="droplink">GL.BindBuffer<ul><li><a href="gl.ads.html#gl.ads:3798:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3798" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l95" title="To body">To body</a></li></ul></span>    (GL.ELEMENT_ARRAY_BUFFER, 0);     <span class="comment">-- disable &apos;vertex buffer objects&apos; indices</span> </pre></li>
<li id="l599"><pre> </pre></li>
<li id="l600"><pre>      <span class="comment">--      gl.disableClientState (gl.TEXTURE_COORD_ARRAY);</span> </pre></li>
<li id="l601"><pre>      <span class="comment">--      gl.disable    (ALPHA_TEST);</span> </pre></li>
<li id="l602"><pre>      <span class="droplink">GL.Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (LIGHTING); </pre></li>
<li id="l603"><pre> </pre></li>
<li id="l604"><pre>      <span class="droplink">GL.PushMatrix<ul><li><a href="gl.ads.html#gl.ads:3278:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3278" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4169" title="To body">To body</a></li></ul></span>; <span class="comment">-- 26 - May - 2006 : instead of rotating/translating back</span> </pre></li>
<li id="l605"><pre>      <span class="droplink">GL.Translate<ul><li><a href="gl.ads.html#gl.ads:3308:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3308" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l53" title="To body">To body</a></li></ul></span> (o.Centre); </pre></li>
<li id="l606"><pre>      <span class="droplink">Multiply_GL_Matrix<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:77:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l77" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l268" title="To body">To body</a></li></ul></span> (o.rotation); </pre></li>
<li id="l607"><pre> </pre></li>
<li id="l608"><pre>      <span class="comment">-- List preparation phase</span> </pre></li>
<li id="l609"><pre>      <span class="keyword">case</span> o.List_Status <span class="keyword">is</span> </pre></li>
<li id="l610"><pre>      <span class="keyword">when</span> No_List | Is_List =&gt; </pre></li>
<li id="l611"><pre>         <span class="keyword">null</span>; </pre></li>
<li id="l612"><pre> </pre></li>
<li id="l613"><pre>      <span class="keyword">when</span> Generate_List =&gt; </pre></li>
<li id="l614"><pre>         o.List_Id := Integer (<span class="droplink">GL.GenLists<ul><li><a href="gl.ads.html#gl.ads:1386:13" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1386" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4184" title="To body">To body</a></li></ul></span> (1)); </pre></li>
<li id="l615"><pre>         <span class="droplink">GL.NewList<ul><li><a href="gl.ads.html#gl.ads:1388:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1388" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4185" title="To body">To body</a></li></ul></span> (<span class="droplink">GL.Uint<ul><li><a href="gl.ads.html#gl.ads:124:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l124" title="To spec">To spec</a></li></ul></span> (o.List_Id), COMPILE_AND_EXECUTE); </pre></li>
<li id="l616"><pre>      <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l617"><pre> </pre></li>
<li id="l618"><pre>      <span class="comment">-- Execution phase</span> </pre></li>
<li id="l619"><pre>      <span class="keyword">case</span> o.List_Status <span class="keyword">is</span> </pre></li>
<li id="l620"><pre>      <span class="keyword">when</span> No_List =&gt; </pre></li>
<li id="l621"><pre>         <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l622"><pre>            <span class="droplink">Display_face_optimized.Display_face<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span> (True, o.face (f), o.Face_Invariant (f)); </pre></li>
<li id="l623"><pre>            <span class="comment">-- We mimic the old Display_face with redundant color, material, etc.</span> </pre></li>
<li id="l624"><pre>            <span class="comment">-- instructions by passing True for First_Face.</span> </pre></li>
<li id="l625"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l626"><pre>      <span class="keyword">when</span> Generate_List =&gt; </pre></li>
<li id="l627"><pre>         <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l628"><pre>            <span class="droplink">Display_face_optimized.Display_face<ul><li><a href="src_globe_3d.adb.html#l415" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l425" title="To body">To body</a></li></ul></span> (f = o.face&apos;First, o.face (f), o.Face_Invariant (f)); </pre></li>
<li id="l629"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l630"><pre> </pre></li>
<li id="l631"><pre>      <span class="keyword">when</span> Is_List =&gt; <span class="droplink">GL.CallList<ul><li><a href="gl.ads.html#gl.ads:1393:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1393" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4187" title="To body">To body</a></li></ul></span> (<span class="droplink">GL.Uint<ul><li><a href="gl.ads.html#gl.ads:124:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l124" title="To spec">To spec</a></li></ul></span> (o.List_Id)); </pre></li>
<li id="l632"><pre>      <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l633"><pre> </pre></li>
<li id="l634"><pre>      <span class="comment">-- Close list</span> </pre></li>
<li id="l635"><pre>      <span class="keyword">case</span> o.List_Status <span class="keyword">is</span> </pre></li>
<li id="l636"><pre>      <span class="keyword">when</span> No_List | Is_List =&gt; <span class="keyword">null</span>; </pre></li>
<li id="l637"><pre> </pre></li>
<li id="l638"><pre>      <span class="keyword">when</span> Generate_List  =&gt; </pre></li>
<li id="l639"><pre>         <span class="droplink">GL.EndList<ul><li><a href="gl.ads.html#gl.ads:1391:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1391" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4186" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l640"><pre>         <span class="keyword">if</span> <span class="droplink">GL.Get_Error<ul><li><a href="gl.ads.html#gl.ads:1242:13" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1242" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4154" title="To body">To body</a></li></ul></span> = OUT_OF_MEMORY <span class="keyword">then</span> </pre></li>
<li id="l641"><pre>            o.List_Status := No_List; </pre></li>
<li id="l642"><pre>         <span class="keyword">else</span> </pre></li>
<li id="l643"><pre>            o.List_Status := Is_List; </pre></li>
<li id="l644"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l645"><pre>      <span class="keyword">end</span> <span class="keyword">case</span>; </pre></li>
<li id="l646"><pre> </pre></li>
<li id="l647"><pre>      <span class="keyword">if</span> <span class="droplink">show_normals<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:5:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l5" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l648"><pre>         <span class="keyword">pragma</span>  Warnings (Off, <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l649"><pre>         <span class="droplink">GL.Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (GL.LIGHTING); </pre></li>
<li id="l650"><pre>         <span class="droplink">GL.Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (GL.TEXTURE_2D); </pre></li>
<li id="l651"><pre>         <span class="droplink">Display_normals<ul><li><a href="src_globe_3d.adb.html#l565" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l565" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l652"><pre>         <span class="droplink">GL.Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (GL.LIGHTING); <span class="comment">-- mmmh .. .</span> </pre></li>
<li id="l653"><pre>         <span class="keyword">pragma</span>  Warnings (<span class="droplink">On<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>,  <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l654"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l655"><pre> </pre></li>
<li id="l656"><pre>      <span class="droplink">GL.PopMatrix<ul><li><a href="gl.ads.html#gl.ads:3280:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3280" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4170" title="To body">To body</a></li></ul></span>; <span class="comment">-- 26 - May - 2006 : instead of rotating/translating back</span> </pre></li>
<li id="l657"><pre>      <span class="comment">--  GL.Rotate (o.auto_rotation (2),  0.0,  0.0, - 1.0);</span> </pre></li>
<li id="l658"><pre>      <span class="comment">--  GL.Rotate (o.auto_rotation (1),  0.0, - 1.0,  0.0);</span> </pre></li>
<li id="l659"><pre>      <span class="comment">--  GL.Rotate (o.auto_rotation (0), - 1.0,  0.0,  0.0);</span> </pre></li>
<li id="l660"><pre> </pre></li>
<li id="l661"><pre>      <span class="comment">--  GL.Translate ( - o.centre);</span> </pre></li>
<li id="l662"><pre>   <span class="keyword">end</span> <span class="droplink">Display_one<ul><li><a href="globe_3d.ads.html#globe_3d.ads:448:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l448" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l401" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l663"><pre> </pre></li>
<li id="l664"><pre>   <span class="keyword">overriding</span> <span class="keyword">procedure</span> <span class="droplink">Display<ul><li><a href="globe_3d.ads.html#globe_3d.ads:432:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l432" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:433:34" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l433" title="To spec">To spec</a></li></ul></span>    : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l665"><pre>                                 <span class="droplink">clip<ul><li><a href="globe_3d.ads.html#globe_3d.ads:434:34" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l434" title="To spec">To spec</a></li></ul></span> :        <span class="droplink">Clipping_data<ul><li><a href="globe_3d.ads.html#globe_3d.ads:143:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l143" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l666"><pre> </pre></li>
<li id="l667"><pre>      <span class="keyword">use</span> <span class="droplink">GLOBE_3D.Portals<ul><li><a href="globe_3d-portals.ads.html#globe_3d-portals.ads:1:18" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-portals.ads.html#l1" title="To spec">To spec</a></li><li><a href="src_globe_3d-portals.adb.html#l5" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l668"><pre> </pre></li>
<li id="l669"><pre>      <span class="keyword">procedure</span> Display_clipped (o            : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>&apos;Class; </pre></li>
<li id="l670"><pre>                                 clip_area    :        <span class="droplink">Clipping_area<ul><li><a href="globe_3d.ads.html#globe_3d.ads:135:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l135" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l671"><pre>                                 portal_depth :        Natural) <span class="keyword">is</span> </pre></li>
<li id="l672"><pre> </pre></li>
<li id="l673"><pre>         <span class="keyword">procedure</span> Try_portal (f : Positive) <span class="keyword">is</span> </pre></li>
<li id="l674"><pre> </pre></li>
<li id="l675"><pre>            <span class="keyword">use</span> <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l676"><pre> </pre></li>
<li id="l677"><pre>            dp : <span class="droplink">Real<ul><li><a href="globe_3d.ads.html#globe_3d.ads:102:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l102" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l678"><pre>            plane_to_eye : <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>; <span class="comment">-- vector from any point in plane to the eye</span> </pre></li>
<li id="l679"><pre>            bounding_of_face, intersection_clip_and_face : <span class="droplink">Clipping_area<ul><li><a href="globe_3d.ads.html#globe_3d.ads:135:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l135" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l680"><pre>            success, non_empty_intersection : Boolean; </pre></li>
<li id="l681"><pre> </pre></li>
<li id="l682"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l683"><pre>            <span class="comment">-- Culling #1 : check if portal is in vield of view&apos;s &quot;dead angle&quot;</span> </pre></li>
<li id="l684"><pre>            <a href="src_globe_3d.adb.html#l677" title="defined at globe_3d.adb:677:13">dp</a> := o.Face_Invariant (<a href="src_globe_3d.adb.html#l673" title="defined at globe_3d.adb:673:32">f</a>).normal * clip.view_direction; </pre></li>
<li id="l685"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l677" title="defined at globe_3d.adb:677:13">dp</a> &lt; clip.max_dot_product <span class="keyword">then</span> </pre></li>
<li id="l686"><pre>               <span class="comment">-- Culling #2 : check if we are on the right side of the portal</span> </pre></li>
<li id="l687"><pre>               <span class="comment">-- NB : ignores o.auto_rotation !</span> </pre></li>
<li id="l688"><pre>               <a href="src_globe_3d.adb.html#l678" title="defined at globe_3d.adb:678:13">plane_to_eye</a> := </pre></li>
<li id="l689"><pre>                 clip.Eye_Position - </pre></li>
<li id="l690"><pre>                   (o.Point (o.Face_Invariant (<a href="src_globe_3d.adb.html#l673" title="defined at globe_3d.adb:673:32">f</a>).P_compact (1)) + o.Centre) </pre></li>
<li id="l691"><pre>          ; </pre></li>
<li id="l692"><pre>               <a href="src_globe_3d.adb.html#l677" title="defined at globe_3d.adb:677:13">dp</a> := <a href="src_globe_3d.adb.html#l678" title="defined at globe_3d.adb:678:13">plane_to_eye</a> * o.Face_Invariant (<a href="src_globe_3d.adb.html#l673" title="defined at globe_3d.adb:673:32">f</a>).normal; </pre></li>
<li id="l693"><pre>               <span class="comment">-- dp = signed distance to the plane</span> </pre></li>
<li id="l694"><pre>               <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l677" title="defined at globe_3d.adb:677:13">dp</a> &gt; 0.0 <span class="keyword">then</span> </pre></li>
<li id="l695"><pre>                  <span class="comment">-- Culling #3 : clipping rectangle</span> </pre></li>
<li id="l696"><pre>                  <span class="droplink">Find_bounding_box<ul><li><a href="globe_3d-portals.ads.html#globe_3d-portals.ads:7:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-portals.ads.html#l7" title="To spec">To spec</a></li><li><a href="src_globe_3d-portals.adb.html#l49" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l669" title="defined at globe_3d.adb:669:34">o</a>, <a href="src_globe_3d.adb.html#l673" title="defined at globe_3d.adb:673:32">f</a>, <a href="src_globe_3d.adb.html#l679" title="defined at globe_3d.adb:679:13">bounding_of_face</a>, <a href="src_globe_3d.adb.html#l680" title="defined at globe_3d.adb:680:13">success</a>); </pre></li>
<li id="l697"><pre>                  <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l680" title="defined at globe_3d.adb:680:13">success</a> <span class="keyword">then</span> </pre></li>
<li id="l698"><pre>                     <span class="droplink">Intersect<ul><li><a href="globe_3d-portals.ads.html#globe_3d-portals.ads:5:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-portals.ads.html#l5" title="To spec">To spec</a></li><li><a href="src_globe_3d-portals.adb.html#l9" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l670" title="defined at globe_3d.adb:670:34">clip_area</a>, <a href="src_globe_3d.adb.html#l679" title="defined at globe_3d.adb:679:13">bounding_of_face</a>, </pre></li>
<li id="l699"><pre>                                <a href="src_globe_3d.adb.html#l679" title="defined at globe_3d.adb:679:31">intersection_clip_and_face</a>, <a href="src_globe_3d.adb.html#l680" title="defined at globe_3d.adb:680:22">non_empty_intersection</a>); </pre></li>
<li id="l700"><pre>                  <span class="keyword">else</span> </pre></li>
<li id="l701"><pre>                     <span class="comment">-- in doubt, draw with the present clipping</span> </pre></li>
<li id="l702"><pre>                     <a href="src_globe_3d.adb.html#l679" title="defined at globe_3d.adb:679:31">intersection_clip_and_face</a> := <a href="src_globe_3d.adb.html#l670" title="defined at globe_3d.adb:670:34">clip_area</a>; </pre></li>
<li id="l703"><pre>                     <a href="src_globe_3d.adb.html#l680" title="defined at globe_3d.adb:680:22">non_empty_intersection</a> := True; </pre></li>
<li id="l704"><pre>                  <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l705"><pre>                  <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l680" title="defined at globe_3d.adb:680:22">non_empty_intersection</a> <span class="keyword">then</span> </pre></li>
<li id="l706"><pre>                     <span class="comment">-- Recursion here :</span> </pre></li>
<li id="l707"><pre>                     <span class="droplink">Display_clipped<ul><li><a href="src_globe_3d.adb.html#l669" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l669" title="To body">To body</a></li></ul></span> ( </pre></li>
<li id="l708"><pre>                                      <a href="src_globe_3d.adb.html#l669" title="defined at globe_3d.adb:669:34">o</a>            =&gt; o.face (<a href="src_globe_3d.adb.html#l673" title="defined at globe_3d.adb:673:32">f</a>).connecting.<span class="keyword">all</span>, </pre></li>
<li id="l709"><pre>                                      <a href="src_globe_3d.adb.html#l670" title="defined at globe_3d.adb:670:34">clip_area</a>    =&gt; <a href="src_globe_3d.adb.html#l679" title="defined at globe_3d.adb:679:31">intersection_clip_and_face</a>, </pre></li>
<li id="l710"><pre>                                      <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> =&gt; <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> + 1 </pre></li>
<li id="l711"><pre>                                     ); </pre></li>
<li id="l712"><pre>                  <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l713"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l714"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l715"><pre>         <span class="keyword">end</span> <span class="droplink">Try_portal<ul><li><a href="src_globe_3d.adb.html#l673" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l673" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l716"><pre> </pre></li>
<li id="l717"><pre>      <span class="keyword">begin</span> <span class="comment">-- Display_clipped</span> </pre></li>
<li id="l718"><pre>         <span class="keyword">if</span> <span class="keyword">not</span> o.pre_calculated <span class="keyword">then</span> </pre></li>
<li id="l719"><pre>            <span class="droplink">Pre_calculate<ul><li><a href="globe_3d.ads.html#globe_3d.ads:424:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l424" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l194" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l669" title="defined at globe_3d.adb:669:34">o</a>); </pre></li>
<li id="l720"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l721"><pre>         <span class="comment">--</span> </pre></li>
<li id="l722"><pre>         <span class="comment">-- a/ Display connected objects which are visible through o&apos;s faces</span> </pre></li>
<li id="l723"><pre>         <span class="comment">--    This is where recursion happens</span> </pre></li>
<li id="l724"><pre>         <span class="keyword">if</span> (<span class="keyword">not</span> <span class="droplink">filter_portal_depth<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:7:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l7" title="To spec">To spec</a></li></ul></span>) <span class="keyword">or</span> <span class="keyword">else</span> <span class="comment">-- filter_portal_depth : test/debug</span> </pre></li>
<li id="l725"><pre>           <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> &lt;= 6 </pre></li>
<li id="l726"><pre>         <span class="keyword">then</span> </pre></li>
<li id="l727"><pre>            <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l728"><pre>               <span class="keyword">if</span> o.face (f).connecting /= <span class="keyword">null</span> <span class="keyword">and</span> <span class="keyword">then</span> </pre></li>
<li id="l729"><pre>                 <span class="keyword">not</span> o.Face_Invariant (f).portal_seen </pre></li>
<li id="l730"><pre>               <span class="comment">-- ^ prevents infinite recursion on rare cases where</span> </pre></li>
<li id="l731"><pre>               <span class="comment">-- object A or B is not convex, and A and B see each other</span> </pre></li>
<li id="l732"><pre>               <span class="comment">-- and the culling by clipping cannot stop the recursion</span> </pre></li>
<li id="l733"><pre>               <span class="comment">-- (e.g. origin2.proc, tomb.proc)</span> </pre></li>
<li id="l734"><pre>               <span class="comment">--</span> </pre></li>
<li id="l735"><pre>               <span class="comment">-- NB : drawing [different parts of] the same object several times</span> </pre></li>
<li id="l736"><pre>               <span class="comment">-- is right, since portions can be seen through different portals,</span> </pre></li>
<li id="l737"><pre>               <span class="comment">-- but going more than once through the same portal is wrong</span> </pre></li>
<li id="l738"><pre>               <span class="keyword">then</span> </pre></li>
<li id="l739"><pre>                  o.Face_Invariant (f).portal_seen := True; </pre></li>
<li id="l740"><pre>                  <span class="droplink">Try_portal<ul><li><a href="src_globe_3d.adb.html#l673" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l673" title="To body">To body</a></li></ul></span> (f); </pre></li>
<li id="l741"><pre>                  <span class="comment">-- ^ recursively calls Display_clipped for</span> </pre></li>
<li id="l742"><pre>                  <span class="comment">--   objects visible through face f.</span> </pre></li>
<li id="l743"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l744"><pre>            <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l745"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l746"><pre>         <span class="comment">-- b/ Display the object itself</span> </pre></li>
<li id="l747"><pre>         <span class="keyword">if</span> (<span class="keyword">not</span> <span class="droplink">filter_portal_depth<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:7:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l7" title="To spec">To spec</a></li></ul></span>) <span class="keyword">or</span> <span class="keyword">else</span> <span class="comment">-- filter_portal_depth : test/debug</span> </pre></li>
<li id="l748"><pre>           (<a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> = 1 <span class="keyword">or</span> <span class="keyword">else</span> <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> = 5) </pre></li>
<li id="l749"><pre>         <span class="keyword">then</span> </pre></li>
<li id="l750"><pre>            <span class="comment">-- The graphical clipping (Scissor) gives various effects</span> </pre></li>
<li id="l751"><pre>            <span class="comment">-- - almost no speedup on the ATI Radeon 9600 Pro (hardware)</span> </pre></li>
<li id="l752"><pre>            <span class="comment">-- - factor : ~ Sqrt (clipped surface ratio) with software GL</span> </pre></li>
<li id="l753"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> &gt; 0 <span class="keyword">then</span> </pre></li>
<li id="l754"><pre>               <span class="droplink">GL.Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (GL.SCISSOR_TEST); </pre></li>
<li id="l755"><pre>               <span class="droplink">GL.Scissor<ul><li><a href="gl.ads.html#gl.ads:3233:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3233" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4135" title="To body">To body</a></li></ul></span> (<span class="droplink">x<ul><li><a href="gl.ads.html#gl.ads:3233:23" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3233" title="To spec">To spec</a></li></ul></span>      =&gt; <span class="droplink">GL.Int<ul><li><a href="gl.ads.html#gl.ads:121:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l121" title="To spec">To spec</a></li></ul></span> (clip_area.X1), </pre></li>
<li id="l756"><pre>                           <span class="droplink">y<ul><li><a href="gl.ads.html#gl.ads:3234:23" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3234" title="To spec">To spec</a></li></ul></span>      =&gt; <span class="droplink">GL.Int<ul><li><a href="gl.ads.html#gl.ads:121:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l121" title="To spec">To spec</a></li></ul></span> (clip_area.Y1), </pre></li>
<li id="l757"><pre>                           <span class="droplink">width<ul><li><a href="gl.ads.html#gl.ads:3235:23" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3235" title="To spec">To spec</a></li></ul></span>  =&gt; <span class="droplink">GL.Sizei<ul><li><a href="gl.ads.html#gl.ads:125:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l125" title="To spec">To spec</a></li></ul></span> (clip_area.X2 - clip_area.X1 + 1), </pre></li>
<li id="l758"><pre>                           <span class="droplink">height<ul><li><a href="gl.ads.html#gl.ads:3236:23" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3236" title="To spec">To spec</a></li></ul></span> =&gt; <span class="droplink">GL.Sizei<ul><li><a href="gl.ads.html#gl.ads:125:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l125" title="To spec">To spec</a></li></ul></span> (clip_area.Y2 - clip_area.Y1 + 1)); </pre></li>
<li id="l759"><pre>            <span class="keyword">else</span> </pre></li>
<li id="l760"><pre>               <span class="droplink">GL.Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (GL.SCISSOR_TEST); </pre></li>
<li id="l761"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l762"><pre>            <span class="droplink">info_b_ntl2<ul><li><a href="globe_3d.ads.html#globe_3d.ads:535:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l535" title="To spec">To spec</a></li></ul></span> := <span class="droplink">info_b_ntl2<ul><li><a href="globe_3d.ads.html#globe_3d.ads:535:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l535" title="To spec">To spec</a></li></ul></span> + 1; </pre></li>
<li id="l763"><pre>            <span class="droplink">info_b_ntl3<ul><li><a href="globe_3d.ads.html#globe_3d.ads:536:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l536" title="To spec">To spec</a></li></ul></span> := Natural&apos;Max (<a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a>, <span class="droplink">info_b_ntl3<ul><li><a href="globe_3d.ads.html#globe_3d.ads:536:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l536" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l764"><pre>            <span class="droplink">Display_one<ul><li><a href="globe_3d.ads.html#globe_3d.ads:448:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l448" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l401" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l669" title="defined at globe_3d.adb:669:34">o</a>); </pre></li>
<li id="l765"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l766"><pre>         <span class="keyword">if</span> <span class="droplink">show_portals<ul><li><a href="globe_3d-options.ads.html#globe_3d-options.ads:6:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-options.ads.html#l6" title="To spec">To spec</a></li></ul></span> <span class="keyword">and</span> <span class="keyword">then</span> <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> &gt; 0 <span class="keyword">then</span> </pre></li>
<li id="l767"><pre>            <span class="keyword">pragma</span> Warnings (Off, <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l768"><pre>            <span class="droplink">Draw_boundary<ul><li><a href="globe_3d-portals.ads.html#globe_3d-portals.ads:14:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-portals.ads.html#l14" title="To spec">To spec</a></li><li><a href="src_globe_3d-portals.adb.html#l79" title="To body">To body</a></li></ul></span> (clip.main_clipping, <a href="src_globe_3d.adb.html#l670" title="defined at globe_3d.adb:670:34">clip_area</a>); </pre></li>
<li id="l769"><pre>            <span class="keyword">pragma</span> Warnings (<span class="droplink">On<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>,  <span class="string">&quot;this code can never be executed and has been deleted&quot;</span>); </pre></li>
<li id="l770"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l771"><pre>      <span class="keyword">end</span> <span class="droplink">Display_clipped<ul><li><a href="src_globe_3d.adb.html#l669" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l669" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l772"><pre> </pre></li>
<li id="l773"><pre>      <span class="keyword">procedure</span> Reset_portal_seen (o : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>&apos;Class) <span class="keyword">is</span> </pre></li>
<li id="l774"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l775"><pre>         <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l776"><pre>            <span class="keyword">if</span> o.Face_Invariant (f).portal_seen <span class="keyword">then</span> </pre></li>
<li id="l777"><pre>               o.Face_Invariant (f).portal_seen := False; </pre></li>
<li id="l778"><pre>               <span class="droplink">Reset_portal_seen<ul><li><a href="src_globe_3d.adb.html#l773" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l773" title="To body">To body</a></li></ul></span> (o.face (f).connecting.<span class="keyword">all</span>); </pre></li>
<li id="l779"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l780"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l781"><pre>      <span class="keyword">end</span> <span class="droplink">Reset_portal_seen<ul><li><a href="src_globe_3d.adb.html#l773" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l773" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l782"><pre> </pre></li>
<li id="l783"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l784"><pre>      <span class="droplink">info_b_ntl2<ul><li><a href="globe_3d.ads.html#globe_3d.ads:535:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l535" title="To spec">To spec</a></li></ul></span> := 0; <span class="comment">-- count amount of objects displayed, not distinct</span> </pre></li>
<li id="l785"><pre>      <span class="droplink">info_b_ntl3<ul><li><a href="globe_3d.ads.html#globe_3d.ads:536:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l536" title="To spec">To spec</a></li></ul></span> := 0; <span class="comment">-- records max depth</span> </pre></li>
<li id="l786"><pre>      <span class="droplink">Display_clipped<ul><li><a href="src_globe_3d.adb.html#l669" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l669" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:433:34" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l433" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l664" title="To body">To body</a></li></ul></span>, <a href="src_globe_3d.adb.html#l670" title="defined at globe_3d.adb:670:34">clip_area</a> =&gt; clip.main_clipping, <a href="src_globe_3d.adb.html#l671" title="defined at globe_3d.adb:671:34">portal_depth</a> =&gt; 0); </pre></li>
<li id="l787"><pre>      <span class="droplink">Reset_portal_seen<ul><li><a href="src_globe_3d.adb.html#l773" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l773" title="To body">To body</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:433:34" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l433" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l664" title="To body">To body</a></li></ul></span>); </pre></li>
<li id="l788"><pre>   <span class="keyword">end</span> <span class="droplink">Display<ul><li><a href="globe_3d.ads.html#globe_3d.ads:432:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l432" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l664" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l789"><pre> </pre></li>
<li id="l790"><pre>   <span class="keyword">overriding</span> <span class="keyword">procedure</span> <span class="droplink">Destroy<ul><li><a href="globe_3d.ads.html#globe_3d.ads:387:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l387" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:387:41" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l387" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l791"><pre> </pre></li>
<li id="l792"><pre>      ol : <span class="droplink">p_Object_3D_list<ul><li><a href="globe_3d.ads.html#globe_3d.ads:345:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l345" title="To spec">To spec</a></li></ul></span> := o.sub_objects; </pre></li>
<li id="l793"><pre> </pre></li>
<li id="l794"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l795"><pre>      <span class="keyword">while</span> <a href="src_globe_3d.adb.html#l792" title="defined at globe_3d.adb:792:7">ol</a> /= <span class="keyword">null</span> <span class="keyword">loop</span> </pre></li>
<li id="l796"><pre>         <span class="droplink">Free<ul><li><a href="globe_3d.ads.html#globe_3d.ads:213:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l213" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l110" title="To body">To body</a></li></ul></span> (<span class="droplink">p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span> (<a href="src_globe_3d.adb.html#l792" title="defined at globe_3d.adb:792:7">ol</a>.<span class="keyword">all</span>.objc)); </pre></li>
<li id="l797"><pre>         <a href="src_globe_3d.adb.html#l792" title="defined at globe_3d.adb:792:7">ol</a> := <a href="src_globe_3d.adb.html#l792" title="defined at globe_3d.adb:792:7">ol</a>.<span class="keyword">all</span>.next; </pre></li>
<li id="l798"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l799"><pre>   <span class="keyword">end</span> <span class="droplink">Destroy<ul><li><a href="globe_3d.ads.html#globe_3d.ads:387:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l387" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l790" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l800"><pre> </pre></li>
<li id="l801"><pre>   <span class="keyword">overriding</span> <span class="keyword">procedure</span> <span class="droplink">set_Alpha<ul><li><a href="globe_3d.ads.html#globe_3d.ads:388:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l388" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:388:41" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l388" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>; <span class="droplink">Alpha<ul><li><a href="globe_3d.ads.html#globe_3d.ads:388:64" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l388" title="To spec">To spec</a></li></ul></span> : <span class="droplink">GL.Double<ul><li><a href="gl.ads.html#gl.ads:128:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l128" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l802"><pre> </pre></li>
<li id="l803"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l804"><pre>      <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l805"><pre>         o.face (f).alpha := <span class="droplink">Alpha<ul><li><a href="globe_3d.ads.html#globe_3d.ads:388:64" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l388" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l806"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l807"><pre>   <span class="keyword">end</span> <span class="droplink">set_Alpha<ul><li><a href="globe_3d.ads.html#globe_3d.ads:388:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l388" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l801" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l808"><pre> </pre></li>
<li id="l809"><pre>   <span class="keyword">overriding</span> <span class="keyword">function</span> <span class="droplink">is_Transparent<ul><li><a href="globe_3d.ads.html#globe_3d.ads:389:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l389" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:389:41" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l389" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">return</span> Boolean <span class="keyword">is</span> </pre></li>
<li id="l810"><pre> </pre></li>
<li id="l811"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l812"><pre>      <span class="keyword">return</span> o.transparent; </pre></li>
<li id="l813"><pre>   <span class="keyword">end</span> <span class="droplink">is_Transparent<ul><li><a href="globe_3d.ads.html#globe_3d.ads:389:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l389" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l809" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l814"><pre> </pre></li>
<li id="l815"><pre>   <span class="keyword">overriding</span> <span class="keyword">function</span> <span class="droplink">face_Count<ul><li><a href="globe_3d.ads.html#globe_3d.ads:390:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l390" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:390:41" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l390" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">return</span> Natural <span class="keyword">is</span> </pre></li>
<li id="l816"><pre> </pre></li>
<li id="l817"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l818"><pre>      <span class="keyword">return</span> o.Max_faces; </pre></li>
<li id="l819"><pre>   <span class="keyword">end</span> <span class="droplink">face_Count<ul><li><a href="globe_3d.ads.html#globe_3d.ads:390:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l390" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l815" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l820"><pre> </pre></li>
<li id="l821"><pre>   <span class="keyword">overriding</span> <span class="keyword">function</span> <span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:391:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l391" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:391:41" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l391" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>) <span class="keyword">return</span> <span class="droplink">GL.Geometry.Bounds_record<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:43:9" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l43" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l822"><pre> </pre></li>
<li id="l823"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l824"><pre>      <span class="keyword">return</span> o.Bounds; </pre></li>
<li id="l825"><pre>   <span class="keyword">end</span> <span class="droplink">Bounds<ul><li><a href="globe_3d.ads.html#globe_3d.ads:391:25" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l391" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l821" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l826"><pre> </pre></li>
<li id="l827"><pre>   <span class="comment">-- Lighting support.</span> </pre></li>
<li id="l828"><pre>   <span class="comment">--</span> </pre></li>
<li id="l829"><pre> </pre></li>
<li id="l830"><pre>   <span class="comment">-- lights : array (Light_ident) of Light_definition;</span> </pre></li>
<li id="l831"><pre>   light_defined : <span class="keyword">array</span> (<span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span>) <span class="keyword">of</span> Boolean := (<span class="keyword">others</span> =&gt; False); </pre></li>
<li id="l832"><pre> </pre></li>
<li id="l833"><pre>   <span class="keyword">procedure</span> <span class="droplink">Define<ul><li><a href="globe_3d.ads.html#globe_3d.ads:492:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l492" title="To spec">To spec</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:492:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l492" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span>; <span class="droplink">as<ul><li><a href="globe_3d.ads.html#globe_3d.ads:492:43" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l492" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Light_definition<ul><li><a href="globe_3d.ads.html#globe_3d.ads:488:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l488" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l834"><pre> </pre></li>
<li id="l835"><pre>      id : <span class="keyword">constant</span> <span class="droplink">GL.LightIDEnm<ul><li><a href="gl.ads.html#gl.ads:1636:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1636" title="To spec">To spec</a></li></ul></span> := <span class="droplink">GL.LightIDEnm<ul><li><a href="gl.ads.html#gl.ads:1636:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1636" title="To spec">To spec</a></li></ul></span>&apos;Val (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:492:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l492" title="To spec">To spec</a></li></ul></span> - 1); </pre></li>
<li id="l836"><pre> </pre></li>
<li id="l837"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l838"><pre>      <span class="comment">-- lights (which) := as;</span> </pre></li>
<li id="l839"><pre>      <span class="droplink">Light<ul><li><a href="gl.ads.html#gl.ads:1740:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1740" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l19" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l835" title="defined at globe_3d.adb:835:7">id</a>, POSITION, as.position); </pre></li>
<li id="l840"><pre>      <span class="droplink">Light<ul><li><a href="gl.ads.html#gl.ads:1740:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1740" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l19" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l835" title="defined at globe_3d.adb:835:7">id</a>, AMBIENT,  as.ambient); </pre></li>
<li id="l841"><pre>      <span class="droplink">Light<ul><li><a href="gl.ads.html#gl.ads:1740:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1740" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l19" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l835" title="defined at globe_3d.adb:835:7">id</a>, DIFFUSE,  as.diffuse); </pre></li>
<li id="l842"><pre>      <span class="droplink">Light<ul><li><a href="gl.ads.html#gl.ads:1740:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1740" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l19" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l835" title="defined at globe_3d.adb:835:7">id</a>, SPECULAR, as.specular); </pre></li>
<li id="l843"><pre>      <a href="src_globe_3d.adb.html#l831" title="defined at globe_3d.adb:831:4">light_defined</a> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:492:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l492" title="To spec">To spec</a></li></ul></span>) := True; </pre></li>
<li id="l844"><pre>   <span class="keyword">end</span> <span class="droplink">Define<ul><li><a href="globe_3d.ads.html#globe_3d.ads:492:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l492" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l833" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l845"><pre> </pre></li>
<li id="l846"><pre>   <span class="keyword">procedure</span> <span class="droplink">Switch_lights<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span> (<span class="droplink">on<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span> : Boolean) <span class="keyword">is</span> </pre></li>
<li id="l847"><pre> </pre></li>
<li id="l848"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l849"><pre>      <span class="keyword">for</span> l <span class="keyword">in</span> <span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span> <span class="keyword">loop</span> </pre></li>
<li id="l850"><pre>         <span class="droplink">Switch_light<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l860" title="To body">To body</a></li></ul></span> (l, <span class="droplink">on<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l851"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l852"><pre>   <span class="keyword">end</span> <span class="droplink">Switch_lights<ul><li><a href="globe_3d.ads.html#globe_3d.ads:494:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l494" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l846" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l853"><pre> </pre></li>
<li id="l854"><pre>   <span class="keyword">function</span> Server_id (which : <span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> <span class="droplink">GL.ServerCapabilityEnm<ul><li><a href="gl.ads.html#gl.ads:554:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l554" title="To spec">To spec</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l855"><pre> </pre></li>
<li id="l856"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l857"><pre>      <span class="keyword">return</span> <span class="droplink">GL.ServerCapabilityEnm<ul><li><a href="gl.ads.html#gl.ads:554:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l554" title="To spec">To spec</a></li></ul></span>&apos;Val (<span class="droplink">GL.ServerCapabilityEnm<ul><li><a href="gl.ads.html#gl.ads:554:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l554" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l1277" title="defined at globe_3d.adb:1277:7">Pos</a> (GL.LIGHT0) + <a href="src_globe_3d.adb.html#l854" title="defined at globe_3d.adb:854:24">which</a> - 1); </pre></li>
<li id="l858"><pre>   <span class="keyword">end</span> <span class="droplink">Server_id<ul><li><a href="src_globe_3d.adb.html#l854" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l854" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l859"><pre> </pre></li>
<li id="l860"><pre>   <span class="keyword">procedure</span> <span class="droplink">Switch_light<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:28" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span>; <span class="droplink">on<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:49" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span> : Boolean) <span class="keyword">is</span> </pre></li>
<li id="l861"><pre> </pre></li>
<li id="l862"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l863"><pre>      <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l831" title="defined at globe_3d.adb:831:4">light_defined</a> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:28" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span>) <span class="keyword">then</span> </pre></li>
<li id="l864"><pre>         <span class="keyword">if</span> <span class="droplink">on<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:49" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l865"><pre>            <span class="droplink">GL.Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span> (<span class="droplink">Server_id<ul><li><a href="src_globe_3d.adb.html#l854" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l854" title="To body">To body</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:28" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span>)); </pre></li>
<li id="l866"><pre>         <span class="keyword">else</span> </pre></li>
<li id="l867"><pre>            <span class="droplink">GL.Disable<ul><li><a href="gl.ads.html#gl.ads:706:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l706" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4141" title="To body">To body</a></li></ul></span> (<span class="droplink">Server_id<ul><li><a href="src_globe_3d.adb.html#l854" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l854" title="To body">To body</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:28" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li></ul></span>)); </pre></li>
<li id="l868"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l869"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l870"><pre>   <span class="keyword">end</span> <span class="droplink">Switch_light<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l860" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l871"><pre> </pre></li>
<li id="l872"><pre>   <span class="keyword">function</span> <span class="droplink">Is_light_switched<ul><li><a href="globe_3d.ads.html#globe_3d.ads:499:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l499" title="To spec">To spec</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:499:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l499" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> Boolean <span class="keyword">is</span> </pre></li>
<li id="l873"><pre> </pre></li>
<li id="l874"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l875"><pre>      <span class="keyword">return</span> Boolean&apos;Val (<span class="droplink">GL.IsEnabled<ul><li><a href="gl.ads.html#gl.ads:708:13" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l708" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4142" title="To body">To body</a></li></ul></span> (<span class="droplink">Server_id<ul><li><a href="src_globe_3d.adb.html#l854" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l854" title="To body">To body</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:499:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l499" title="To spec">To spec</a></li></ul></span>))); </pre></li>
<li id="l876"><pre>   <span class="keyword">end</span> <span class="droplink">Is_light_switched<ul><li><a href="globe_3d.ads.html#globe_3d.ads:499:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l499" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l872" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l877"><pre> </pre></li>
<li id="l878"><pre>   <span class="keyword">procedure</span> <span class="droplink">Reverse_light_switch<ul><li><a href="globe_3d.ads.html#globe_3d.ads:497:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l497" title="To spec">To spec</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:497:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l497" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Light_ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:486:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l486" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l879"><pre> </pre></li>
<li id="l880"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l881"><pre>      <span class="droplink">Switch_light<ul><li><a href="globe_3d.ads.html#globe_3d.ads:495:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l495" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l860" title="To body">To body</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:497:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l497" title="To spec">To spec</a></li></ul></span>, <span class="keyword">not</span> <span class="droplink">Is_light_switched<ul><li><a href="globe_3d.ads.html#globe_3d.ads:499:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l499" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l872" title="To body">To body</a></li></ul></span> (<span class="droplink">which<ul><li><a href="globe_3d.ads.html#globe_3d.ads:497:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l497" title="To spec">To spec</a></li></ul></span>)); </pre></li>
<li id="l882"><pre>   <span class="keyword">end</span> <span class="droplink">Reverse_light_switch<ul><li><a href="globe_3d.ads.html#globe_3d.ads:497:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l497" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l878" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l883"><pre> </pre></li>
<li id="l884"><pre>   prec_a360    : <span class="keyword">constant</span> := 10000; </pre></li>
<li id="l885"><pre>   r_prec_a360  : <span class="keyword">constant</span> := 10000.0; </pre></li>
<li id="l886"><pre>   i_r_prec_a360 : <span class="keyword">constant</span> := 1.0 / <a href="src_globe_3d.adb.html#l885" title="defined at globe_3d.adb:885:4">r_prec_a360</a>; </pre></li>
<li id="l887"><pre> </pre></li>
<li id="l888"><pre>   <span class="keyword">procedure</span> <span class="droplink">Angles_modulo_360<ul><li><a href="globe_3d.ads.html#globe_3d.ads:509:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l509" title="To spec">To spec</a></li></ul></span> (<span class="droplink">v<ul><li><a href="globe_3d.ads.html#globe_3d.ads:509:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l509" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Vector_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:106:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l106" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l889"><pre> </pre></li>
<li id="l890"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l891"><pre>      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="droplink">v<ul><li><a href="globe_3d.ads.html#globe_3d.ads:509:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l509" title="To spec">To spec</a></li></ul></span>&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l892"><pre>         <span class="droplink">v<ul><li><a href="globe_3d.ads.html#globe_3d.ads:509:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l509" title="To spec">To spec</a></li></ul></span> (i) := </pre></li>
<li id="l893"><pre>           <span class="droplink">GL.Double<ul><li><a href="gl.ads.html#gl.ads:128:9" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l128" title="To spec">To spec</a></li></ul></span> (Integer (<a href="src_globe_3d.adb.html#l885" title="defined at globe_3d.adb:885:4">r_prec_a360</a> * <span class="droplink">v<ul><li><a href="globe_3d.ads.html#globe_3d.ads:509:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l509" title="To spec">To spec</a></li></ul></span> (i)) <span class="keyword">mod</span> (360 * <a href="src_globe_3d.adb.html#l884" title="defined at globe_3d.adb:884:4">prec_a360</a>)) </pre></li>
<li id="l894"><pre>           * <a href="src_globe_3d.adb.html#l886" title="defined at globe_3d.adb:886:4">i_r_prec_a360</a>; </pre></li>
<li id="l895"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l896"><pre>   <span class="keyword">end</span> <span class="droplink">Angles_modulo_360<ul><li><a href="globe_3d.ads.html#globe_3d.ads:509:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l509" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l888" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l897"><pre> </pre></li>
<li id="l898"><pre>   <span class="comment">------------------</span> </pre></li>
<li id="l899"><pre>   <span class="comment">-- Resource I/O --</span> </pre></li>
<li id="l900"><pre>   <span class="comment">------------------</span> </pre></li>
<li id="l901"><pre> </pre></li>
<li id="l902"><pre>   <span class="keyword">procedure</span> <span class="droplink">Load_if_needed<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li></ul></span> (<span class="droplink">zif<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Zip.Zip_info<ul><li><a href="zip.ads.html#zip.ads:53:8" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l53" title="To spec">To spec</a></li><li><a href="src_zip.ads.html#l308" title="To body">To body</a></li></ul></span>; <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:57" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li></ul></span> : String) <span class="keyword">is</span> </pre></li>
<li id="l903"><pre> </pre></li>
<li id="l904"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l905"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <span class="droplink">Zip.Is_loaded<ul><li><a href="zip.ads.html#zip.ads:82:12" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l82" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l294" title="To body">To body</a></li></ul></span> (<span class="droplink">zif<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l902" title="To body">To body</a></li></ul></span>) <span class="keyword">then</span> </pre></li>
<li id="l906"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l907"><pre>            <span class="droplink">Zip.Load<ul><li><a href="zip.ads.html#zip.ads:62:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l62" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l264" title="To body">To body</a></li></ul></span> (<span class="droplink">zif<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l902" title="To body">To body</a></li></ul></span>, <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:57" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l908"><pre>         <span class="keyword">exception</span> </pre></li>
<li id="l909"><pre>            <span class="keyword">when</span> <span class="droplink">Zip.Zip_file_open_Error<ul><li><a href="zip.ads.html#zip.ads:73:3" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l73" title="To spec">To spec</a></li></ul></span> =&gt; <span class="comment">-- Try with lower case :</span> </pre></li>
<li id="l910"><pre>               <span class="droplink">Zip.Load<ul><li><a href="zip.ads.html#zip.ads:62:14" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l62" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l264" title="To body">To body</a></li></ul></span> (<span class="droplink">zif<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:30" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l902" title="To body">To body</a></li></ul></span>, To_Lower (<span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:57" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li></ul></span>)); </pre></li>
<li id="l911"><pre>         <span class="keyword">end</span>; </pre></li>
<li id="l912"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l913"><pre>   <span class="keyword">end</span> <span class="droplink">Load_if_needed<ul><li><a href="globe_3d.ads.html#globe_3d.ads:580:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l580" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l902" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l914"><pre> </pre></li>
<li id="l915"><pre>   <span class="keyword">procedure</span> <span class="droplink">Set_local_data_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:91:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l91" title="To spec">To spec</a></li></ul></span> (<span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:91:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l91" title="To spec">To spec</a></li></ul></span> : String) <span class="keyword">is</span> </pre></li>
<li id="l916"><pre> </pre></li>
<li id="l917"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l918"><pre>      <span class="keyword">if</span> <span class="droplink">Zip.Is_loaded<ul><li><a href="zip.ads.html#zip.ads:82:12" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l82" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l294" title="To body">To body</a></li></ul></span> (<span class="droplink">zif_level<ul><li><a href="globe_3d.ads.html#globe_3d.ads:578:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l578" title="To spec">To spec</a></li></ul></span>) <span class="keyword">then</span> </pre></li>
<li id="l919"><pre>         <span class="droplink">Zip.Delete<ul><li><a href="zip.ads.html#zip.ads:92:13" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l92" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l329" title="To body">To body</a></li></ul></span> (<span class="droplink">zif_level<ul><li><a href="globe_3d.ads.html#globe_3d.ads:578:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l578" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l920"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l921"><pre>      <span class="comment">-- ^ Possible resource name change - &gt; need this, will be reloaded on next use</span> </pre></li>
<li id="l922"><pre>      <span class="droplink">level_data_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:572:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l572" title="To spec">To spec</a></li></ul></span> := Ada.Strings.Unbounded.To_Unbounded_String (<span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:91:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l91" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l923"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <span class="droplink">Zip.Exists<ul><li><a href="zip.ads.html#zip.ads:250:12" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l250" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l700" title="To body">To body</a></li></ul></span> (<span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:91:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l91" title="To spec">To spec</a></li></ul></span>) <span class="keyword">then</span> </pre></li>
<li id="l924"><pre>         <span class="keyword">raise</span> <span class="droplink">data_file_not_found<ul><li><a href="globe_3d.ads.html#globe_3d.ads:95:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l95" title="To spec">To spec</a></li></ul></span> <span class="keyword">with</span> <span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:91:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l91" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l925"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l926"><pre>   <span class="keyword">end</span> <span class="droplink">Set_local_data_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:91:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l91" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l915" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l927"><pre> </pre></li>
<li id="l928"><pre>   <span class="keyword">procedure</span> <span class="droplink">Set_global_data_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:93:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l93" title="To spec">To spec</a></li></ul></span> (<span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:93:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l93" title="To spec">To spec</a></li></ul></span> : String) <span class="keyword">is</span> </pre></li>
<li id="l929"><pre> </pre></li>
<li id="l930"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l931"><pre>      <span class="keyword">if</span> <span class="droplink">Zip.Is_loaded<ul><li><a href="zip.ads.html#zip.ads:82:12" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l82" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l294" title="To body">To body</a></li></ul></span> (<span class="droplink">zif_global<ul><li><a href="globe_3d.ads.html#globe_3d.ads:578:15" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l578" title="To spec">To spec</a></li></ul></span>) <span class="keyword">then</span> </pre></li>
<li id="l932"><pre>         <span class="droplink">Zip.Delete<ul><li><a href="zip.ads.html#zip.ads:92:13" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l92" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l329" title="To body">To body</a></li></ul></span> (<span class="droplink">zif_global<ul><li><a href="globe_3d.ads.html#globe_3d.ads:578:15" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l578" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l933"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l934"><pre>      <span class="comment">-- ^ Possible resource name change - &gt; need this, will be reloaded on next use</span> </pre></li>
<li id="l935"><pre>      <span class="droplink">global_data_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:574:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l574" title="To spec">To spec</a></li></ul></span> := Ada.Strings.Unbounded.To_Unbounded_String (<span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:93:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l93" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l936"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <span class="droplink">Zip.Exists<ul><li><a href="zip.ads.html#zip.ads:250:12" title="To API doc">To API doc</a></li><li><a href="src_zip.ads.html#l250" title="To spec">To spec</a></li><li><a href="src_zip.adb.html#l700" title="To body">To body</a></li></ul></span> (<span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:93:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l93" title="To spec">To spec</a></li></ul></span>) <span class="keyword">then</span> </pre></li>
<li id="l937"><pre>         <span class="keyword">raise</span> <span class="droplink">data_file_not_found<ul><li><a href="globe_3d.ads.html#globe_3d.ads:95:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l95" title="To spec">To spec</a></li></ul></span> <span class="keyword">with</span> <span class="droplink">s<ul><li><a href="globe_3d.ads.html#globe_3d.ads:93:36" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l93" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l938"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l939"><pre>   <span class="keyword">end</span> <span class="droplink">Set_global_data_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:93:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l93" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l928" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l940"><pre> </pre></li>
<li id="l941"><pre>   <span class="keyword">procedure</span> <span class="droplink">Set_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:24" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;class; <span class="droplink">new_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:49" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li></ul></span> : String) <span class="keyword">is</span> </pre></li>
<li id="l942"><pre> </pre></li>
<li id="l943"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l944"><pre>      <span class="keyword">if</span> <span class="droplink">new_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:49" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a> &gt; <span class="droplink">Ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:79:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l79" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a> <span class="keyword">then</span> </pre></li>
<li id="l945"><pre>         <span class="keyword">raise</span> Constraint_Error; </pre></li>
<li id="l946"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l947"><pre>      o.ID := <span class="droplink">empty<ul><li><a href="globe_3d.ads.html#globe_3d.ads:83:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l83" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l948"><pre>      o.ID (1 .. <span class="droplink">new_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:49" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a>) := <span class="droplink">new_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:49" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l949"><pre>   <span class="keyword">end</span> <span class="droplink">Set_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:232:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l232" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l941" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l950"><pre> </pre></li>
<li id="l951"><pre>   <span class="keyword">function</span> <span class="droplink">Get_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:235:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l235" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:235:23" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l235" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;class) <span class="keyword">return</span> String <span class="keyword">is</span> </pre></li>
<li id="l952"><pre> </pre></li>
<li id="l953"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l954"><pre>      <span class="keyword">return</span> Trim (o.ID, Right); </pre></li>
<li id="l955"><pre>   <span class="keyword">end</span> <span class="droplink">Get_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:235:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l235" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l951" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l956"><pre> </pre></li>
<li id="l957"><pre>   <span class="keyword">procedure</span> <span class="droplink">Rebuild_links<ul><li><a href="globe_3d.ads.html#globe_3d.ads:410:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l410" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:411:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l411" title="To spec">To spec</a></li></ul></span>            : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>&apos;Class; <span class="comment">-- object to be relinked</span> </pre></li>
<li id="l958"><pre>                            <span class="droplink">neighbouring<ul><li><a href="globe_3d.ads.html#globe_3d.ads:412:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l412" title="To spec">To spec</a></li></ul></span> :        <span class="droplink">Map_of_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:252:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l252" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l604" title="To body">To body</a></li></ul></span>;  <span class="comment">-- neighbourhood</span> </pre></li>
<li id="l959"><pre>                            <span class="droplink">tolerant_obj<ul><li><a href="globe_3d.ads.html#globe_3d.ads:413:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l413" title="To spec">To spec</a></li></ul></span> :        Boolean;         <span class="comment">-- tolerant on missing objects</span> </pre></li>
<li id="l960"><pre>                            <span class="droplink">tolerant_tex<ul><li><a href="globe_3d.ads.html#globe_3d.ads:414:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l414" title="To spec">To spec</a></li></ul></span> :        Boolean          <span class="comment">-- tolerant on missing textures</span> </pre></li>
<li id="l961"><pre>                           ) <span class="keyword">is</span> </pre></li>
<li id="l962"><pre> </pre></li>
<li id="l963"><pre>      found : Boolean; </pre></li>
<li id="l964"><pre> </pre></li>
<li id="l965"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l966"><pre>      <span class="keyword">for</span> f <span class="keyword">in</span> o.face&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l967"><pre>         <span class="comment">-- 1/ Find texture IDs :</span> </pre></li>
<li id="l968"><pre>         <span class="keyword">if</span> <span class="droplink">is_textured<ul><li><a href="globe_3d.ads.html#globe_3d.ads:279:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l279" title="To spec">To spec</a></li></ul></span> (o.face (f).skin) <span class="keyword">and</span> <span class="keyword">then</span> </pre></li>
<li id="l969"><pre>           o.Face_Invariant (f).texture_name /= <span class="droplink">empty<ul><li><a href="globe_3d.ads.html#globe_3d.ads:83:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l83" title="To spec">To spec</a></li></ul></span> </pre></li>
<li id="l970"><pre>         <span class="keyword">then</span> </pre></li>
<li id="l971"><pre>            <span class="keyword">begin</span> </pre></li>
<li id="l972"><pre>               o.face (f).texture := </pre></li>
<li id="l973"><pre>                 <span class="droplink">Textures.Texture_ID<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:71:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l71" title="To spec">To spec</a></li><li><a href="src_globe_3d-textures.adb.html#l226" title="To body">To body</a></li></ul></span> (o.Face_Invariant (f).texture_name); </pre></li>
<li id="l974"><pre>            <span class="keyword">exception</span> </pre></li>
<li id="l975"><pre>               <span class="keyword">when</span> <span class="droplink">Textures.Texture_name_not_found<ul><li><a href="globe_3d-textures.ads.html#globe_3d-textures.ads:72:3" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-textures.ads.html#l72" title="To spec">To spec</a></li></ul></span> =&gt; </pre></li>
<li id="l976"><pre>                  <span class="keyword">if</span> <span class="droplink">tolerant_tex<ul><li><a href="globe_3d.ads.html#globe_3d.ads:414:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l414" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l977"><pre>                     o.face (f).texture := <span class="droplink">null_image<ul><li><a href="globe_3d.ads.html#globe_3d.ads:100:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l100" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l978"><pre>                     o.face (f).skin := material_only; </pre></li>
<li id="l979"><pre>                  <span class="keyword">else</span> </pre></li>
<li id="l980"><pre>                     <span class="keyword">raise</span>; </pre></li>
<li id="l981"><pre>                  <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l982"><pre>            <span class="keyword">end</span>; </pre></li>
<li id="l983"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l984"><pre>         <span class="comment">-- 2/ Connections through portals :</span> </pre></li>
<li id="l985"><pre>         <span class="keyword">if</span> o.Face_Invariant (f).connect_name /= <span class="droplink">empty<ul><li><a href="globe_3d.ads.html#globe_3d.ads:83:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l83" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l986"><pre>            <a href="src_globe_3d.adb.html#l963" title="defined at globe_3d.adb:963:7">found</a> := False; </pre></li>
<li id="l987"><pre>            <span class="comment">-- XX old linear search :</span> </pre></li>
<li id="l988"><pre>            <span class="comment">--  for i in neighbouring&apos;Range loop</span> </pre></li>
<li id="l989"><pre>            <span class="comment">--    if neighbouring (i).ID = o.face_invariant (f).connect_name then</span> </pre></li>
<li id="l990"><pre>            <span class="comment">--      o.face (f).connecting := neighbouring (i);</span> </pre></li>
<li id="l991"><pre>            <span class="comment">--      found := True;</span> </pre></li>
<li id="l992"><pre>            <span class="comment">--      exit;</span> </pre></li>
<li id="l993"><pre>            <span class="comment">--    end if;</span> </pre></li>
<li id="l994"><pre>            <span class="comment">--  end loop;</span> </pre></li>
<li id="l995"><pre>            <span class="keyword">begin</span> </pre></li>
<li id="l996"><pre>               o.face (f).connecting := <span class="droplink">p_Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:264:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l264" title="To spec">To spec</a></li></ul></span> (Visuals_Mapping.Element ( </pre></li>
<li id="l997"><pre>                                                     Visuals_Mapping.Map (<span class="droplink">neighbouring<ul><li><a href="globe_3d.ads.html#globe_3d.ads:412:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l412" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l958" title="To body">To body</a></li></ul></span>), </pre></li>
<li id="l998"><pre>                                                     Ada.Strings.Unbounded.To_Unbounded_String (o.Face_Invariant (f).connect_name)) </pre></li>
<li id="l999"><pre>                                                    ); </pre></li>
<li id="l1000"><pre> </pre></li>
<li id="l1001"><pre>               <a href="src_globe_3d.adb.html#l963" title="defined at globe_3d.adb:963:7">found</a> := True; </pre></li>
<li id="l1002"><pre>            <span class="keyword">exception</span> </pre></li>
<li id="l1003"><pre>               <span class="keyword">when</span> Constraint_Error =&gt; </pre></li>
<li id="l1004"><pre>                  <span class="comment">-- GNAT gives also the message :</span> </pre></li>
<li id="l1005"><pre>                  <span class="comment">-- no element available because key not in map</span> </pre></li>
<li id="l1006"><pre>                  <span class="keyword">null</span>; </pre></li>
<li id="l1007"><pre>            <span class="keyword">end</span>; </pre></li>
<li id="l1008"><pre>            <span class="keyword">if</span> <span class="keyword">not</span> <a href="src_globe_3d.adb.html#l963" title="defined at globe_3d.adb:963:7">found</a> <span class="keyword">then</span> </pre></li>
<li id="l1009"><pre>               <span class="keyword">if</span> <span class="droplink">tolerant_obj<ul><li><a href="globe_3d.ads.html#globe_3d.ads:413:29" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l413" title="To spec">To spec</a></li></ul></span> <span class="keyword">then</span> </pre></li>
<li id="l1010"><pre>                  o.face (f).connecting := <span class="keyword">null</span>; </pre></li>
<li id="l1011"><pre>               <span class="keyword">else</span> </pre></li>
<li id="l1012"><pre>                  Raise_Exception ( </pre></li>
<li id="l1013"><pre>                                   <span class="droplink">Portal_connection_failed<ul><li><a href="globe_3d.ads.html#globe_3d.ads:417:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l417" title="To spec">To spec</a></li></ul></span>&apos;Identity, </pre></li>
<li id="l1014"><pre>                                   <span class="string">&quot;For object name [&quot;</span> &amp; Trim (o.ID, Right) &amp; </pre></li>
<li id="l1015"><pre>                                     <span class="string">&quot;], looking for [&quot;</span> &amp; </pre></li>
<li id="l1016"><pre>                                     Trim (o.Face_Invariant (f).connect_name, Right) </pre></li>
<li id="l1017"><pre>                                   &amp; <span class="string">&apos;]&apos;</span> </pre></li>
<li id="l1018"><pre>                                  ); </pre></li>
<li id="l1019"><pre>               <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1020"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1021"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1022"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1023"><pre>   <span class="keyword">end</span> <span class="droplink">Rebuild_links<ul><li><a href="globe_3d.ads.html#globe_3d.ads:410:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l410" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l957" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1024"><pre> </pre></li>
<li id="l1025"><pre>   <span class="keyword">procedure</span> <span class="droplink">Texture_name_hint<ul><li><a href="globe_3d.ads.html#globe_3d.ads:396:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l396" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:397:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l397" title="To spec">To spec</a></li></ul></span>    : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1026"><pre>                                <span class="droplink">face<ul><li><a href="globe_3d.ads.html#globe_3d.ads:398:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l398" title="To spec">To spec</a></li></ul></span> :        Positive; </pre></li>
<li id="l1027"><pre>                                <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:399:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l399" title="To spec">To spec</a></li></ul></span> :        String </pre></li>
<li id="l1028"><pre>                               ) <span class="keyword">is</span> </pre></li>
<li id="l1029"><pre> </pre></li>
<li id="l1030"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l1031"><pre>      <span class="keyword">if</span> <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:399:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l399" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a> &gt; <span class="droplink">Ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:79:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l79" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a> <span class="keyword">then</span> </pre></li>
<li id="l1032"><pre>         <span class="keyword">raise</span> Constraint_Error; </pre></li>
<li id="l1033"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1034"><pre>      o.Face_Invariant (<span class="droplink">face<ul><li><a href="globe_3d.ads.html#globe_3d.ads:398:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l398" title="To spec">To spec</a></li></ul></span>).texture_name := <span class="droplink">empty<ul><li><a href="globe_3d.ads.html#globe_3d.ads:83:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l83" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1035"><pre>      o.Face_Invariant (<span class="droplink">face<ul><li><a href="globe_3d.ads.html#globe_3d.ads:398:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l398" title="To spec">To spec</a></li></ul></span>).texture_name (1 .. <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:399:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l399" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a>) := <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:399:33" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l399" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1036"><pre>   <span class="keyword">end</span> <span class="droplink">Texture_name_hint<ul><li><a href="globe_3d.ads.html#globe_3d.ads:396:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l396" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1025" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1037"><pre> </pre></li>
<li id="l1038"><pre>   <span class="keyword">procedure</span> <span class="droplink">Portal_name_hint<ul><li><a href="globe_3d.ads.html#globe_3d.ads:403:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l403" title="To spec">To spec</a></li></ul></span> (<span class="droplink">o<ul><li><a href="globe_3d.ads.html#globe_3d.ads:404:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l404" title="To spec">To spec</a></li></ul></span>   : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Object_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:263:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l263" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l371" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1039"><pre>                               <span class="droplink">face<ul><li><a href="globe_3d.ads.html#globe_3d.ads:405:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l405" title="To spec">To spec</a></li></ul></span> :        Positive; </pre></li>
<li id="l1040"><pre>                               <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:406:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l406" title="To spec">To spec</a></li></ul></span> :        String </pre></li>
<li id="l1041"><pre>                              ) <span class="keyword">is</span> </pre></li>
<li id="l1042"><pre> </pre></li>
<li id="l1043"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l1044"><pre>      <span class="keyword">if</span> <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:406:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l406" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a> &gt; <span class="droplink">Ident<ul><li><a href="globe_3d.ads.html#globe_3d.ads:79:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l79" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a> <span class="keyword">then</span> </pre></li>
<li id="l1045"><pre>         <span class="keyword">raise</span> Constraint_Error; </pre></li>
<li id="l1046"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1047"><pre>      o.Face_Invariant (<span class="droplink">face<ul><li><a href="globe_3d.ads.html#globe_3d.ads:405:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l405" title="To spec">To spec</a></li></ul></span>).connect_name := <span class="droplink">empty<ul><li><a href="globe_3d.ads.html#globe_3d.ads:83:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l83" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1048"><pre>      o.Face_Invariant (<span class="droplink">face<ul><li><a href="globe_3d.ads.html#globe_3d.ads:405:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l405" title="To spec">To spec</a></li></ul></span>).connect_name (1 .. <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:406:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l406" title="To spec">To spec</a></li></ul></span>&apos;<a href="src_globe_3d.adb.html#l273" title="defined at globe_3d.adb:273:7">Length</a>) := <span class="droplink">name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:406:32" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l406" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1049"><pre>   <span class="keyword">end</span> <span class="droplink">Portal_name_hint<ul><li><a href="globe_3d.ads.html#globe_3d.ads:403:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l403" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1038" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1050"><pre> </pre></li>
<li id="l1051"><pre>   <span class="comment">----------------------------------------</span> </pre></li>
<li id="l1052"><pre>   <span class="comment">-- tbd : has been moved (for the moment) external to &apos;render&apos; for performance, but this makes package task unsafe !</span> </pre></li>
<li id="l1053"><pre>   <span class="comment">--</span> </pre></li>
<li id="l1054"><pre>   <span class="comment">--</span> </pre></li>
<li id="l1055"><pre>   <span class="keyword">type</span> Visual_Geometry <span class="keyword">is</span> </pre></li>
<li id="l1056"><pre>      <span class="keyword">record</span> </pre></li>
<li id="l1057"><pre>         Visual   : <span class="droplink">p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1058"><pre>         Geometry : <span class="droplink">GL.Skinned_Geometry.Skinned_Geometry_t<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:16:9" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l16" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1059"><pre>      <span class="keyword">end</span> <span class="keyword">record</span>; </pre></li>
<li id="l1060"><pre>   <span class="keyword">pragma</span> Convention (<a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a>, <a href="src_globe_3d.adb.html#l1055" title="defined at globe_3d.adb:1055:9">Visual_Geometry</a>);  <span class="comment">-- using convention pragma to disable default initialization (for performance)</span> </pre></li>
<li id="l1061"><pre> </pre></li>
<li id="l1062"><pre>   <span class="keyword">type</span> Visual_Geometries <span class="keyword">is</span> <span class="keyword">array</span> (Positive <span class="keyword">range</span> &lt;&gt;) <span class="keyword">of</span> <a href="src_globe_3d.adb.html#l1055" title="defined at globe_3d.adb:1055:9">Visual_Geometry</a>; </pre></li>
<li id="l1063"><pre>   <span class="keyword">pragma</span> Convention (<a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a>, <a href="src_globe_3d.adb.html#l1062" title="defined at globe_3d.adb:1062:9">Visual_Geometries</a>);  <span class="comment">-- using convention pragma to disable default initialization (for performance)</span> </pre></li>
<li id="l1064"><pre> </pre></li>
<li id="l1065"><pre>   All_Geometries : <a href="src_globe_3d.adb.html#l1062" title="defined at globe_3d.adb:1062:9">Visual_Geometries</a> (1 .. 80_000);   <span class="keyword">pragma</span> Convention (<a href="src_globe_3d.adb.html#l569" title="defined at globe_3d.adb:569:10">C</a>, <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a>);  <span class="comment">-- tbd : this is slow !</span> </pre></li>
<li id="l1066"><pre>   <span class="comment">--</span> </pre></li>
<li id="l1067"><pre>   <span class="comment">--------------------------------------</span> </pre></li>
<li id="l1068"><pre> </pre></li>
<li id="l1069"><pre>   <span class="keyword">procedure</span> <span class="droplink">render<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li></ul></span> (<span class="droplink">the_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual_array<ul><li><a href="globe_3d.ads.html#globe_3d.ads:210:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l210" title="To spec">To spec</a></li></ul></span>; <span class="droplink">the_Camera<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:51" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Camera<ul><li><a href="globe_3d.ads.html#globe_3d.ads:156:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l156" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l1070"><pre> </pre></li>
<li id="l1071"><pre>      <span class="keyword">use</span> <span class="droplink">REF<ul><li><a href="globe_3d.ads.html#globe_3d.ads:103:12" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l103" title="To spec">To spec</a></li></ul></span>, <a href="src_globe_3d.adb.html#l22" title="defined at globe_3d.adb:22:12">G3DM</a>; </pre></li>
<li id="l1072"><pre> </pre></li>
<li id="l1073"><pre>      all_Transparents  : <span class="droplink">GLOBE_3D.Visual_array<ul><li><a href="globe_3d.ads.html#globe_3d.ads:210:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l210" title="To spec">To spec</a></li></ul></span> (1 .. 10_000); </pre></li>
<li id="l1074"><pre>      transparent_Count : Natural   := 0; </pre></li>
<li id="l1075"><pre> </pre></li>
<li id="l1076"><pre>      geometry_Count    : Natural   := 0;   <span class="comment">-- for &apos;all_Geometrys&apos; array.</span> </pre></li>
<li id="l1077"><pre> </pre></li>
<li id="l1078"><pre>      current_Skin      : <span class="droplink">GL.Skins.p_Skin<ul><li><a href="gl-skins.ads.html#gl-skins.ads:33:9" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l33" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1079"><pre> </pre></li>
<li id="l1080"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l1081"><pre>      <span class="comment">-- prepare openGL to display visuals.</span> </pre></li>
<li id="l1082"><pre>      <span class="comment">--</span> </pre></li>
<li id="l1083"><pre>      <span class="droplink">Clear<ul><li><a href="gl.ads.html#gl.ads:3197:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3197" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4101" title="To body">To body</a></li></ul></span>    (<span class="droplink">COLOR_BUFFER_BIT<ul><li><a href="gl.ads.html#gl.ads:103:4" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l103" title="To spec">To spec</a></li></ul></span> <span class="keyword">or</span> <span class="droplink">DEPTH_BUFFER_BIT<ul><li><a href="gl.ads.html#gl.ads:97:4" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l97" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l1084"><pre>      <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span>   (DEPTH_TEST); </pre></li>
<li id="l1085"><pre> </pre></li>
<li id="l1086"><pre>      <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span>   (LIGHTING);                               <span class="comment">-- enable lighting for G3D.Display in &apos;separate Visuals&apos; (obsolete).</span> </pre></li>
<li id="l1087"><pre>      <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span>   (CULL_FACE); </pre></li>
<li id="l1088"><pre>      <span class="droplink">CullFace<ul><li><a href="gl.ads.html#gl.ads:418:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l418" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4124" title="To body">To body</a></li></ul></span> (BACK); </pre></li>
<li id="l1089"><pre> </pre></li>
<li id="l1090"><pre>      <span class="droplink">MatrixMode<ul><li><a href="gl.ads.html#gl.ads:1338:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l1338" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4165" title="To body">To body</a></li></ul></span>    (MODELVIEW); </pre></li>
<li id="l1091"><pre>      <span class="droplink">Set_GL_Matrix<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:80:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l80" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l283" title="To body">To body</a></li></ul></span> (the_Camera.World_Rotation); </pre></li>
<li id="l1092"><pre>      <span class="droplink">Translate<ul><li><a href="gl.ads.html#gl.ads:3306:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3306" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4036" title="To body">To body</a></li></ul></span>     (-the_Camera.Clipper.Eye_Position (0),  -the_Camera.Clipper.Eye_Position (1),  -the_Camera.Clipper.Eye_Position (2)); </pre></li>
<li id="l1093"><pre> </pre></li>
<li id="l1094"><pre>      <span class="droplink">PushMatrix<ul><li><a href="gl.ads.html#gl.ads:3278:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3278" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4169" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1095"><pre> </pre></li>
<li id="l1096"><pre>      <span class="comment">-- separate Visuals</span> </pre></li>
<li id="l1097"><pre>      <span class="comment">--</span> </pre></li>
<li id="l1098"><pre>      <span class="keyword">for</span> Each_Visual <span class="keyword">in</span> <span class="droplink">the_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li></ul></span>&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l1099"><pre>         <span class="keyword">declare</span> </pre></li>
<li id="l1100"><pre>            the_Visual       : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;Class                          <span class="keyword">renames</span> <span class="droplink">the_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li></ul></span> (Each_Visual).<span class="keyword">all</span>; </pre></li>
<li id="l1101"><pre>            visual_Geometrys : <span class="droplink">GL.Skinned_Geometry.skinned_Geometrys<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:23:9" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l23" title="To spec">To spec</a></li></ul></span> <span class="keyword">renames</span> <span class="droplink">skinned_Geometrys<ul><li><a href="globe_3d.ads.html#globe_3d.ads:227:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l227" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l119" title="To body">To body</a></li></ul></span> (the_Visual); </pre></li>
<li id="l1102"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l1103"><pre>            <span class="keyword">if</span> <span class="droplink">is_Transparent<ul><li><a href="globe_3d.ads.html#globe_3d.ads:220:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l220" title="To spec">To spec</a></li></ul></span> (the_Visual) <span class="keyword">then</span> </pre></li>
<li id="l1104"><pre>               <a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a>                    := <a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a> + 1; </pre></li>
<li id="l1105"><pre>               <a href="src_globe_3d.adb.html#l1073" title="defined at globe_3d.adb:1073:7">all_Transparents</a> (<a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a>) := the_Visual&apos;Access; </pre></li>
<li id="l1106"><pre>            <span class="keyword">else</span> </pre></li>
<li id="l1107"><pre>               <span class="keyword">for</span> Each_Geometry <span class="keyword">in</span> visual_Geometrys&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l1108"><pre>                  <a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a>                          := <a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a> + 1; </pre></li>
<li id="l1109"><pre>                  <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (<a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a>).Visual   := the_Visual&apos;Access; </pre></li>
<li id="l1110"><pre>                  <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (<a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a>).Geometry := visual_Geometrys (Each_Geometry); </pre></li>
<li id="l1111"><pre>               <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1112"><pre> </pre></li>
<li id="l1113"><pre>               <span class="droplink">Display<ul><li><a href="globe_3d.ads.html#globe_3d.ads:229:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l229" title="To spec">To spec</a></li></ul></span> (<span class="droplink">the_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:22" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li></ul></span> (Each_Visual).<span class="keyword">all</span>,  the_Camera.Clipper); </pre></li>
<li id="l1114"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1115"><pre>         <span class="keyword">end</span>; </pre></li>
<li id="l1116"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1117"><pre> </pre></li>
<li id="l1118"><pre>      <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1119"><pre> </pre></li>
<li id="l1120"><pre>      <span class="comment">-- display all opaque geometries, sorted by gl geometry primitive kind and skin.</span> </pre></li>
<li id="l1121"><pre>      <span class="comment">--</span> </pre></li>
<li id="l1122"><pre>      <span class="keyword">declare</span> </pre></li>
<li id="l1123"><pre> </pre></li>
<li id="l1124"><pre><span class="comment">--           pragma Warnings (Off, &quot;declaration of &quot;&quot;&lt;&quot;&quot; hides predefined operator&quot;);</span> </pre></li>
<li id="l1125"><pre>         <span class="keyword">function</span> &quot;&lt;&quot; (L, R : <a href="src_globe_3d.adb.html#l1055" title="defined at globe_3d.adb:1055:9">Visual_Geometry</a>) <span class="keyword">return</span> Boolean <span class="keyword">is</span> </pre></li>
<li id="l1126"><pre><span class="comment">--              pragma Warnings (On, &quot;declaration of &quot;&quot;&lt;&quot;&quot; hides predefined operator&quot;);</span> </pre></li>
<li id="l1127"><pre> </pre></li>
<li id="l1128"><pre>            <span class="keyword">use</span> <span class="droplink">GL.Geometry<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:15:12" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l15" title="To spec">To spec</a></li><li><a href="src_gl-geometry.adb.html#l18" title="To body">To body</a></li></ul></span>, System.Storage_Elements; </pre></li>
<li id="l1129"><pre> </pre></li>
<li id="l1130"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l1131"><pre>            <span class="keyword">if</span> <span class="droplink">primitive_Id<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:120:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l120" title="To spec">To spec</a></li></ul></span> (L.Geometry.Geometry.<span class="keyword">all</span>)  =  <span class="droplink">primitive_Id<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:120:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l120" title="To spec">To spec</a></li></ul></span> (R.Geometry.Geometry.<span class="keyword">all</span>) <span class="keyword">then</span>   <span class="comment">-- tbd : find better naming scheme to avoid &apos;.Geometry.Geometry.&apos;</span> </pre></li>
<li id="l1132"><pre>               <span class="keyword">return</span> To_Integer (L.Geometry.Skin.<span class="keyword">all</span>&apos;Address) &lt; To_Integer (R.Geometry.Skin.<span class="keyword">all</span>&apos;Address); <span class="comment">-- tbd : check this is safe/portable</span> </pre></li>
<li id="l1133"><pre>               <span class="comment">-- GdM : aaargh! remove that !!</span> </pre></li>
<li id="l1134"><pre>            <span class="keyword">else</span> </pre></li>
<li id="l1135"><pre>               <span class="keyword">return</span> <span class="droplink">primitive_Id<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:120:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l120" title="To spec">To spec</a></li></ul></span> (L.Geometry.Geometry.<span class="keyword">all</span>) &lt; <span class="droplink">primitive_Id<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:120:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l120" title="To spec">To spec</a></li></ul></span> (R.Geometry.Geometry.<span class="keyword">all</span>); </pre></li>
<li id="l1136"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1137"><pre>         <span class="keyword">end</span> &quot;&lt;&quot;; </pre></li>
<li id="l1138"><pre> </pre></li>
<li id="l1139"><pre>         <span class="keyword">procedure</span> sort <span class="keyword">is</span> <span class="keyword">new</span> Ada.Containers.Generic_Array_Sort (Positive, </pre></li>
<li id="l1140"><pre>                                                                  <a href="src_globe_3d.adb.html#l1055" title="defined at globe_3d.adb:1055:9">Visual_Geometry</a>, </pre></li>
<li id="l1141"><pre>                                                                  <a href="src_globe_3d.adb.html#l1062" title="defined at globe_3d.adb:1062:9">Visual_Geometries</a>); </pre></li>
<li id="l1142"><pre>         <span class="keyword">use</span> <span class="droplink">GL.Skins<ul><li><a href="gl-skins.ads.html#gl-skins.ads:15:12" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l15" title="To spec">To spec</a></li><li><a href="src_gl-skins.adb.html#l14" title="To body">To body</a></li></ul></span>, <span class="droplink">GL.Geometry<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:15:12" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l15" title="To spec">To spec</a></li><li><a href="src_gl-geometry.adb.html#l18" title="To body">To body</a></li></ul></span>, <span class="droplink">GL.Skinned_Geometry<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:14:12" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l14" title="To spec">To spec</a></li><li><a href="src_gl-skinned_geometry.adb.html#l18" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1143"><pre> </pre></li>
<li id="l1144"><pre>         current_Visual : <span class="droplink">p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>; </pre></li>
<li id="l1145"><pre> </pre></li>
<li id="l1146"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l1147"><pre>         <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a> &gt; 1 <span class="keyword">then</span> </pre></li>
<li id="l1148"><pre>            sort (<a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (1 .. <a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a>)); </pre></li>
<li id="l1149"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1150"><pre> </pre></li>
<li id="l1151"><pre>         <span class="droplink">GL.PushMatrix<ul><li><a href="gl.ads.html#gl.ads:3278:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3278" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4169" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1152"><pre> </pre></li>
<li id="l1153"><pre>         <span class="keyword">for</span> Each <span class="keyword">in</span> 1 .. <a href="src_globe_3d.adb.html#l1076" title="defined at globe_3d.adb:1076:7">geometry_Count</a> <span class="keyword">loop</span> </pre></li>
<li id="l1154"><pre> </pre></li>
<li id="l1155"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Geometry.Skin /= <a href="src_globe_3d.adb.html#l1078" title="defined at globe_3d.adb:1078:7">current_Skin</a> <span class="keyword">then</span> </pre></li>
<li id="l1156"><pre>               <a href="src_globe_3d.adb.html#l1078" title="defined at globe_3d.adb:1078:7">current_Skin</a> := <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Geometry.Skin; </pre></li>
<li id="l1157"><pre>               <span class="droplink">Enable<ul><li><a href="gl-skins.ads.html#gl-skins.ads:42:14" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l42" title="To spec">To spec</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1078" title="defined at globe_3d.adb:1078:7">current_Skin</a>.<span class="keyword">all</span>); </pre></li>
<li id="l1158"><pre>               <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1159"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1160"><pre> </pre></li>
<li id="l1161"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Geometry.Veneer /= <span class="keyword">null</span> <span class="keyword">then</span> </pre></li>
<li id="l1162"><pre>               <span class="droplink">Enable<ul><li><a href="gl-skins.ads.html#gl-skins.ads:24:14" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l24" title="To spec">To spec</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Geometry.Veneer.<span class="keyword">all</span>); </pre></li>
<li id="l1163"><pre>               <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1164"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1165"><pre> </pre></li>
<li id="l1166"><pre>            <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Visual = current_Visual <span class="keyword">then</span> </pre></li>
<li id="l1167"><pre>               <span class="droplink">Draw<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:135:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l135" title="To spec">To spec</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Geometry.Geometry.<span class="keyword">all</span>); </pre></li>
<li id="l1168"><pre>               <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1169"><pre>            <span class="keyword">else</span> </pre></li>
<li id="l1170"><pre>               <span class="droplink">GL.PopMatrix<ul><li><a href="gl.ads.html#gl.ads:3280:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3280" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4170" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1171"><pre>               <span class="droplink">GL.PushMatrix<ul><li><a href="gl.ads.html#gl.ads:3278:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3278" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4169" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1172"><pre>               <span class="droplink">GL.Translate<ul><li><a href="gl.ads.html#gl.ads:3308:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3308" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l53" title="To body">To body</a></li></ul></span>       (<a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Visual.<span class="keyword">all</span>.Centre); </pre></li>
<li id="l1173"><pre>               <span class="droplink">Multiply_GL_Matrix<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:77:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l77" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l268" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Visual.<span class="keyword">all</span>.rotation); </pre></li>
<li id="l1174"><pre> </pre></li>
<li id="l1175"><pre>               <span class="droplink">Draw<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:135:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l135" title="To spec">To spec</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Geometry.Geometry.<span class="keyword">all</span>); </pre></li>
<li id="l1176"><pre>               <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1177"><pre> </pre></li>
<li id="l1178"><pre>               current_Visual := <a href="src_globe_3d.adb.html#l1065" title="defined at globe_3d.adb:1065:4">All_Geometries</a> (Each).Visual; </pre></li>
<li id="l1179"><pre>            <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1180"><pre> </pre></li>
<li id="l1181"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1182"><pre> </pre></li>
<li id="l1183"><pre>         <span class="droplink">GL.PopMatrix<ul><li><a href="gl.ads.html#gl.ads:3280:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3280" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4170" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1184"><pre>      <span class="keyword">end</span>; </pre></li>
<li id="l1185"><pre> </pre></li>
<li id="l1186"><pre>      <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1187"><pre> </pre></li>
<li id="l1188"><pre>      <span class="comment">-- display all transparent visuals, sorted from far to near.</span> </pre></li>
<li id="l1189"><pre>      <span class="comment">--</span> </pre></li>
<li id="l1190"><pre>      <span class="keyword">declare</span> </pre></li>
<li id="l1191"><pre> </pre></li>
<li id="l1192"><pre><span class="comment">--           pragma Warnings (Off, &quot;declaration of &quot;&quot;&lt;&quot;&quot; hides predefined operator&quot;);</span> </pre></li>
<li id="l1193"><pre>         <span class="keyword">function</span> &quot;&lt;&quot; (L, R : <span class="droplink">GLOBE_3D.p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> Boolean <span class="keyword">is</span> <span class="comment">-- tbd : ugh move expensive calcs outside</span> </pre></li>
<li id="l1194"><pre><span class="comment">--              pragma Warnings (On, &quot;declaration of &quot;&quot;&lt;&quot;&quot; hides predefined operator&quot;);</span> </pre></li>
<li id="l1195"><pre> </pre></li>
<li id="l1196"><pre>         <span class="keyword">begin</span> </pre></li>
<li id="l1197"><pre>            <span class="keyword">return</span> L.<span class="keyword">all</span>.Centre_Camera_Space (2) &lt; R.<span class="keyword">all</span>.Centre_Camera_Space (2);  <span class="comment">-- nb : in camera space, negative Z is forward, so use &apos;&lt;&apos;.</span> </pre></li>
<li id="l1198"><pre>         <span class="keyword">end</span> &quot;&lt;&quot;; </pre></li>
<li id="l1199"><pre> </pre></li>
<li id="l1200"><pre>         <span class="comment">-- procedure sort is new Ada.Containers.Generic_Array_Sort (Positive,</span> </pre></li>
<li id="l1201"><pre>         <span class="keyword">procedure</span> sort <span class="keyword">is</span> <span class="keyword">new</span> Ada.Containers.Generic_Array_Sort (Positive, </pre></li>
<li id="l1202"><pre>                                                                  <span class="droplink">GLOBE_3D.p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>, </pre></li>
<li id="l1203"><pre>                                                                  <span class="droplink">GLOBE_3D.Visual_array<ul><li><a href="globe_3d.ads.html#globe_3d.ads:210:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l210" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l1204"><pre>      <span class="keyword">begin</span> </pre></li>
<li id="l1205"><pre>         <span class="keyword">for</span> Each <span class="keyword">in</span> 1 .. <a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a> <span class="keyword">loop</span>  <span class="comment">-- pre - calculate each visuals Centre in camera space.</span> </pre></li>
<li id="l1206"><pre>            <a href="src_globe_3d.adb.html#l1073" title="defined at globe_3d.adb:1073:7">all_Transparents</a> (Each).<span class="keyword">all</span>.Centre_Camera_Space :=   the_Camera.World_Rotation </pre></li>
<li id="l1207"><pre>              * (<a href="src_globe_3d.adb.html#l1073" title="defined at globe_3d.adb:1073:7">all_Transparents</a> (Each).<span class="keyword">all</span>.Centre - the_Camera.Clipper.Eye_Position); </pre></li>
<li id="l1208"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1209"><pre> </pre></li>
<li id="l1210"><pre>         <span class="keyword">if</span> <a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a> &gt; 1 <span class="keyword">then</span> </pre></li>
<li id="l1211"><pre>            sort (<a href="src_globe_3d.adb.html#l1073" title="defined at globe_3d.adb:1073:7">all_Transparents</a> (1 .. <a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a>)); </pre></li>
<li id="l1212"><pre>         <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1213"><pre> </pre></li>
<li id="l1214"><pre>         <span class="droplink">GL.Depth_Mask<ul><li><a href="gl.ads.html#gl.ads:3252:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3252" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4161" title="To body">To body</a></li></ul></span> (<span class="droplink">GL_False<ul><li><a href="gl.ads.html#gl.ads:180:4" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l180" title="To spec">To spec</a></li></ul></span>);  <span class="comment">-- make depth buffer read - only, for correct transparency</span> </pre></li>
<li id="l1215"><pre> </pre></li>
<li id="l1216"><pre>         <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span>    (LIGHTING);   <span class="comment">-- ensure lighting is enabled for G3D.Display of transparents (obsolete).</span> </pre></li>
<li id="l1217"><pre>         <span class="droplink">Enable<ul><li><a href="gl.ads.html#gl.ads:704:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l704" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4140" title="To body">To body</a></li></ul></span>    (BLEND); </pre></li>
<li id="l1218"><pre>         <span class="droplink">BlendFunc<ul><li><a href="gl.ads.html#gl.ads:349:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l349" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4122" title="To body">To body</a></li></ul></span> (<span class="droplink">sfactor<ul><li><a href="gl.ads.html#gl.ads:349:25" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l349" title="To spec">To spec</a></li></ul></span> =&gt; ONE, </pre></li>
<li id="l1219"><pre>                    <span class="droplink">dfactor<ul><li><a href="gl.ads.html#gl.ads:350:25" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l350" title="To spec">To spec</a></li></ul></span> =&gt; ONE_MINUS_SRC_ALPHA); </pre></li>
<li id="l1220"><pre> </pre></li>
<li id="l1221"><pre>         <span class="keyword">for</span> Each_Transparency <span class="keyword">in</span> 1 .. <a href="src_globe_3d.adb.html#l1074" title="defined at globe_3d.adb:1074:7">transparent_Count</a> <span class="keyword">loop</span> </pre></li>
<li id="l1222"><pre>            <span class="keyword">declare</span> </pre></li>
<li id="l1223"><pre>               the_Visual       : <span class="droplink">Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:197:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l197" title="To spec">To spec</a></li></ul></span>&apos;Class                          <span class="keyword">renames</span> <a href="src_globe_3d.adb.html#l1073" title="defined at globe_3d.adb:1073:7">all_Transparents</a> (Each_Transparency).<span class="keyword">all</span>; </pre></li>
<li id="l1224"><pre>               visual_Geometrys : <span class="keyword">constant</span> <span class="droplink">GL.Skinned_Geometry.skinned_Geometrys<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:23:9" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l23" title="To spec">To spec</a></li></ul></span>      := <span class="droplink">skinned_Geometrys<ul><li><a href="globe_3d.ads.html#globe_3d.ads:227:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l227" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l119" title="To body">To body</a></li></ul></span> (the_Visual); <span class="comment">-- tbd : apply ogl state sorting here ?</span> </pre></li>
<li id="l1225"><pre>            <span class="keyword">begin</span> </pre></li>
<li id="l1226"><pre>               <span class="droplink">Display<ul><li><a href="globe_3d.ads.html#globe_3d.ads:229:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l229" title="To spec">To spec</a></li></ul></span> (the_Visual,  the_Camera.Clipper); </pre></li>
<li id="l1227"><pre>               <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1228"><pre> </pre></li>
<li id="l1229"><pre>               <span class="keyword">for</span> Each_Geometry <span class="keyword">in</span> visual_Geometrys&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l1230"><pre>                  <span class="keyword">declare</span> </pre></li>
<li id="l1231"><pre>                     <span class="keyword">use</span> <span class="droplink">GL.Skins<ul><li><a href="gl-skins.ads.html#gl-skins.ads:15:12" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l15" title="To spec">To spec</a></li><li><a href="src_gl-skins.adb.html#l14" title="To body">To body</a></li></ul></span>, <span class="droplink">GL.Geometry<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:15:12" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l15" title="To spec">To spec</a></li><li><a href="src_gl-geometry.adb.html#l18" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1232"><pre>                     the_Geometry : <span class="droplink">GL.Skinned_Geometry.Skinned_Geometry_t<ul><li><a href="gl-skinned_geometry.ads.html#gl-skinned_geometry.ads:16:9" title="To API doc">To API doc</a></li><li><a href="src_gl-skinned_geometry.ads.html#l16" title="To spec">To spec</a></li></ul></span> <span class="keyword">renames</span> visual_Geometrys (Each_Geometry); </pre></li>
<li id="l1233"><pre>                  <span class="keyword">begin</span> </pre></li>
<li id="l1234"><pre> </pre></li>
<li id="l1235"><pre>                     <span class="keyword">if</span> the_Geometry.Skin /= <a href="src_globe_3d.adb.html#l1078" title="defined at globe_3d.adb:1078:7">current_Skin</a> <span class="keyword">then</span> </pre></li>
<li id="l1236"><pre>                        <a href="src_globe_3d.adb.html#l1078" title="defined at globe_3d.adb:1078:7">current_Skin</a> := the_Geometry.Skin; </pre></li>
<li id="l1237"><pre>                        <span class="droplink">Enable<ul><li><a href="gl-skins.ads.html#gl-skins.ads:42:14" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l42" title="To spec">To spec</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1078" title="defined at globe_3d.adb:1078:7">current_Skin</a>.<span class="keyword">all</span>); </pre></li>
<li id="l1238"><pre>                        <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1239"><pre>                     <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1240"><pre> </pre></li>
<li id="l1241"><pre>                     <span class="keyword">if</span> the_Geometry.Veneer /= <span class="keyword">null</span> <span class="keyword">then</span> </pre></li>
<li id="l1242"><pre>                        <span class="droplink">Enable<ul><li><a href="gl-skins.ads.html#gl-skins.ads:24:14" title="To API doc">To API doc</a></li><li><a href="src_gl-skins.ads.html#l24" title="To spec">To spec</a></li></ul></span> (the_Geometry.Veneer.<span class="keyword">all</span>); </pre></li>
<li id="l1243"><pre>                        <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1244"><pre>                     <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1245"><pre> </pre></li>
<li id="l1246"><pre>                     <span class="droplink">GL.PushMatrix<ul><li><a href="gl.ads.html#gl.ads:3278:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3278" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4169" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1247"><pre> </pre></li>
<li id="l1248"><pre>                     <span class="droplink">GL.Translate<ul><li><a href="gl.ads.html#gl.ads:3308:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3308" title="To spec">To spec</a></li><li><a href="src_gl.adb.html#l53" title="To body">To body</a></li></ul></span>       (the_Visual.Centre); </pre></li>
<li id="l1249"><pre>                     <span class="droplink">Multiply_GL_Matrix<ul><li><a href="globe_3d-math.ads.html#globe_3d-math.ads:77:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d-math.ads.html#l77" title="To spec">To spec</a></li><li><a href="src_globe_3d-math.adb.html#l268" title="To body">To body</a></li></ul></span> (the_Visual.rotation); </pre></li>
<li id="l1250"><pre> </pre></li>
<li id="l1251"><pre>                     <span class="droplink">Draw<ul><li><a href="gl-geometry.ads.html#gl-geometry.ads:135:14" title="To API doc">To API doc</a></li><li><a href="src_gl-geometry.ads.html#l135" title="To spec">To spec</a></li></ul></span> (the_Geometry.Geometry.<span class="keyword">all</span>); </pre></li>
<li id="l1252"><pre>                     <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1253"><pre> </pre></li>
<li id="l1254"><pre>                     <span class="droplink">GL.PopMatrix<ul><li><a href="gl.ads.html#gl.ads:3280:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3280" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4170" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1255"><pre>                  <span class="keyword">end</span>; </pre></li>
<li id="l1256"><pre>               <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1257"><pre> </pre></li>
<li id="l1258"><pre>            <span class="keyword">end</span>; </pre></li>
<li id="l1259"><pre>         <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1260"><pre> </pre></li>
<li id="l1261"><pre>         <span class="droplink">GL.Depth_Mask<ul><li><a href="gl.ads.html#gl.ads:3252:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3252" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4161" title="To body">To body</a></li></ul></span> (<span class="droplink">GL_True<ul><li><a href="gl.ads.html#gl.ads:181:4" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l181" title="To spec">To spec</a></li></ul></span>); </pre></li>
<li id="l1262"><pre>      <span class="keyword">end</span>; </pre></li>
<li id="l1263"><pre> </pre></li>
<li id="l1264"><pre>      <span class="droplink">PopMatrix<ul><li><a href="gl.ads.html#gl.ads:3280:14" title="To API doc">To API doc</a></li><li><a href="src_gl.ads.html#l3280" title="To spec">To spec</a></li><li><a href="src_gl.ads.html#l4170" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1265"><pre> </pre></li>
<li id="l1266"><pre>      <span class="droplink">GL.Errors.log<ul><li><a href="gl-errors.ads.html#gl-errors.ads:21:14" title="To API doc">To API doc</a></li><li><a href="src_gl-errors.ads.html#l21" title="To spec">To spec</a></li><li><a href="src_gl-errors.adb.html#l26" title="To body">To body</a></li></ul></span>;      <span class="comment">-- tbd : for debug only</span> </pre></li>
<li id="l1267"><pre>   <span class="keyword">end</span> <span class="droplink">render<ul><li><a href="globe_3d.ads.html#globe_3d.ads:243:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l243" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1069" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1268"><pre> </pre></li>
<li id="l1269"><pre>   <span class="keyword">function</span> <span class="droplink">empty_map<ul><li><a href="globe_3d.ads.html#globe_3d.ads:254:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l254" title="To spec">To spec</a></li></ul></span> <span class="keyword">return</span> <span class="droplink">Map_of_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:252:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l252" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l604" title="To body">To body</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l1270"><pre>      thing : <span class="droplink">Map_of_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:252:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l252" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l604" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1271"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l1272"><pre>      Visuals_Mapping.Map (<a href="src_globe_3d.adb.html#l1270" title="defined at globe_3d.adb:1270:7">thing</a>) := Visuals_Mapping.Empty_Map; </pre></li>
<li id="l1273"><pre>      <span class="keyword">return</span> <a href="src_globe_3d.adb.html#l1270" title="defined at globe_3d.adb:1270:7">thing</a>; </pre></li>
<li id="l1274"><pre>   <span class="keyword">end</span> <span class="droplink">empty_map<ul><li><a href="globe_3d.ads.html#globe_3d.ads:254:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l254" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1269" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1275"><pre> </pre></li>
<li id="l1276"><pre>   <span class="keyword">procedure</span> <span class="droplink">Add<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li></ul></span> (<span class="droplink">to_map<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:19" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li></ul></span> : <span class="keyword">in</span> <span class="keyword">out</span> <span class="droplink">Map_of_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:252:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l252" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l604" title="To body">To body</a></li></ul></span>; <span class="droplink">what<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:51" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li></ul></span> : <span class="droplink">p_Visual<ul><li><a href="globe_3d.ads.html#globe_3d.ads:209:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l209" title="To spec">To spec</a></li></ul></span>) <span class="keyword">is</span> </pre></li>
<li id="l1277"><pre>      pos : Visuals_Mapping.Cursor; </pre></li>
<li id="l1278"><pre>      success : Boolean; </pre></li>
<li id="l1279"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l1280"><pre>      Visuals_Mapping.Insert ( </pre></li>
<li id="l1281"><pre>                              Visuals_Mapping.Map (<span class="droplink">to_map<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:19" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1276" title="To body">To body</a></li></ul></span>), </pre></li>
<li id="l1282"><pre>                              Ada.Strings.Unbounded.To_Unbounded_String (<span class="droplink">what<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:51" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>.ID), </pre></li>
<li id="l1283"><pre>                              <span class="droplink">what<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:51" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li></ul></span>, </pre></li>
<li id="l1284"><pre>                              <a href="src_globe_3d.adb.html#l1277" title="defined at globe_3d.adb:1277:7">pos</a>, </pre></li>
<li id="l1285"><pre>                              <a href="src_globe_3d.adb.html#l1278" title="defined at globe_3d.adb:1278:7">success</a> </pre></li>
<li id="l1286"><pre>                             ); </pre></li>
<li id="l1287"><pre>      <span class="keyword">if</span> <span class="keyword">not</span> <a href="src_globe_3d.adb.html#l1278" title="defined at globe_3d.adb:1278:7">success</a> <span class="keyword">then</span> <span class="comment">-- A.18.4. 45/2</span> </pre></li>
<li id="l1288"><pre>         <span class="keyword">raise</span> <span class="droplink">Duplicate_name<ul><li><a href="globe_3d.ads.html#globe_3d.ads:256:4" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l256" title="To spec">To spec</a></li></ul></span> <span class="keyword">with</span> <span class="droplink">what<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:51" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li></ul></span>.<span class="keyword">all</span>.ID; </pre></li>
<li id="l1289"><pre>      <span class="keyword">end</span> <span class="keyword">if</span>; </pre></li>
<li id="l1290"><pre>   <span class="keyword">end</span> <span class="droplink">Add<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1276" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1291"><pre> </pre></li>
<li id="l1292"><pre>   <span class="keyword">function</span> <span class="droplink">Map_of<ul><li><a href="globe_3d.ads.html#globe_3d.ads:258:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l258" title="To spec">To spec</a></li></ul></span> (<span class="droplink">va<ul><li><a href="globe_3d.ads.html#globe_3d.ads:258:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l258" title="To spec">To spec</a></li></ul></span> : <span class="droplink">Visual_array<ul><li><a href="globe_3d.ads.html#globe_3d.ads:210:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l210" title="To spec">To spec</a></li></ul></span>) <span class="keyword">return</span> <span class="droplink">Map_of_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:252:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l252" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l604" title="To body">To body</a></li></ul></span> <span class="keyword">is</span> </pre></li>
<li id="l1293"><pre>      res : <span class="droplink">Map_of_Visuals<ul><li><a href="globe_3d.ads.html#globe_3d.ads:252:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l252" title="To spec">To spec</a></li><li><a href="src_globe_3d.ads.html#l604" title="To body">To body</a></li></ul></span> := <span class="droplink">empty_map<ul><li><a href="globe_3d.ads.html#globe_3d.ads:254:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l254" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1269" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1294"><pre>   <span class="keyword">begin</span> </pre></li>
<li id="l1295"><pre>      <span class="comment">-- Perhaps Reserve_Capacity would be good here ??</span> </pre></li>
<li id="l1296"><pre>      <span class="keyword">for</span> i <span class="keyword">in</span> <span class="droplink">va<ul><li><a href="globe_3d.ads.html#globe_3d.ads:258:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l258" title="To spec">To spec</a></li></ul></span>&apos;Range <span class="keyword">loop</span> </pre></li>
<li id="l1297"><pre>         <span class="droplink">Add<ul><li><a href="globe_3d.ads.html#globe_3d.ads:255:14" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l255" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1276" title="To body">To body</a></li></ul></span> (<a href="src_globe_3d.adb.html#l1293" title="defined at globe_3d.adb:1293:7">res</a>, <span class="droplink">va<ul><li><a href="globe_3d.ads.html#globe_3d.ads:258:21" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l258" title="To spec">To spec</a></li></ul></span> (i)); </pre></li>
<li id="l1298"><pre>      <span class="keyword">end</span> <span class="keyword">loop</span>; </pre></li>
<li id="l1299"><pre>      <span class="keyword">return</span> <a href="src_globe_3d.adb.html#l1293" title="defined at globe_3d.adb:1293:7">res</a>; </pre></li>
<li id="l1300"><pre>   <span class="keyword">end</span> <span class="droplink">Map_of<ul><li><a href="globe_3d.ads.html#globe_3d.ads:258:13" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l258" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l1292" title="To body">To body</a></li></ul></span>; </pre></li>
<li id="l1301"><pre> </pre></li>
<li id="l1302"><pre><span class="keyword">end</span> <span class="droplink">GLOBE_3D<ul><li><a href="globe_3d.ads.html#globe_3d.ads:77:9" title="To API doc">To API doc</a></li><li><a href="src_globe_3d.ads.html#l77" title="To spec">To spec</a></li><li><a href="src_globe_3d.adb.html#l17" title="To body">To body</a></li></ul></span>; </pre></li>
</ol></div>
</div>

</body>
</html>